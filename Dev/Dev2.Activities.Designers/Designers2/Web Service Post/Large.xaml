<core:ActivityDesignerTemplate x:Class="Dev2.Activities.Designers2.Web_Service_Post.Large"
                               xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                               xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                               xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                               xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                               xmlns:core="clr-namespace:Dev2.Activities.Designers2.Core"
                               xmlns:luna="clr-namespace:Warewolf.Studio.Themes.Luna;assembly=Warewolf.Studio.Themes.Luna"
                               xmlns:errors="clr-namespace:Dev2.Activities.Designers2.Core.Errors"
                               xmlns:ig="http://schemas.infragistics.com/xaml"
                               xmlns:customControls="clr-namespace:Warewolf.Studio.CustomControls;assembly=Warewolf.Studio.CustomControls"
                               xmlns:interfaces="clr-namespace:Dev2.Common.Interfaces;assembly=Dev2.Common.Interfaces"
                               xmlns:ui="clr-namespace:Dev2.UI;assembly=Dev2.Intellisense"
                               xmlns:interfaceImplementors="clr-namespace:Dev2.Studio.InterfaceImplementors;assembly=Dev2.Intellisense"
                               xmlns:languages="clr-namespace:Warewolf.Studio.Resources.Languages;assembly=Warewolf.Studio.Resources"
                               xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
                               xmlns:help="clr-namespace:Dev2.Activities.Designers2.Core.Help"
                               xmlns:webServicePost="clr-namespace:Dev2.Activities.Designers2.Web_Service_Post"
                               MinWidth="350"
                               Width="350"
                               MinHeight="{Binding DesignMinHeight}"
                               Height="{Binding DesignHeight}"
                               MaxWidth="Infinity"
                               MaxHeight="{Binding DesignMaxHeight}"
                               mc:Ignorable="d"
                               d:DesignHeight="300"
                               d:DesignWidth="350"
                               d:DataContext="{d:DesignInstance webServicePost:WebServicePostViewModel}">
    
    <core:ActivityDesignerTemplate.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <luna:SharedResourceDictionary Source="/Warewolf.Studio.Themes.Luna;component/Theme.xaml"/>
                <ResourceDictionary Source="../Core/CustomToolDesignerRegions.xaml"/>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </core:ActivityDesignerTemplate.Resources>

    <core:ActivityDesignerTemplate.RightButtons>
        <core:ActivityDesignerButton x:Name="DoneButton"
                                     Visibility="{Binding GenerateOutputsVisible, Converter={StaticResource BoolToVisibilityConverterNegative}}"
                                     Content="{Binding ButtonDisplayValue}"
                                     Margin="0,0,7,12"
                                     IsValidatedBefore="True"
                                     IsClosedAfter="True"
                                     Style="{StaticResource ActivityDesignerButtonStyle}" />
    </core:ActivityDesignerTemplate.RightButtons>


    <Grid x:Name="MainGrid" Margin="{StaticResource ElementBorder}">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Grid Visibility="{Binding GenerateOutputsVisible, Converter={StaticResource BoolToVisibilityConverterNegative}}">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition>
                        <RowDefinition.Style>
                            <Style>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding Path=OutputsRegion.IsVisible}" Value="True">
                                        <Setter Property="RowDefinition.Height" Value="*"/>
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding Path=OutputsRegion.IsVisible}" Value="False">
                                        <Setter Property="RowDefinition.Height" Value="Auto"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </RowDefinition.Style>
                    </RowDefinition>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <Control Template="{StaticResource SelectionGrid}"/>
                
                <!-- INPUTS -->
                <Grid Grid.Row="1" Visibility="{Binding InputArea.IsVisible, Converter={StaticResource BoolToVisibilityConverter}}">

                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <Grid x:Name="HeadersGrid" Margin="{StaticResource ControlBorderTop}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition/>
                        </Grid.RowDefinitions>
                        <TextBlock x:Name="HeadersLabel" Text="Headers" Grid.Column="0" Grid.Row="0" />

                        <Border Grid.Column="0"
                                Grid.ColumnSpan="2"
                                Grid.Row="1" 
                                BorderBrush="{StaticResource WarewolfHeaderWatermarkGreyBrush}" 
                                BorderThickness="1" >
                            <ig:XamGrid ItemsSource="{Binding InputArea.Headers}"
                                        IsAlternateRowsEnabled="False"
                                        AutoGenerateColumns="False"
                                        IsEnabled="{Binding InputArea.IsVisible}"
                                        ScrollViewer.VerticalScrollBarVisibility="Auto"
                                        Margin="-1,0,0,0"
                                        Height="Auto"
                                        MaxHeight="{Binding InputArea.MaxHeadersHeight}"
                                        ColumnWidth="*">
                                <ig:XamGrid.Columns>
                                    <customControls:IntellisenseTextBoxColumn Key="Name" HeaderText="Header"  MinimumWidth="100" Watermark="Header">
                                        <customControls:IntellisenseTextBoxColumn.AddNewRowEditorTemplate>
                                            <DataTemplate DataType="interfaces:INameValue">
                                                <ui:IntellisenseTextBox Text="{Binding Name}" ToolTip="{Binding Path=Name}">
                                                    <ui:IntellisenseTextBox.IntellisenseProvider>
                                                        <interfaceImplementors:CompositeIntellisenseProvider>
                                                            <interfaceImplementors:DefaultIntellisenseProvider />
                                                        </interfaceImplementors:CompositeIntellisenseProvider>
                                                    </ui:IntellisenseTextBox.IntellisenseProvider>
                                                </ui:IntellisenseTextBox>
                                            </DataTemplate>
                                        </customControls:IntellisenseTextBoxColumn.AddNewRowEditorTemplate>
                                    </customControls:IntellisenseTextBoxColumn>
                                    <customControls:IntellisenseTextBoxColumn Key="Value" HeaderText="Value"  MinimumWidth="100" Watermark="Value">
                                        <customControls:IntellisenseTextBoxColumn.AddNewRowEditorTemplate>
                                            <DataTemplate DataType="interfaces:INameValue">
                                                <ui:IntellisenseTextBox Text="{Binding Value}" ToolTip="{Binding Path=Value}">
                                                    <ui:IntellisenseTextBox.IntellisenseProvider>
                                                        <interfaceImplementors:CompositeIntellisenseProvider>
                                                            <interfaceImplementors:DefaultIntellisenseProvider />
                                                        </interfaceImplementors:CompositeIntellisenseProvider>
                                                    </ui:IntellisenseTextBox.IntellisenseProvider>
                                                </ui:IntellisenseTextBox>
                                            </DataTemplate>
                                        </customControls:IntellisenseTextBoxColumn.AddNewRowEditorTemplate>
                                    </customControls:IntellisenseTextBoxColumn>
                                </ig:XamGrid.Columns>
                                <ig:XamGrid.SortingSettings>
                                    <ig:SortingSettings AllowSorting="False" AllowMultipleColumnSorting="False" ShowSortIndicator="False"/>
                                </ig:XamGrid.SortingSettings>
                                <ig:XamGrid.EditingSettings>
                                    <ig:EditingSettings AllowEditing="Cell"
                                                        IsMouseActionEditingEnabled="SingleClick"
                                                        IsEnterKeyEditingEnabled="True"
                                                        IsF2EditingEnabled="True"
                                                        IsOnCellActiveEditingEnabled="True" />
                                </ig:XamGrid.EditingSettings>
                                <ig:XamGrid.ConditionalFormattingSettings>
                                    <ig:ConditionalFormattingSettings AllowConditionalFormatting="True"/>
                                </ig:XamGrid.ConditionalFormattingSettings>
                            </ig:XamGrid>
                        </Border>
                    </Grid>

                    <Grid Grid.Row="1" Margin="{StaticResource ControlBorderTop}" >
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <TextBlock x:Name="BodyLabel" Text="Body" Grid.Row="0" />

                        <TextBox Grid.Row="1"
                                 x:Name="RequestBody"
                                 Text="{Binding InputArea.BodyString}" 
                                 HorizontalAlignment="Stretch" 
                                 AcceptsReturn="True"
                                 Height="Auto"
                                 MinHeight="75"
                                 MaxHeight="75"
                                 VerticalContentAlignment="Top"
                                 TextWrapping="Wrap"
                                 VerticalAlignment="Stretch"
                                 VerticalScrollBarVisibility="Auto"
                                 HorizontalScrollBarVisibility="Auto"
                                 customControls:WatermarkTextBox.Watermark="Body" 
                                 SizeChanged="RequestBody_OnSizeChanged"
                                 ToolTip="{x:Static languages:Core.ManageWebServiceRequestBodyTooltip}">
                            <i:Interaction.Behaviors>
                                <help:HelpSetter Text="{x:Static languages:Core.WebServiceRequestBodyHelp}" DataContext="{Binding}" />
                            </i:Interaction.Behaviors>
                        </TextBox>
                    </Grid>
                    
                    <Grid x:Name="UrlGrid" Grid.Row="2" Margin="{StaticResource ControlBorderTop}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition/>
                            <RowDefinition/>
                        </Grid.RowDefinitions>
                        <TextBlock Grid.Column="0" x:Name="UrlLabel" Text="Url" />
                        <TextBlock Grid.Row="0" Grid.Column="1" x:Name="AddressLabel" Text="{Binding InputArea.RequestUrl}" TextTrimming="CharacterEllipsis" />
                        <TextBlock Grid.Column="0"  x:Name="QueryStringLable" Grid.Row="1" Text="Query String" />
                        <TextBox Grid.Column="1" Grid.Row="1" Text="{Binding InputArea.QueryString, UpdateSourceTrigger=PropertyChanged}"></TextBox>
                        <Button x:Name="TestInputButton"
                                Grid.Row="2"
                                Grid.Column="1"
                                Content="Generate Outputs"
                                Width="Auto"
                                Margin="{StaticResource ControlBorderTop}"
                                ToolTip="{x:Static languages:Core.ManageDbServiceTestActionTooltip}"
                                Visibility="{Binding InputArea.IsVisible, Converter={StaticResource BoolToVisibilityConverter}}"
                                HorizontalAlignment="Right"
                                Command="{Binding Path=TestInputCommand, Mode=TwoWay}"/>
                    </Grid>
                </Grid>

                <Control x:Name="OutputsControl" Grid.Row="2" Template="{StaticResource OutputsGrid}"/>

                <Grid x:Name="ErrorGrid"
                      Grid.Row="3"
                      Margin="{StaticResource ControlBorderTop}"
                      Visibility="{Binding OnErrorVisible}">
                    <errors:OnError />
                </Grid>
            </Grid>

            <Grid  Visibility="{Binding GenerateOutputsVisible, Converter={StaticResource BoolToVisibilityConverterPositive}}">
                <Control Template="{StaticResource GenerateOutputsView}" Margin="0,0,0,-5"/>
            </Grid>
        </Grid>
    </Grid>
</core:ActivityDesignerTemplate>
