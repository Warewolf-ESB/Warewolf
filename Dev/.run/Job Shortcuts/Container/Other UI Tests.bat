mkdir "%~dp0..\..\..\TestResults"
echo Set-Location C:\BuildUnderTest>"%~dp0..\..\..\TestResults\RunTestsEntrypoint.ps1"
echo ^&".\Job Shortcuts\TestRun.ps1" -RetryCount 6 -Projects Warewolf.UI.Tests -ExcludeCategories Scheduler,"Merge Foreach",MSSql,"Plugin Sources","Recordset Search",Search,"Shortcut Keys","Workflow Testing","Recordset Tools","Debug Input","Merge Simple Tools Conflicts","Scheduler Delete Task","Title Search","Service Search","Default Layout","Email Tools","File Tools","DotNet Connector Tool","Sharepoint Tools","Save Dialog","Source Wizards","DotNet Connector Mocking Tests","Merge Assign Conflicts","Assign Tool","Data Tools","Database Tools",Settings,"Test Name Search","Deploy from Remote","Input Search","Scalar Search","Deploy from Explorer","Control Flow Tools","Merge All Tools Conflicts","Server Sources",Variables,"Utility Tools","Deploy Filtering",Tools,"Merge Decision Conflicts","Deploy Hello World","Deploy Select Dependencies","Tabs and Panes","Object Search","Dependency Graph","Dropbox Tools","Database Sources","Merge Switch Conflicts","Hello World Mocking Tests","Scheduler Delete Is Disabled",Deploy,"Workflow Mocking Tests","Merge Variable Conflicts","Web Sources","Resource Tools","Output Search","HTTP Tools","Studio Shutdown","Merge Sequence Conflicts" -PreTestRunScript "StartAsService.ps1 -Cleanup -ResourcesPath UITests" -PostTestRunScript ReverseDeployLog.ps1>>"%~dp0..\..\..\TestResults\RunTestsEntrypoint.ps1"
docker run -i --rm --memory 4g -v "%~dp0..\..\..\TestResults:C:\BuildUnderTest\TestResults" registry.gitlab.com/warewolf/vstest:%1 powershell -File C:\BuildUnderTest\TestResults\RunTestsEntrypoint.ps1