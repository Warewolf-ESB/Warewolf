/*
*  Warewolf - Once bitten, there's no going back
*  Copyright 2020 by Warewolf Ltd <alpha@warewolf.io>
*  Licensed under GNU Affero General Public License 3.0 or later.
*  Some rights reserved.
*  Visit our website for more information <http://warewolf.io/>
*  AUTHORS <http://warewolf.io/authors.php> , CONTRIBUTORS <http://warewolf.io/contributors.php>
*  @license GNU Affero General Public License <http://www.gnu.org/licenses/agpl-3.0.html>
*/

using System;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Xml.Linq;
using Dev2.Common.Interfaces;
using Dev2.Common.Interfaces.Explorer;
using Dev2.Common.Interfaces.ToolBase.ExchangeEmail;
using Dev2.Common.Interfaces.Versioning;
using Dev2.Studio.ViewModels;
using Dev2.Util;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using Moq;
using Dev2.Studio.Interfaces;
using Microsoft.Practices.Prism.Mvvm;
using Dev2.Studio.Core;
using Warewolf.Data;
using Action = System.Action;

namespace Dev2.Core.Tests
{
    [TestClass]
    [TestCategory("Studio Worksurfaces Core")]
    public class WorksurfaceContextManagerTests : MainViewModelBase
    {
        Action _verifyAction;
        Action _setActiveServerAction;

        [TestInitialize]
        public void Initialize()
        {
            AppUsageStats.LocalHost = "http://localhost:3142";
            var svr = new Mock<IServer>();
            svr.Setup(a => a.DisplayName).Returns("Localhost");
            var workFlow = XML.XmlResource.Fetch("ResourceWithErrors");
            svr.Setup(server => server.ProxyLayer.GetVersion(It.IsAny<IVersionInfo>(), It.IsAny<Guid>()))
            .Returns(new StringBuilder(workFlow.ToString(SaveOptions.DisableFormatting)));
            _verifyAction = () =>
            {
                svr.Verify(server => server.ProxyLayer.GetVersion(It.IsAny<IVersionInfo>(), It.IsAny<Guid>()));
            };
            _setActiveServerAction = () =>
            {
                _shellViewModel.ActiveServer = svr.Object;
            };
            var ac = new Task<IExplorerItem>(() => new Mock<IExplorerItem>().Object);
            svr.Setup(a => a.LoadExplorer(false)).Returns(() => ac);
            CustomContainer.Register(svr.Object);
            CustomContainer.Register(new Mock<Microsoft.Practices.Prism.PubSubEvents.IEventAggregator>().Object);
        }

        [TestMethod]
        [Owner("Nkosinathi Sangweni")]
        public void Constructor_GivenIsCalled_ShouldPassThrough()
        {
            //---------------Set up test pack-------------------
            CreateFullExportsAndVm();
            var sorksurfaceContextManager = new WorksurfaceContextManager(false, _shellViewModel);
            //---------------Assert Precondition----------------

            //---------------Execute Test ----------------------

            //---------------Test Result -----------------------
            Assert.IsNotNull(sorksurfaceContextManager);
        }

        [TestMethod]
        [Owner("Nkosinathi Sangweni")]
        public void EditResource_GivenIsSharepointSource_ShouldPassThrough()
        {
            //---------------Set up test pack-------------------
            CreateFullExportsAndVm();
            var sharePointSource = new Mock<ISharepointServerSource>();
            var viewMock = new Mock<IView>();
            sharePointSource.SetupAllProperties();
            var sorksurfaceContextManager = new WorksurfaceContextManager(false, _shellViewModel);
            var beforeCount = _shellViewModel.Items.Count;
            //---------------Assert Precondition----------------
            Assert.IsNotNull(sorksurfaceContextManager);
            //---------------Execute Test ----------------------

            sorksurfaceContextManager.EditResource(sharePointSource.Object, viewMock.Object);
            var afterCount = _shellViewModel.Items.Count;
            //---------------Test Result -----------------------
            Assert.IsTrue(afterCount > beforeCount);
        }

        [TestMethod]
        [Owner("Nkosinathi Sangweni")]
        [DoNotParallelize]
        public void EditResource_GivenIsOAuthSource_ShouldPassThrough()
        {
            //---------------Set up test pack-------------------
            CreateFullExportsAndVm();
            var sharePointSource = new Mock<IOAuthSource>();
            sharePointSource.SetupAllProperties();
            var viewMock = new Mock<IView>();
            var sorksurfaceContextManager = new WorksurfaceContextManager(false, _shellViewModel, new Mock<IServerRepository>().Object, new Mock<IViewFactory>().Object);
            var beforeCount = _shellViewModel.Items.Count;
            //---------------Assert Precondition----------------
            Assert.IsNotNull(sorksurfaceContextManager);
            //---------------Execute Test ----------------------
            sorksurfaceContextManager.EditResource(sharePointSource.Object, viewMock.Object);
            var afterCount = _shellViewModel.Items.Count;
            //---------------Test Result -----------------------
            Assert.IsTrue(afterCount > beforeCount);
        }

        [TestMethod]
        [Owner("Nkosinathi Sangweni")]
        public void EditWcfSource_GivenResourceModel_ShouldPassThrough()
        {
            //---------------Set up test pack-------------------
            CreateFullExportsAndVm();
            var resourceModelMock = new Mock<IContextualResourceModel>();
            const string WorkFlowXaml = "<XamlDefinition>&lt;Activity x:Class=\"PBI 6690 - TEST\" xmlns=\"http://schemas.microsoft.com/netfx/2009/xaml/activities\" xmlns:av=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" xmlns:dc=\"clr-namespace:Dev2.Common;assembly=Dev2.CommonDataUtils\" xmlns:ddc=\"clr-namespace:Dev2.DataList.Contract;assembly=Dev2.Data\" xmlns:ddcb=\"clr-namespace:Dev2.DataList.Contract.Binary_Objects;assembly=Dev2.Data\" xmlns:ddd=\"clr-namespace:Dev2.Data.Decision;assembly=Dev2.Data\" xmlns:dddo=\"clr-namespace:Dev2.Data.Decisions.Operations;assembly=Dev2.Data\" xmlns:ddsm=\"clr-namespace:Dev2.Data.SystemTemplates.Models;assembly=Dev2.Data\" xmlns:mva=\"clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities\" xmlns:s=\"clr-namespace:System;assembly=mscorlib\" xmlns:sap=\"http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation\" xmlns:scg=\"clr-namespace:System.Collections.Generic;assembly=mscorlib\" xmlns:sco=\"clr-namespace:System.Collections.ObjectModel;assembly=mscorlib\" xmlns:uaba=\"clr-namespace:Unlimited.Applications.BusinessDesignStudio.Activities;assembly=Dev2.Activities\" xmlns:uf=\"clr-namespace:Unlimited.Framework;assembly=Dev2.Core\" xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"&gt;&lt;x:Members&gt;&lt;x:Property Name=\"AmbientDataList\" Type=\"InOutArgument(scg:List(x:String))\" /&gt;&lt;x:Property Name=\"ParentWorkflowInstanceId\" Type=\"InOutArgument(s:Guid)\" /&gt;&lt;x:Property Name=\"ParentServiceName\" Type=\"InOutArgument(x:String)\" /&gt;&lt;/x:Members&gt;&lt;sap:VirtualizedContainerService.HintSize&gt;654,676&lt;/sap:VirtualizedContainerService.HintSize&gt;&lt;mva:VisualBasic.Settings&gt;Assembly references and imported namespaces serialized as XML namespaces&lt;/mva:VisualBasic.Settings&gt;&lt;TextExpression.NamespacesForImplementation&gt;&lt;scg:List x:TypeArguments=\"x:String\" Capacity=\"7\"&gt;&lt;x:String&gt;Dev2.CommonDataUtils&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.Decisions.Operations&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.SystemTemplates.Models&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract.Binary_Objects&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Framework&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Applications.BusinessDesignStudio.Activities&lt;/x:String&gt;&lt;/scg:List&gt;&lt;/TextExpression.NamespacesForImplementation&gt;&lt;TextExpression.ReferencesForImplementation&gt;&lt;sco:Collection x:TypeArguments=\"AssemblyReference\"&gt;&lt;AssemblyReference&gt;Dev2.CommonDataUtils&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Data&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Core&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Activities&lt;/AssemblyReference&gt;&lt;/sco:Collection&gt;&lt;/TextExpression.ReferencesForImplementation&gt;&lt;Flowchart DisplayName=\"PBI 6690 - TEST\" sap:VirtualizedContainerService.HintSize=\"614,636\"&gt;&lt;Flowchart.Variables&gt;&lt;Variable x:TypeArguments=\"scg:List(x:String)\" Name=\"InstructionList\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"LastResult\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"HasError\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"ExplicitDataList\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"IsValid\" /&gt;&lt;Variable x:TypeArguments=\"uf:UnlimitedObject\" Name=\"d\" /&gt;&lt;Variable x:TypeArguments=\"uaba:Util\" Name=\"t\" /&gt;&lt;Variable x:TypeArguments=\"ddd:Dev2DataListDecisionHandler\" Name=\"Dev2DecisionHandler\" /&gt;&lt;/Flowchart.Variables&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;False&lt;/x:Boolean&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;270,2.5&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;60,75&lt;/av:Size&gt;&lt;av:PointCollection x:Key=\"ConnectorLocation\"&gt;300,77.5 300,107.5 310,107.5 310,211&lt;/av:PointCollection&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;Flowchart.StartNode&gt;&lt;x:Reference&gt;__ReferenceID0&lt;/x:Reference&gt;&lt;/Flowchart.StartNode&gt;&lt;FlowStep x:Name=\"__ReferenceID0\"&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;185,211&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,84&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActionName=\"{x:Null}\" ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"PBI 6690 - TEST Inputs\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"localhost\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,84\" IconPath=\"pack://application:,,,/Warewolf Studio;component/images/Workflow-32.png\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;n1&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n2&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n3&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"True\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;result&amp;quot; MapsTo=&amp;quot;result&amp;quot; Value=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"PBI 6690 - TEST Inputs\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"PBI 6690 - TEST Inputs\" Type=\"Workflow\" UniqueID=\"edadb62e-83f4-44bf-a260-7639d6b43169\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.HelpLink&gt;&lt;InArgument x:TypeArguments=\"x:String\"&gt;&lt;Literal x:TypeArguments=\"x:String\" Value=\"\" /&gt;&lt;/InArgument&gt;&lt;/uaba:DsfActivity.HelpLink&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;FlowStep&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;145,390&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,100&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" HelpLink=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" ActionName=\"dbo.spGetCountries\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"Countries\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"CitiesDb\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,100\" IconPath=\"[Nothing]\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;Prefix&amp;quot; Source=&amp;quot;Prefix&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"False\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;CountryID&amp;quot; MapsTo=&amp;quot;CountryID&amp;quot; Value=&amp;quot;[[GetCountries().CountryID]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;Output Name=&amp;quot;Description&amp;quot; MapsTo=&amp;quot;Name&amp;quot; Value=&amp;quot;[[GetCountries().Name]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"Countries\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"Countries\" Type=\"InvokeStoredProc\" UniqueID=\"33476822-9519-4ad5-8fee-1ae3b571115b\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;/Flowchart&gt;&lt;/Activity&gt;</XamlDefinition>";
            resourceModelMock.SetupGet(model => model.WorkflowXaml).Returns(new StringBuilder(WorkFlowXaml));
            resourceModelMock.SetupGet(model => model.Environment.EnvironmentID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ServerID).Returns(Guid.NewGuid);
            var view = new Mock<IView>();
            resourceModelMock.Setup(model => model.GetView(It.IsAny<Func<IView>>())).Returns(view.Object);
            var sorksurfaceContextManager = new WorksurfaceContextManager(false, _shellViewModel);
            var beforeCount = _shellViewModel.Items.Count;
            //---------------Assert Precondition----------------
            Assert.IsNotNull(sorksurfaceContextManager);
            //---------------Execute Test ----------------------
            sorksurfaceContextManager.EditWcfSource(resourceModelMock.Object, view.Object);
            var afterCount = _shellViewModel.Items.Count;
            //---------------Test Result -----------------------
            Assert.IsTrue(afterCount > beforeCount);
        }

        [TestMethod]
        [Owner("Nkosinathi Sangweni")]
        public void EditRabbitMQSource_GivenResourceModel_ShouldPassThrough()
        {
            //---------------Set up test pack-------------------
            CreateFullExportsAndVm();
            var resourceModelMock = new Mock<IContextualResourceModel>();
            const string WorkFlowXaml = "<XamlDefinition>&lt;Activity x:Class=\"PBI 6690 - TEST\" xmlns=\"http://schemas.microsoft.com/netfx/2009/xaml/activities\" xmlns:av=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" xmlns:dc=\"clr-namespace:Dev2.Common;assembly=Dev2.CommonDataUtils\" xmlns:ddc=\"clr-namespace:Dev2.DataList.Contract;assembly=Dev2.Data\" xmlns:ddcb=\"clr-namespace:Dev2.DataList.Contract.Binary_Objects;assembly=Dev2.Data\" xmlns:ddd=\"clr-namespace:Dev2.Data.Decision;assembly=Dev2.Data\" xmlns:dddo=\"clr-namespace:Dev2.Data.Decisions.Operations;assembly=Dev2.Data\" xmlns:ddsm=\"clr-namespace:Dev2.Data.SystemTemplates.Models;assembly=Dev2.Data\" xmlns:mva=\"clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities\" xmlns:s=\"clr-namespace:System;assembly=mscorlib\" xmlns:sap=\"http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation\" xmlns:scg=\"clr-namespace:System.Collections.Generic;assembly=mscorlib\" xmlns:sco=\"clr-namespace:System.Collections.ObjectModel;assembly=mscorlib\" xmlns:uaba=\"clr-namespace:Unlimited.Applications.BusinessDesignStudio.Activities;assembly=Dev2.Activities\" xmlns:uf=\"clr-namespace:Unlimited.Framework;assembly=Dev2.Core\" xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"&gt;&lt;x:Members&gt;&lt;x:Property Name=\"AmbientDataList\" Type=\"InOutArgument(scg:List(x:String))\" /&gt;&lt;x:Property Name=\"ParentWorkflowInstanceId\" Type=\"InOutArgument(s:Guid)\" /&gt;&lt;x:Property Name=\"ParentServiceName\" Type=\"InOutArgument(x:String)\" /&gt;&lt;/x:Members&gt;&lt;sap:VirtualizedContainerService.HintSize&gt;654,676&lt;/sap:VirtualizedContainerService.HintSize&gt;&lt;mva:VisualBasic.Settings&gt;Assembly references and imported namespaces serialized as XML namespaces&lt;/mva:VisualBasic.Settings&gt;&lt;TextExpression.NamespacesForImplementation&gt;&lt;scg:List x:TypeArguments=\"x:String\" Capacity=\"7\"&gt;&lt;x:String&gt;Dev2.CommonDataUtils&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.Decisions.Operations&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.SystemTemplates.Models&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract.Binary_Objects&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Framework&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Applications.BusinessDesignStudio.Activities&lt;/x:String&gt;&lt;/scg:List&gt;&lt;/TextExpression.NamespacesForImplementation&gt;&lt;TextExpression.ReferencesForImplementation&gt;&lt;sco:Collection x:TypeArguments=\"AssemblyReference\"&gt;&lt;AssemblyReference&gt;Dev2.CommonDataUtils&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Data&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Core&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Activities&lt;/AssemblyReference&gt;&lt;/sco:Collection&gt;&lt;/TextExpression.ReferencesForImplementation&gt;&lt;Flowchart DisplayName=\"PBI 6690 - TEST\" sap:VirtualizedContainerService.HintSize=\"614,636\"&gt;&lt;Flowchart.Variables&gt;&lt;Variable x:TypeArguments=\"scg:List(x:String)\" Name=\"InstructionList\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"LastResult\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"HasError\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"ExplicitDataList\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"IsValid\" /&gt;&lt;Variable x:TypeArguments=\"uf:UnlimitedObject\" Name=\"d\" /&gt;&lt;Variable x:TypeArguments=\"uaba:Util\" Name=\"t\" /&gt;&lt;Variable x:TypeArguments=\"ddd:Dev2DataListDecisionHandler\" Name=\"Dev2DecisionHandler\" /&gt;&lt;/Flowchart.Variables&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;False&lt;/x:Boolean&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;270,2.5&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;60,75&lt;/av:Size&gt;&lt;av:PointCollection x:Key=\"ConnectorLocation\"&gt;300,77.5 300,107.5 310,107.5 310,211&lt;/av:PointCollection&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;Flowchart.StartNode&gt;&lt;x:Reference&gt;__ReferenceID0&lt;/x:Reference&gt;&lt;/Flowchart.StartNode&gt;&lt;FlowStep x:Name=\"__ReferenceID0\"&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;185,211&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,84&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActionName=\"{x:Null}\" ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"PBI 6690 - TEST Inputs\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"localhost\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,84\" IconPath=\"pack://application:,,,/Warewolf Studio;component/images/Workflow-32.png\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;n1&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n2&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n3&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"True\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;result&amp;quot; MapsTo=&amp;quot;result&amp;quot; Value=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"PBI 6690 - TEST Inputs\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"PBI 6690 - TEST Inputs\" Type=\"Workflow\" UniqueID=\"edadb62e-83f4-44bf-a260-7639d6b43169\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.HelpLink&gt;&lt;InArgument x:TypeArguments=\"x:String\"&gt;&lt;Literal x:TypeArguments=\"x:String\" Value=\"\" /&gt;&lt;/InArgument&gt;&lt;/uaba:DsfActivity.HelpLink&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;FlowStep&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;145,390&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,100&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" HelpLink=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" ActionName=\"dbo.spGetCountries\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"Countries\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"CitiesDb\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,100\" IconPath=\"[Nothing]\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;Prefix&amp;quot; Source=&amp;quot;Prefix&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"False\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;CountryID&amp;quot; MapsTo=&amp;quot;CountryID&amp;quot; Value=&amp;quot;[[GetCountries().CountryID]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;Output Name=&amp;quot;Description&amp;quot; MapsTo=&amp;quot;Name&amp;quot; Value=&amp;quot;[[GetCountries().Name]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"Countries\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"Countries\" Type=\"InvokeStoredProc\" UniqueID=\"33476822-9519-4ad5-8fee-1ae3b571115b\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;/Flowchart&gt;&lt;/Activity&gt;</XamlDefinition>";
            resourceModelMock.SetupGet(model => model.WorkflowXaml).Returns(new StringBuilder(WorkFlowXaml));
            resourceModelMock.SetupGet(model => model.Environment.EnvironmentID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ServerID).Returns(Guid.NewGuid);
            var view = new Mock<IView>();
            resourceModelMock.Setup(model => model.GetView(It.IsAny<Func<IView>>())).Returns(view.Object);
            var sorksurfaceContextManager = new WorksurfaceContextManager(false, _shellViewModel);
            var beforeCount = _shellViewModel.Items.Count;
            //---------------Assert Precondition----------------
            Assert.IsNotNull(sorksurfaceContextManager);
            //---------------Execute Test ----------------------
            sorksurfaceContextManager.EditRabbitMQSource(resourceModelMock.Object, view.Object);
            var afterCount = _shellViewModel.Items.Count;
            //---------------Test Result -----------------------
            Assert.IsTrue(afterCount > beforeCount);
        }

        [TestMethod]
        [Owner("Nkosinathi Sangweni")]
        public void EditDropBoxSource_GivenResourceModel_ShouldPassThrough()
        {
            //---------------Set up test pack-------------------
            CreateFullExportsAndVm();
            var resourceModelMock = new Mock<IContextualResourceModel>();
            const string WorkFlowXaml = "<XamlDefinition>&lt;Activity x:Class=\"PBI 6690 - TEST\" xmlns=\"http://schemas.microsoft.com/netfx/2009/xaml/activities\" xmlns:av=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" xmlns:dc=\"clr-namespace:Dev2.Common;assembly=Dev2.CommonDataUtils\" xmlns:ddc=\"clr-namespace:Dev2.DataList.Contract;assembly=Dev2.Data\" xmlns:ddcb=\"clr-namespace:Dev2.DataList.Contract.Binary_Objects;assembly=Dev2.Data\" xmlns:ddd=\"clr-namespace:Dev2.Data.Decision;assembly=Dev2.Data\" xmlns:dddo=\"clr-namespace:Dev2.Data.Decisions.Operations;assembly=Dev2.Data\" xmlns:ddsm=\"clr-namespace:Dev2.Data.SystemTemplates.Models;assembly=Dev2.Data\" xmlns:mva=\"clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities\" xmlns:s=\"clr-namespace:System;assembly=mscorlib\" xmlns:sap=\"http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation\" xmlns:scg=\"clr-namespace:System.Collections.Generic;assembly=mscorlib\" xmlns:sco=\"clr-namespace:System.Collections.ObjectModel;assembly=mscorlib\" xmlns:uaba=\"clr-namespace:Unlimited.Applications.BusinessDesignStudio.Activities;assembly=Dev2.Activities\" xmlns:uf=\"clr-namespace:Unlimited.Framework;assembly=Dev2.Core\" xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"&gt;&lt;x:Members&gt;&lt;x:Property Name=\"AmbientDataList\" Type=\"InOutArgument(scg:List(x:String))\" /&gt;&lt;x:Property Name=\"ParentWorkflowInstanceId\" Type=\"InOutArgument(s:Guid)\" /&gt;&lt;x:Property Name=\"ParentServiceName\" Type=\"InOutArgument(x:String)\" /&gt;&lt;/x:Members&gt;&lt;sap:VirtualizedContainerService.HintSize&gt;654,676&lt;/sap:VirtualizedContainerService.HintSize&gt;&lt;mva:VisualBasic.Settings&gt;Assembly references and imported namespaces serialized as XML namespaces&lt;/mva:VisualBasic.Settings&gt;&lt;TextExpression.NamespacesForImplementation&gt;&lt;scg:List x:TypeArguments=\"x:String\" Capacity=\"7\"&gt;&lt;x:String&gt;Dev2.CommonDataUtils&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.Decisions.Operations&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.SystemTemplates.Models&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract.Binary_Objects&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Framework&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Applications.BusinessDesignStudio.Activities&lt;/x:String&gt;&lt;/scg:List&gt;&lt;/TextExpression.NamespacesForImplementation&gt;&lt;TextExpression.ReferencesForImplementation&gt;&lt;sco:Collection x:TypeArguments=\"AssemblyReference\"&gt;&lt;AssemblyReference&gt;Dev2.CommonDataUtils&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Data&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Core&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Activities&lt;/AssemblyReference&gt;&lt;/sco:Collection&gt;&lt;/TextExpression.ReferencesForImplementation&gt;&lt;Flowchart DisplayName=\"PBI 6690 - TEST\" sap:VirtualizedContainerService.HintSize=\"614,636\"&gt;&lt;Flowchart.Variables&gt;&lt;Variable x:TypeArguments=\"scg:List(x:String)\" Name=\"InstructionList\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"LastResult\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"HasError\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"ExplicitDataList\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"IsValid\" /&gt;&lt;Variable x:TypeArguments=\"uf:UnlimitedObject\" Name=\"d\" /&gt;&lt;Variable x:TypeArguments=\"uaba:Util\" Name=\"t\" /&gt;&lt;Variable x:TypeArguments=\"ddd:Dev2DataListDecisionHandler\" Name=\"Dev2DecisionHandler\" /&gt;&lt;/Flowchart.Variables&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;False&lt;/x:Boolean&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;270,2.5&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;60,75&lt;/av:Size&gt;&lt;av:PointCollection x:Key=\"ConnectorLocation\"&gt;300,77.5 300,107.5 310,107.5 310,211&lt;/av:PointCollection&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;Flowchart.StartNode&gt;&lt;x:Reference&gt;__ReferenceID0&lt;/x:Reference&gt;&lt;/Flowchart.StartNode&gt;&lt;FlowStep x:Name=\"__ReferenceID0\"&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;185,211&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,84&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActionName=\"{x:Null}\" ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"PBI 6690 - TEST Inputs\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"localhost\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,84\" IconPath=\"pack://application:,,,/Warewolf Studio;component/images/Workflow-32.png\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;n1&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n2&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n3&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"True\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;result&amp;quot; MapsTo=&amp;quot;result&amp;quot; Value=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"PBI 6690 - TEST Inputs\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"PBI 6690 - TEST Inputs\" Type=\"Workflow\" UniqueID=\"edadb62e-83f4-44bf-a260-7639d6b43169\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.HelpLink&gt;&lt;InArgument x:TypeArguments=\"x:String\"&gt;&lt;Literal x:TypeArguments=\"x:String\" Value=\"\" /&gt;&lt;/InArgument&gt;&lt;/uaba:DsfActivity.HelpLink&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;FlowStep&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;145,390&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,100&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" HelpLink=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" ActionName=\"dbo.spGetCountries\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"Countries\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"CitiesDb\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,100\" IconPath=\"[Nothing]\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;Prefix&amp;quot; Source=&amp;quot;Prefix&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"False\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;CountryID&amp;quot; MapsTo=&amp;quot;CountryID&amp;quot; Value=&amp;quot;[[GetCountries().CountryID]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;Output Name=&amp;quot;Description&amp;quot; MapsTo=&amp;quot;Name&amp;quot; Value=&amp;quot;[[GetCountries().Name]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"Countries\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"Countries\" Type=\"InvokeStoredProc\" UniqueID=\"33476822-9519-4ad5-8fee-1ae3b571115b\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;/Flowchart&gt;&lt;/Activity&gt;</XamlDefinition>";
            resourceModelMock.SetupGet(model => model.WorkflowXaml).Returns(new StringBuilder(WorkFlowXaml));
            resourceModelMock.SetupGet(model => model.Environment.EnvironmentID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ServerID).Returns(Guid.NewGuid);
            var view = new Mock<IView>();
            resourceModelMock.Setup(model => model.GetView(It.IsAny<Func<IView>>())).Returns(view.Object);
            var sorksurfaceContextManager = new WorksurfaceContextManager(false, _shellViewModel);
            var beforeCount = _shellViewModel.Items.Count;
            //---------------Assert Precondition----------------
            Assert.IsNotNull(sorksurfaceContextManager);
            //---------------Execute Test ----------------------
            sorksurfaceContextManager.EditDropBoxSource(resourceModelMock.Object, view.Object);
            var afterCount = _shellViewModel.Items.Count;
            //---------------Test Result -----------------------
            Assert.IsTrue(afterCount > beforeCount);
        }

        [TestMethod]
        [Owner("Nkosinathi Sangweni")]
        public void EditExchangeSource_GivenResourceModel_ShouldPassThrough()
        {
            //---------------Set up test pack-------------------
            CreateFullExportsAndVm();
            var resourceModelMock = new Mock<IContextualResourceModel>();
            const string WorkFlowXaml = "<XamlDefinition>&lt;Activity x:Class=\"PBI 6690 - TEST\" xmlns=\"http://schemas.microsoft.com/netfx/2009/xaml/activities\" xmlns:av=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" xmlns:dc=\"clr-namespace:Dev2.Common;assembly=Dev2.CommonDataUtils\" xmlns:ddc=\"clr-namespace:Dev2.DataList.Contract;assembly=Dev2.Data\" xmlns:ddcb=\"clr-namespace:Dev2.DataList.Contract.Binary_Objects;assembly=Dev2.Data\" xmlns:ddd=\"clr-namespace:Dev2.Data.Decision;assembly=Dev2.Data\" xmlns:dddo=\"clr-namespace:Dev2.Data.Decisions.Operations;assembly=Dev2.Data\" xmlns:ddsm=\"clr-namespace:Dev2.Data.SystemTemplates.Models;assembly=Dev2.Data\" xmlns:mva=\"clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities\" xmlns:s=\"clr-namespace:System;assembly=mscorlib\" xmlns:sap=\"http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation\" xmlns:scg=\"clr-namespace:System.Collections.Generic;assembly=mscorlib\" xmlns:sco=\"clr-namespace:System.Collections.ObjectModel;assembly=mscorlib\" xmlns:uaba=\"clr-namespace:Unlimited.Applications.BusinessDesignStudio.Activities;assembly=Dev2.Activities\" xmlns:uf=\"clr-namespace:Unlimited.Framework;assembly=Dev2.Core\" xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"&gt;&lt;x:Members&gt;&lt;x:Property Name=\"AmbientDataList\" Type=\"InOutArgument(scg:List(x:String))\" /&gt;&lt;x:Property Name=\"ParentWorkflowInstanceId\" Type=\"InOutArgument(s:Guid)\" /&gt;&lt;x:Property Name=\"ParentServiceName\" Type=\"InOutArgument(x:String)\" /&gt;&lt;/x:Members&gt;&lt;sap:VirtualizedContainerService.HintSize&gt;654,676&lt;/sap:VirtualizedContainerService.HintSize&gt;&lt;mva:VisualBasic.Settings&gt;Assembly references and imported namespaces serialized as XML namespaces&lt;/mva:VisualBasic.Settings&gt;&lt;TextExpression.NamespacesForImplementation&gt;&lt;scg:List x:TypeArguments=\"x:String\" Capacity=\"7\"&gt;&lt;x:String&gt;Dev2.CommonDataUtils&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.Decisions.Operations&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.SystemTemplates.Models&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract.Binary_Objects&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Framework&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Applications.BusinessDesignStudio.Activities&lt;/x:String&gt;&lt;/scg:List&gt;&lt;/TextExpression.NamespacesForImplementation&gt;&lt;TextExpression.ReferencesForImplementation&gt;&lt;sco:Collection x:TypeArguments=\"AssemblyReference\"&gt;&lt;AssemblyReference&gt;Dev2.CommonDataUtils&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Data&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Core&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Activities&lt;/AssemblyReference&gt;&lt;/sco:Collection&gt;&lt;/TextExpression.ReferencesForImplementation&gt;&lt;Flowchart DisplayName=\"PBI 6690 - TEST\" sap:VirtualizedContainerService.HintSize=\"614,636\"&gt;&lt;Flowchart.Variables&gt;&lt;Variable x:TypeArguments=\"scg:List(x:String)\" Name=\"InstructionList\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"LastResult\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"HasError\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"ExplicitDataList\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"IsValid\" /&gt;&lt;Variable x:TypeArguments=\"uf:UnlimitedObject\" Name=\"d\" /&gt;&lt;Variable x:TypeArguments=\"uaba:Util\" Name=\"t\" /&gt;&lt;Variable x:TypeArguments=\"ddd:Dev2DataListDecisionHandler\" Name=\"Dev2DecisionHandler\" /&gt;&lt;/Flowchart.Variables&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;False&lt;/x:Boolean&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;270,2.5&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;60,75&lt;/av:Size&gt;&lt;av:PointCollection x:Key=\"ConnectorLocation\"&gt;300,77.5 300,107.5 310,107.5 310,211&lt;/av:PointCollection&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;Flowchart.StartNode&gt;&lt;x:Reference&gt;__ReferenceID0&lt;/x:Reference&gt;&lt;/Flowchart.StartNode&gt;&lt;FlowStep x:Name=\"__ReferenceID0\"&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;185,211&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,84&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActionName=\"{x:Null}\" ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"PBI 6690 - TEST Inputs\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"localhost\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,84\" IconPath=\"pack://application:,,,/Warewolf Studio;component/images/Workflow-32.png\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;n1&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n2&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n3&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"True\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;result&amp;quot; MapsTo=&amp;quot;result&amp;quot; Value=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"PBI 6690 - TEST Inputs\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"PBI 6690 - TEST Inputs\" Type=\"Workflow\" UniqueID=\"edadb62e-83f4-44bf-a260-7639d6b43169\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.HelpLink&gt;&lt;InArgument x:TypeArguments=\"x:String\"&gt;&lt;Literal x:TypeArguments=\"x:String\" Value=\"\" /&gt;&lt;/InArgument&gt;&lt;/uaba:DsfActivity.HelpLink&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;FlowStep&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;145,390&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,100&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" HelpLink=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" ActionName=\"dbo.spGetCountries\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"Countries\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"CitiesDb\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,100\" IconPath=\"[Nothing]\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;Prefix&amp;quot; Source=&amp;quot;Prefix&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"False\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;CountryID&amp;quot; MapsTo=&amp;quot;CountryID&amp;quot; Value=&amp;quot;[[GetCountries().CountryID]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;Output Name=&amp;quot;Description&amp;quot; MapsTo=&amp;quot;Name&amp;quot; Value=&amp;quot;[[GetCountries().Name]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"Countries\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"Countries\" Type=\"InvokeStoredProc\" UniqueID=\"33476822-9519-4ad5-8fee-1ae3b571115b\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;/Flowchart&gt;&lt;/Activity&gt;</XamlDefinition>";
            resourceModelMock.SetupGet(model => model.WorkflowXaml).Returns(new StringBuilder(WorkFlowXaml));
            resourceModelMock.SetupGet(model => model.Environment.EnvironmentID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ServerID).Returns(Guid.NewGuid);
            var view = new Mock<IView>();
            resourceModelMock.Setup(model => model.GetView(It.IsAny<Func<IView>>())).Returns(view.Object);
            var sorksurfaceContextManager = new WorksurfaceContextManager(false, _shellViewModel);
            var beforeCount = _shellViewModel.Items.Count;
            //---------------Assert Precondition----------------
            Assert.IsNotNull(sorksurfaceContextManager);
            //---------------Execute Test ----------------------
            sorksurfaceContextManager.EditExchangeSource(resourceModelMock.Object, view.Object);
            var afterCount = _shellViewModel.Items.Count;
            //---------------Test Result -----------------------
            Assert.IsTrue(afterCount > beforeCount);
        }

        [TestMethod]
        [Owner("Nkosinathi Sangweni")]
        public void EditEmailSource_GivenResourceModel_ShouldPassThrough()
        {
            //---------------Set up test pack-------------------
            CreateFullExportsAndVm();
            var resourceModelMock = new Mock<IContextualResourceModel>();
            const string WorkFlowXaml = "<XamlDefinition>&lt;Activity x:Class=\"PBI 6690 - TEST\" xmlns=\"http://schemas.microsoft.com/netfx/2009/xaml/activities\" xmlns:av=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" xmlns:dc=\"clr-namespace:Dev2.Common;assembly=Dev2.CommonDataUtils\" xmlns:ddc=\"clr-namespace:Dev2.DataList.Contract;assembly=Dev2.Data\" xmlns:ddcb=\"clr-namespace:Dev2.DataList.Contract.Binary_Objects;assembly=Dev2.Data\" xmlns:ddd=\"clr-namespace:Dev2.Data.Decision;assembly=Dev2.Data\" xmlns:dddo=\"clr-namespace:Dev2.Data.Decisions.Operations;assembly=Dev2.Data\" xmlns:ddsm=\"clr-namespace:Dev2.Data.SystemTemplates.Models;assembly=Dev2.Data\" xmlns:mva=\"clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities\" xmlns:s=\"clr-namespace:System;assembly=mscorlib\" xmlns:sap=\"http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation\" xmlns:scg=\"clr-namespace:System.Collections.Generic;assembly=mscorlib\" xmlns:sco=\"clr-namespace:System.Collections.ObjectModel;assembly=mscorlib\" xmlns:uaba=\"clr-namespace:Unlimited.Applications.BusinessDesignStudio.Activities;assembly=Dev2.Activities\" xmlns:uf=\"clr-namespace:Unlimited.Framework;assembly=Dev2.Core\" xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"&gt;&lt;x:Members&gt;&lt;x:Property Name=\"AmbientDataList\" Type=\"InOutArgument(scg:List(x:String))\" /&gt;&lt;x:Property Name=\"ParentWorkflowInstanceId\" Type=\"InOutArgument(s:Guid)\" /&gt;&lt;x:Property Name=\"ParentServiceName\" Type=\"InOutArgument(x:String)\" /&gt;&lt;/x:Members&gt;&lt;sap:VirtualizedContainerService.HintSize&gt;654,676&lt;/sap:VirtualizedContainerService.HintSize&gt;&lt;mva:VisualBasic.Settings&gt;Assembly references and imported namespaces serialized as XML namespaces&lt;/mva:VisualBasic.Settings&gt;&lt;TextExpression.NamespacesForImplementation&gt;&lt;scg:List x:TypeArguments=\"x:String\" Capacity=\"7\"&gt;&lt;x:String&gt;Dev2.CommonDataUtils&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.Decisions.Operations&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.SystemTemplates.Models&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract.Binary_Objects&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Framework&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Applications.BusinessDesignStudio.Activities&lt;/x:String&gt;&lt;/scg:List&gt;&lt;/TextExpression.NamespacesForImplementation&gt;&lt;TextExpression.ReferencesForImplementation&gt;&lt;sco:Collection x:TypeArguments=\"AssemblyReference\"&gt;&lt;AssemblyReference&gt;Dev2.CommonDataUtils&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Data&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Core&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Activities&lt;/AssemblyReference&gt;&lt;/sco:Collection&gt;&lt;/TextExpression.ReferencesForImplementation&gt;&lt;Flowchart DisplayName=\"PBI 6690 - TEST\" sap:VirtualizedContainerService.HintSize=\"614,636\"&gt;&lt;Flowchart.Variables&gt;&lt;Variable x:TypeArguments=\"scg:List(x:String)\" Name=\"InstructionList\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"LastResult\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"HasError\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"ExplicitDataList\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"IsValid\" /&gt;&lt;Variable x:TypeArguments=\"uf:UnlimitedObject\" Name=\"d\" /&gt;&lt;Variable x:TypeArguments=\"uaba:Util\" Name=\"t\" /&gt;&lt;Variable x:TypeArguments=\"ddd:Dev2DataListDecisionHandler\" Name=\"Dev2DecisionHandler\" /&gt;&lt;/Flowchart.Variables&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;False&lt;/x:Boolean&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;270,2.5&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;60,75&lt;/av:Size&gt;&lt;av:PointCollection x:Key=\"ConnectorLocation\"&gt;300,77.5 300,107.5 310,107.5 310,211&lt;/av:PointCollection&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;Flowchart.StartNode&gt;&lt;x:Reference&gt;__ReferenceID0&lt;/x:Reference&gt;&lt;/Flowchart.StartNode&gt;&lt;FlowStep x:Name=\"__ReferenceID0\"&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;185,211&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,84&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActionName=\"{x:Null}\" ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"PBI 6690 - TEST Inputs\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"localhost\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,84\" IconPath=\"pack://application:,,,/Warewolf Studio;component/images/Workflow-32.png\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;n1&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n2&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n3&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"True\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;result&amp;quot; MapsTo=&amp;quot;result&amp;quot; Value=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"PBI 6690 - TEST Inputs\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"PBI 6690 - TEST Inputs\" Type=\"Workflow\" UniqueID=\"edadb62e-83f4-44bf-a260-7639d6b43169\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.HelpLink&gt;&lt;InArgument x:TypeArguments=\"x:String\"&gt;&lt;Literal x:TypeArguments=\"x:String\" Value=\"\" /&gt;&lt;/InArgument&gt;&lt;/uaba:DsfActivity.HelpLink&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;FlowStep&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;145,390&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,100&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" HelpLink=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" ActionName=\"dbo.spGetCountries\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"Countries\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"CitiesDb\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,100\" IconPath=\"[Nothing]\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;Prefix&amp;quot; Source=&amp;quot;Prefix&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"False\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;CountryID&amp;quot; MapsTo=&amp;quot;CountryID&amp;quot; Value=&amp;quot;[[GetCountries().CountryID]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;Output Name=&amp;quot;Description&amp;quot; MapsTo=&amp;quot;Name&amp;quot; Value=&amp;quot;[[GetCountries().Name]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"Countries\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"Countries\" Type=\"InvokeStoredProc\" UniqueID=\"33476822-9519-4ad5-8fee-1ae3b571115b\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;/Flowchart&gt;&lt;/Activity&gt;</XamlDefinition>";
            resourceModelMock.SetupGet(model => model.WorkflowXaml).Returns(new StringBuilder(WorkFlowXaml));
            resourceModelMock.SetupGet(model => model.Environment.EnvironmentID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ServerID).Returns(Guid.NewGuid);
            var view = new Mock<IView>();
            resourceModelMock.Setup(model => model.GetView(It.IsAny<Func<IView>>())).Returns(view.Object);
            var sorksurfaceContextManager = new WorksurfaceContextManager(false, _shellViewModel);
            var beforeCount = _shellViewModel.Items.Count;
            //---------------Assert Precondition----------------
            Assert.IsNotNull(sorksurfaceContextManager);
            //---------------Execute Test ----------------------
            sorksurfaceContextManager.EditEmailSource(resourceModelMock.Object, view.Object);
            var afterCount = _shellViewModel.Items.Count;
            //---------------Test Result -----------------------
            Assert.IsTrue(afterCount > beforeCount);
        }

        [TestMethod]
        [Owner("Nkosinathi Sangweni")]
        public void EditSharePointSource_GivenResourceModel_ShouldPassThrough()
        {
            //---------------Set up test pack-------------------
            CreateFullExportsAndVm();
            var resourceModelMock = new Mock<IContextualResourceModel>();
            const string WorkFlowXaml = "<XamlDefinition>&lt;Activity x:Class=\"PBI 6690 - TEST\" xmlns=\"http://schemas.microsoft.com/netfx/2009/xaml/activities\" xmlns:av=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" xmlns:dc=\"clr-namespace:Dev2.Common;assembly=Dev2.CommonDataUtils\" xmlns:ddc=\"clr-namespace:Dev2.DataList.Contract;assembly=Dev2.Data\" xmlns:ddcb=\"clr-namespace:Dev2.DataList.Contract.Binary_Objects;assembly=Dev2.Data\" xmlns:ddd=\"clr-namespace:Dev2.Data.Decision;assembly=Dev2.Data\" xmlns:dddo=\"clr-namespace:Dev2.Data.Decisions.Operations;assembly=Dev2.Data\" xmlns:ddsm=\"clr-namespace:Dev2.Data.SystemTemplates.Models;assembly=Dev2.Data\" xmlns:mva=\"clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities\" xmlns:s=\"clr-namespace:System;assembly=mscorlib\" xmlns:sap=\"http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation\" xmlns:scg=\"clr-namespace:System.Collections.Generic;assembly=mscorlib\" xmlns:sco=\"clr-namespace:System.Collections.ObjectModel;assembly=mscorlib\" xmlns:uaba=\"clr-namespace:Unlimited.Applications.BusinessDesignStudio.Activities;assembly=Dev2.Activities\" xmlns:uf=\"clr-namespace:Unlimited.Framework;assembly=Dev2.Core\" xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"&gt;&lt;x:Members&gt;&lt;x:Property Name=\"AmbientDataList\" Type=\"InOutArgument(scg:List(x:String))\" /&gt;&lt;x:Property Name=\"ParentWorkflowInstanceId\" Type=\"InOutArgument(s:Guid)\" /&gt;&lt;x:Property Name=\"ParentServiceName\" Type=\"InOutArgument(x:String)\" /&gt;&lt;/x:Members&gt;&lt;sap:VirtualizedContainerService.HintSize&gt;654,676&lt;/sap:VirtualizedContainerService.HintSize&gt;&lt;mva:VisualBasic.Settings&gt;Assembly references and imported namespaces serialized as XML namespaces&lt;/mva:VisualBasic.Settings&gt;&lt;TextExpression.NamespacesForImplementation&gt;&lt;scg:List x:TypeArguments=\"x:String\" Capacity=\"7\"&gt;&lt;x:String&gt;Dev2.CommonDataUtils&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.Decisions.Operations&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.SystemTemplates.Models&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract.Binary_Objects&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Framework&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Applications.BusinessDesignStudio.Activities&lt;/x:String&gt;&lt;/scg:List&gt;&lt;/TextExpression.NamespacesForImplementation&gt;&lt;TextExpression.ReferencesForImplementation&gt;&lt;sco:Collection x:TypeArguments=\"AssemblyReference\"&gt;&lt;AssemblyReference&gt;Dev2.CommonDataUtils&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Data&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Core&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Activities&lt;/AssemblyReference&gt;&lt;/sco:Collection&gt;&lt;/TextExpression.ReferencesForImplementation&gt;&lt;Flowchart DisplayName=\"PBI 6690 - TEST\" sap:VirtualizedContainerService.HintSize=\"614,636\"&gt;&lt;Flowchart.Variables&gt;&lt;Variable x:TypeArguments=\"scg:List(x:String)\" Name=\"InstructionList\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"LastResult\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"HasError\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"ExplicitDataList\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"IsValid\" /&gt;&lt;Variable x:TypeArguments=\"uf:UnlimitedObject\" Name=\"d\" /&gt;&lt;Variable x:TypeArguments=\"uaba:Util\" Name=\"t\" /&gt;&lt;Variable x:TypeArguments=\"ddd:Dev2DataListDecisionHandler\" Name=\"Dev2DecisionHandler\" /&gt;&lt;/Flowchart.Variables&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;False&lt;/x:Boolean&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;270,2.5&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;60,75&lt;/av:Size&gt;&lt;av:PointCollection x:Key=\"ConnectorLocation\"&gt;300,77.5 300,107.5 310,107.5 310,211&lt;/av:PointCollection&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;Flowchart.StartNode&gt;&lt;x:Reference&gt;__ReferenceID0&lt;/x:Reference&gt;&lt;/Flowchart.StartNode&gt;&lt;FlowStep x:Name=\"__ReferenceID0\"&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;185,211&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,84&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActionName=\"{x:Null}\" ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"PBI 6690 - TEST Inputs\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"localhost\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,84\" IconPath=\"pack://application:,,,/Warewolf Studio;component/images/Workflow-32.png\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;n1&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n2&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n3&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"True\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;result&amp;quot; MapsTo=&amp;quot;result&amp;quot; Value=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"PBI 6690 - TEST Inputs\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"PBI 6690 - TEST Inputs\" Type=\"Workflow\" UniqueID=\"edadb62e-83f4-44bf-a260-7639d6b43169\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.HelpLink&gt;&lt;InArgument x:TypeArguments=\"x:String\"&gt;&lt;Literal x:TypeArguments=\"x:String\" Value=\"\" /&gt;&lt;/InArgument&gt;&lt;/uaba:DsfActivity.HelpLink&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;FlowStep&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;145,390&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,100&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" HelpLink=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" ActionName=\"dbo.spGetCountries\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"Countries\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"CitiesDb\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,100\" IconPath=\"[Nothing]\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;Prefix&amp;quot; Source=&amp;quot;Prefix&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"False\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;CountryID&amp;quot; MapsTo=&amp;quot;CountryID&amp;quot; Value=&amp;quot;[[GetCountries().CountryID]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;Output Name=&amp;quot;Description&amp;quot; MapsTo=&amp;quot;Name&amp;quot; Value=&amp;quot;[[GetCountries().Name]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"Countries\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"Countries\" Type=\"InvokeStoredProc\" UniqueID=\"33476822-9519-4ad5-8fee-1ae3b571115b\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;/Flowchart&gt;&lt;/Activity&gt;</XamlDefinition>";
            resourceModelMock.SetupGet(model => model.WorkflowXaml).Returns(new StringBuilder(WorkFlowXaml));
            resourceModelMock.SetupGet(model => model.Environment.EnvironmentID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ServerID).Returns(Guid.NewGuid);
            var view = new Mock<IView>();
            resourceModelMock.Setup(model => model.GetView(It.IsAny<Func<IView>>())).Returns(view.Object);
            var sorksurfaceContextManager = new WorksurfaceContextManager(false, _shellViewModel);
            var beforeCount = _shellViewModel.Items.Count;
            //---------------Assert Precondition----------------
            Assert.IsNotNull(sorksurfaceContextManager);
            //---------------Execute Test ----------------------
            sorksurfaceContextManager.EditSharePointSource(resourceModelMock.Object, view.Object);
            var afterCount = _shellViewModel.Items.Count;
            //---------------Test Result -----------------------
            Assert.IsTrue(afterCount > beforeCount);
        }

        [TestMethod]
        [Owner("Nkosinathi Sangweni")]
        public void EditWebSource_GivenResourceModel_ShouldPassThrough()
        {
            //---------------Set up test pack-------------------
            CreateFullExportsAndVm();
            var resourceModelMock = new Mock<IContextualResourceModel>();
            const string WorkFlowXaml = "<XamlDefinition>&lt;Activity x:Class=\"PBI 6690 - TEST\" xmlns=\"http://schemas.microsoft.com/netfx/2009/xaml/activities\" xmlns:av=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" xmlns:dc=\"clr-namespace:Dev2.Common;assembly=Dev2.CommonDataUtils\" xmlns:ddc=\"clr-namespace:Dev2.DataList.Contract;assembly=Dev2.Data\" xmlns:ddcb=\"clr-namespace:Dev2.DataList.Contract.Binary_Objects;assembly=Dev2.Data\" xmlns:ddd=\"clr-namespace:Dev2.Data.Decision;assembly=Dev2.Data\" xmlns:dddo=\"clr-namespace:Dev2.Data.Decisions.Operations;assembly=Dev2.Data\" xmlns:ddsm=\"clr-namespace:Dev2.Data.SystemTemplates.Models;assembly=Dev2.Data\" xmlns:mva=\"clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities\" xmlns:s=\"clr-namespace:System;assembly=mscorlib\" xmlns:sap=\"http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation\" xmlns:scg=\"clr-namespace:System.Collections.Generic;assembly=mscorlib\" xmlns:sco=\"clr-namespace:System.Collections.ObjectModel;assembly=mscorlib\" xmlns:uaba=\"clr-namespace:Unlimited.Applications.BusinessDesignStudio.Activities;assembly=Dev2.Activities\" xmlns:uf=\"clr-namespace:Unlimited.Framework;assembly=Dev2.Core\" xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"&gt;&lt;x:Members&gt;&lt;x:Property Name=\"AmbientDataList\" Type=\"InOutArgument(scg:List(x:String))\" /&gt;&lt;x:Property Name=\"ParentWorkflowInstanceId\" Type=\"InOutArgument(s:Guid)\" /&gt;&lt;x:Property Name=\"ParentServiceName\" Type=\"InOutArgument(x:String)\" /&gt;&lt;/x:Members&gt;&lt;sap:VirtualizedContainerService.HintSize&gt;654,676&lt;/sap:VirtualizedContainerService.HintSize&gt;&lt;mva:VisualBasic.Settings&gt;Assembly references and imported namespaces serialized as XML namespaces&lt;/mva:VisualBasic.Settings&gt;&lt;TextExpression.NamespacesForImplementation&gt;&lt;scg:List x:TypeArguments=\"x:String\" Capacity=\"7\"&gt;&lt;x:String&gt;Dev2.CommonDataUtils&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.Decisions.Operations&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.SystemTemplates.Models&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract.Binary_Objects&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Framework&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Applications.BusinessDesignStudio.Activities&lt;/x:String&gt;&lt;/scg:List&gt;&lt;/TextExpression.NamespacesForImplementation&gt;&lt;TextExpression.ReferencesForImplementation&gt;&lt;sco:Collection x:TypeArguments=\"AssemblyReference\"&gt;&lt;AssemblyReference&gt;Dev2.CommonDataUtils&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Data&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Core&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Activities&lt;/AssemblyReference&gt;&lt;/sco:Collection&gt;&lt;/TextExpression.ReferencesForImplementation&gt;&lt;Flowchart DisplayName=\"PBI 6690 - TEST\" sap:VirtualizedContainerService.HintSize=\"614,636\"&gt;&lt;Flowchart.Variables&gt;&lt;Variable x:TypeArguments=\"scg:List(x:String)\" Name=\"InstructionList\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"LastResult\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"HasError\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"ExplicitDataList\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"IsValid\" /&gt;&lt;Variable x:TypeArguments=\"uf:UnlimitedObject\" Name=\"d\" /&gt;&lt;Variable x:TypeArguments=\"uaba:Util\" Name=\"t\" /&gt;&lt;Variable x:TypeArguments=\"ddd:Dev2DataListDecisionHandler\" Name=\"Dev2DecisionHandler\" /&gt;&lt;/Flowchart.Variables&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;False&lt;/x:Boolean&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;270,2.5&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;60,75&lt;/av:Size&gt;&lt;av:PointCollection x:Key=\"ConnectorLocation\"&gt;300,77.5 300,107.5 310,107.5 310,211&lt;/av:PointCollection&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;Flowchart.StartNode&gt;&lt;x:Reference&gt;__ReferenceID0&lt;/x:Reference&gt;&lt;/Flowchart.StartNode&gt;&lt;FlowStep x:Name=\"__ReferenceID0\"&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;185,211&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,84&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActionName=\"{x:Null}\" ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"PBI 6690 - TEST Inputs\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"localhost\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,84\" IconPath=\"pack://application:,,,/Warewolf Studio;component/images/Workflow-32.png\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;n1&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n2&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n3&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"True\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;result&amp;quot; MapsTo=&amp;quot;result&amp;quot; Value=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"PBI 6690 - TEST Inputs\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"PBI 6690 - TEST Inputs\" Type=\"Workflow\" UniqueID=\"edadb62e-83f4-44bf-a260-7639d6b43169\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.HelpLink&gt;&lt;InArgument x:TypeArguments=\"x:String\"&gt;&lt;Literal x:TypeArguments=\"x:String\" Value=\"\" /&gt;&lt;/InArgument&gt;&lt;/uaba:DsfActivity.HelpLink&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;FlowStep&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;145,390&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,100&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" HelpLink=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" ActionName=\"dbo.spGetCountries\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"Countries\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"CitiesDb\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,100\" IconPath=\"[Nothing]\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;Prefix&amp;quot; Source=&amp;quot;Prefix&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"False\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;CountryID&amp;quot; MapsTo=&amp;quot;CountryID&amp;quot; Value=&amp;quot;[[GetCountries().CountryID]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;Output Name=&amp;quot;Description&amp;quot; MapsTo=&amp;quot;Name&amp;quot; Value=&amp;quot;[[GetCountries().Name]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"Countries\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"Countries\" Type=\"InvokeStoredProc\" UniqueID=\"33476822-9519-4ad5-8fee-1ae3b571115b\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;/Flowchart&gt;&lt;/Activity&gt;</XamlDefinition>";
            resourceModelMock.SetupGet(model => model.WorkflowXaml).Returns(new StringBuilder(WorkFlowXaml));
            resourceModelMock.SetupGet(model => model.Environment.EnvironmentID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ServerID).Returns(Guid.NewGuid);
            var view = new Mock<IView>();
            resourceModelMock.Setup(model => model.GetView(It.IsAny<Func<IView>>())).Returns(view.Object);
            var sorksurfaceContextManager = new WorksurfaceContextManager(false, _shellViewModel);
            var beforeCount = _shellViewModel.Items.Count;
            //---------------Assert Precondition----------------
            Assert.IsNotNull(sorksurfaceContextManager);
            //---------------Execute Test ----------------------
            sorksurfaceContextManager.EditWebSource(resourceModelMock.Object, view.Object);
            var afterCount = _shellViewModel.Items.Count;
            //---------------Test Result -----------------------
            Assert.IsTrue(afterCount > beforeCount);
        }

        [TestMethod]
        [Owner("Nkosinathi Sangweni")]
        public void EditComPluginSource_GivenResourceModel_ShouldPassThrough()
        {
            //---------------Set up test pack-------------------
            CreateFullExportsAndVm();
            var resourceModelMock = new Mock<IContextualResourceModel>();
            const string WorkFlowXaml = "<XamlDefinition>&lt;Activity x:Class=\"PBI 6690 - TEST\" xmlns=\"http://schemas.microsoft.com/netfx/2009/xaml/activities\" xmlns:av=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" xmlns:dc=\"clr-namespace:Dev2.Common;assembly=Dev2.CommonDataUtils\" xmlns:ddc=\"clr-namespace:Dev2.DataList.Contract;assembly=Dev2.Data\" xmlns:ddcb=\"clr-namespace:Dev2.DataList.Contract.Binary_Objects;assembly=Dev2.Data\" xmlns:ddd=\"clr-namespace:Dev2.Data.Decision;assembly=Dev2.Data\" xmlns:dddo=\"clr-namespace:Dev2.Data.Decisions.Operations;assembly=Dev2.Data\" xmlns:ddsm=\"clr-namespace:Dev2.Data.SystemTemplates.Models;assembly=Dev2.Data\" xmlns:mva=\"clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities\" xmlns:s=\"clr-namespace:System;assembly=mscorlib\" xmlns:sap=\"http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation\" xmlns:scg=\"clr-namespace:System.Collections.Generic;assembly=mscorlib\" xmlns:sco=\"clr-namespace:System.Collections.ObjectModel;assembly=mscorlib\" xmlns:uaba=\"clr-namespace:Unlimited.Applications.BusinessDesignStudio.Activities;assembly=Dev2.Activities\" xmlns:uf=\"clr-namespace:Unlimited.Framework;assembly=Dev2.Core\" xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"&gt;&lt;x:Members&gt;&lt;x:Property Name=\"AmbientDataList\" Type=\"InOutArgument(scg:List(x:String))\" /&gt;&lt;x:Property Name=\"ParentWorkflowInstanceId\" Type=\"InOutArgument(s:Guid)\" /&gt;&lt;x:Property Name=\"ParentServiceName\" Type=\"InOutArgument(x:String)\" /&gt;&lt;/x:Members&gt;&lt;sap:VirtualizedContainerService.HintSize&gt;654,676&lt;/sap:VirtualizedContainerService.HintSize&gt;&lt;mva:VisualBasic.Settings&gt;Assembly references and imported namespaces serialized as XML namespaces&lt;/mva:VisualBasic.Settings&gt;&lt;TextExpression.NamespacesForImplementation&gt;&lt;scg:List x:TypeArguments=\"x:String\" Capacity=\"7\"&gt;&lt;x:String&gt;Dev2.CommonDataUtils&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.Decisions.Operations&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.SystemTemplates.Models&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract.Binary_Objects&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Framework&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Applications.BusinessDesignStudio.Activities&lt;/x:String&gt;&lt;/scg:List&gt;&lt;/TextExpression.NamespacesForImplementation&gt;&lt;TextExpression.ReferencesForImplementation&gt;&lt;sco:Collection x:TypeArguments=\"AssemblyReference\"&gt;&lt;AssemblyReference&gt;Dev2.CommonDataUtils&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Data&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Core&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Activities&lt;/AssemblyReference&gt;&lt;/sco:Collection&gt;&lt;/TextExpression.ReferencesForImplementation&gt;&lt;Flowchart DisplayName=\"PBI 6690 - TEST\" sap:VirtualizedContainerService.HintSize=\"614,636\"&gt;&lt;Flowchart.Variables&gt;&lt;Variable x:TypeArguments=\"scg:List(x:String)\" Name=\"InstructionList\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"LastResult\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"HasError\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"ExplicitDataList\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"IsValid\" /&gt;&lt;Variable x:TypeArguments=\"uf:UnlimitedObject\" Name=\"d\" /&gt;&lt;Variable x:TypeArguments=\"uaba:Util\" Name=\"t\" /&gt;&lt;Variable x:TypeArguments=\"ddd:Dev2DataListDecisionHandler\" Name=\"Dev2DecisionHandler\" /&gt;&lt;/Flowchart.Variables&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;False&lt;/x:Boolean&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;270,2.5&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;60,75&lt;/av:Size&gt;&lt;av:PointCollection x:Key=\"ConnectorLocation\"&gt;300,77.5 300,107.5 310,107.5 310,211&lt;/av:PointCollection&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;Flowchart.StartNode&gt;&lt;x:Reference&gt;__ReferenceID0&lt;/x:Reference&gt;&lt;/Flowchart.StartNode&gt;&lt;FlowStep x:Name=\"__ReferenceID0\"&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;185,211&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,84&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActionName=\"{x:Null}\" ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"PBI 6690 - TEST Inputs\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"localhost\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,84\" IconPath=\"pack://application:,,,/Warewolf Studio;component/images/Workflow-32.png\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;n1&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n2&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n3&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"True\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;result&amp;quot; MapsTo=&amp;quot;result&amp;quot; Value=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"PBI 6690 - TEST Inputs\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"PBI 6690 - TEST Inputs\" Type=\"Workflow\" UniqueID=\"edadb62e-83f4-44bf-a260-7639d6b43169\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.HelpLink&gt;&lt;InArgument x:TypeArguments=\"x:String\"&gt;&lt;Literal x:TypeArguments=\"x:String\" Value=\"\" /&gt;&lt;/InArgument&gt;&lt;/uaba:DsfActivity.HelpLink&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;FlowStep&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;145,390&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,100&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" HelpLink=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" ActionName=\"dbo.spGetCountries\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"Countries\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"CitiesDb\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,100\" IconPath=\"[Nothing]\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;Prefix&amp;quot; Source=&amp;quot;Prefix&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"False\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;CountryID&amp;quot; MapsTo=&amp;quot;CountryID&amp;quot; Value=&amp;quot;[[GetCountries().CountryID]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;Output Name=&amp;quot;Description&amp;quot; MapsTo=&amp;quot;Name&amp;quot; Value=&amp;quot;[[GetCountries().Name]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"Countries\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"Countries\" Type=\"InvokeStoredProc\" UniqueID=\"33476822-9519-4ad5-8fee-1ae3b571115b\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;/Flowchart&gt;&lt;/Activity&gt;</XamlDefinition>";
            resourceModelMock.SetupGet(model => model.WorkflowXaml).Returns(new StringBuilder(WorkFlowXaml));
            resourceModelMock.SetupGet(model => model.Environment.EnvironmentID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ServerID).Returns(Guid.NewGuid);
            var view = new Mock<IView>();
            resourceModelMock.Setup(model => model.GetView(It.IsAny<Func<IView>>())).Returns(view.Object);
            var sorksurfaceContextManager = new WorksurfaceContextManager(false, _shellViewModel);
            var beforeCount = _shellViewModel.Items.Count;
            //---------------Assert Precondition----------------
            Assert.IsNotNull(sorksurfaceContextManager);
            //---------------Execute Test ----------------------
            sorksurfaceContextManager.EditComPluginSource(resourceModelMock.Object, view.Object);
            var afterCount = _shellViewModel.Items.Count;
            //---------------Test Result -----------------------
            Assert.IsTrue(afterCount > beforeCount);
        }


        [TestMethod]
        [Owner("Nkosinathi Sangweni")]
        public void EditOdbcSource_GivenResourceModel_ShouldPassThrough()
        {
            //---------------Set up test pack-------------------
            CreateFullExportsAndVm();
            var resourceModelMock = new Mock<IContextualResourceModel>();
            const string WorkFlowXaml = "<XamlDefinition>&lt;Activity x:Class=\"PBI 6690 - TEST\" xmlns=\"http://schemas.microsoft.com/netfx/2009/xaml/activities\" xmlns:av=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" xmlns:dc=\"clr-namespace:Dev2.Common;assembly=Dev2.CommonDataUtils\" xmlns:ddc=\"clr-namespace:Dev2.DataList.Contract;assembly=Dev2.Data\" xmlns:ddcb=\"clr-namespace:Dev2.DataList.Contract.Binary_Objects;assembly=Dev2.Data\" xmlns:ddd=\"clr-namespace:Dev2.Data.Decision;assembly=Dev2.Data\" xmlns:dddo=\"clr-namespace:Dev2.Data.Decisions.Operations;assembly=Dev2.Data\" xmlns:ddsm=\"clr-namespace:Dev2.Data.SystemTemplates.Models;assembly=Dev2.Data\" xmlns:mva=\"clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities\" xmlns:s=\"clr-namespace:System;assembly=mscorlib\" xmlns:sap=\"http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation\" xmlns:scg=\"clr-namespace:System.Collections.Generic;assembly=mscorlib\" xmlns:sco=\"clr-namespace:System.Collections.ObjectModel;assembly=mscorlib\" xmlns:uaba=\"clr-namespace:Unlimited.Applications.BusinessDesignStudio.Activities;assembly=Dev2.Activities\" xmlns:uf=\"clr-namespace:Unlimited.Framework;assembly=Dev2.Core\" xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"&gt;&lt;x:Members&gt;&lt;x:Property Name=\"AmbientDataList\" Type=\"InOutArgument(scg:List(x:String))\" /&gt;&lt;x:Property Name=\"ParentWorkflowInstanceId\" Type=\"InOutArgument(s:Guid)\" /&gt;&lt;x:Property Name=\"ParentServiceName\" Type=\"InOutArgument(x:String)\" /&gt;&lt;/x:Members&gt;&lt;sap:VirtualizedContainerService.HintSize&gt;654,676&lt;/sap:VirtualizedContainerService.HintSize&gt;&lt;mva:VisualBasic.Settings&gt;Assembly references and imported namespaces serialized as XML namespaces&lt;/mva:VisualBasic.Settings&gt;&lt;TextExpression.NamespacesForImplementation&gt;&lt;scg:List x:TypeArguments=\"x:String\" Capacity=\"7\"&gt;&lt;x:String&gt;Dev2.CommonDataUtils&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.Decisions.Operations&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.SystemTemplates.Models&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract.Binary_Objects&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Framework&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Applications.BusinessDesignStudio.Activities&lt;/x:String&gt;&lt;/scg:List&gt;&lt;/TextExpression.NamespacesForImplementation&gt;&lt;TextExpression.ReferencesForImplementation&gt;&lt;sco:Collection x:TypeArguments=\"AssemblyReference\"&gt;&lt;AssemblyReference&gt;Dev2.CommonDataUtils&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Data&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Core&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Activities&lt;/AssemblyReference&gt;&lt;/sco:Collection&gt;&lt;/TextExpression.ReferencesForImplementation&gt;&lt;Flowchart DisplayName=\"PBI 6690 - TEST\" sap:VirtualizedContainerService.HintSize=\"614,636\"&gt;&lt;Flowchart.Variables&gt;&lt;Variable x:TypeArguments=\"scg:List(x:String)\" Name=\"InstructionList\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"LastResult\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"HasError\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"ExplicitDataList\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"IsValid\" /&gt;&lt;Variable x:TypeArguments=\"uf:UnlimitedObject\" Name=\"d\" /&gt;&lt;Variable x:TypeArguments=\"uaba:Util\" Name=\"t\" /&gt;&lt;Variable x:TypeArguments=\"ddd:Dev2DataListDecisionHandler\" Name=\"Dev2DecisionHandler\" /&gt;&lt;/Flowchart.Variables&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;False&lt;/x:Boolean&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;270,2.5&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;60,75&lt;/av:Size&gt;&lt;av:PointCollection x:Key=\"ConnectorLocation\"&gt;300,77.5 300,107.5 310,107.5 310,211&lt;/av:PointCollection&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;Flowchart.StartNode&gt;&lt;x:Reference&gt;__ReferenceID0&lt;/x:Reference&gt;&lt;/Flowchart.StartNode&gt;&lt;FlowStep x:Name=\"__ReferenceID0\"&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;185,211&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,84&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActionName=\"{x:Null}\" ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"PBI 6690 - TEST Inputs\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"localhost\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,84\" IconPath=\"pack://application:,,,/Warewolf Studio;component/images/Workflow-32.png\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;n1&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n2&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n3&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"True\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;result&amp;quot; MapsTo=&amp;quot;result&amp;quot; Value=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"PBI 6690 - TEST Inputs\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"PBI 6690 - TEST Inputs\" Type=\"Workflow\" UniqueID=\"edadb62e-83f4-44bf-a260-7639d6b43169\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.HelpLink&gt;&lt;InArgument x:TypeArguments=\"x:String\"&gt;&lt;Literal x:TypeArguments=\"x:String\" Value=\"\" /&gt;&lt;/InArgument&gt;&lt;/uaba:DsfActivity.HelpLink&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;FlowStep&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;145,390&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,100&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" HelpLink=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" ActionName=\"dbo.spGetCountries\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"Countries\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"CitiesDb\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,100\" IconPath=\"[Nothing]\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;Prefix&amp;quot; Source=&amp;quot;Prefix&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"False\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;CountryID&amp;quot; MapsTo=&amp;quot;CountryID&amp;quot; Value=&amp;quot;[[GetCountries().CountryID]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;Output Name=&amp;quot;Description&amp;quot; MapsTo=&amp;quot;Name&amp;quot; Value=&amp;quot;[[GetCountries().Name]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"Countries\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"Countries\" Type=\"InvokeStoredProc\" UniqueID=\"33476822-9519-4ad5-8fee-1ae3b571115b\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;/Flowchart&gt;&lt;/Activity&gt;</XamlDefinition>";
            resourceModelMock.SetupGet(model => model.WorkflowXaml).Returns(new StringBuilder(WorkFlowXaml));
            resourceModelMock.SetupGet(model => model.Environment.EnvironmentID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ServerID).Returns(Guid.NewGuid);
            var view = new Mock<IView>();
            resourceModelMock.Setup(model => model.GetView(It.IsAny<Func<IView>>())).Returns(view.Object);
            var sorksurfaceContextManager = new WorksurfaceContextManager(false, _shellViewModel);
            var beforeCount = _shellViewModel.Items.Count;
            _activeEnvironment.Setup(model => model.Name).Returns("Localhost");
            //---------------Assert Precondition----------------
            Assert.IsNotNull(sorksurfaceContextManager);
            //---------------Execute Test ----------------------
            sorksurfaceContextManager.EditOdbcSource(resourceModelMock.Object, view.Object);
            var afterCount = _shellViewModel.Items.Count;
            //---------------Test Result -----------------------
            Assert.IsTrue(afterCount > beforeCount);
        }

        [TestMethod]
        [Owner("Nkosinathi Sangweni")]
        public void EditOracleSource_GivenResourceModel_ShouldPassThrough()
        {
            //---------------Set up test pack-------------------
            CreateFullExportsAndVm();
            var resourceModelMock = new Mock<IContextualResourceModel>();
            const string WorkFlowXaml = "<XamlDefinition>&lt;Activity x:Class=\"PBI 6690 - TEST\" xmlns=\"http://schemas.microsoft.com/netfx/2009/xaml/activities\" xmlns:av=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" xmlns:dc=\"clr-namespace:Dev2.Common;assembly=Dev2.CommonDataUtils\" xmlns:ddc=\"clr-namespace:Dev2.DataList.Contract;assembly=Dev2.Data\" xmlns:ddcb=\"clr-namespace:Dev2.DataList.Contract.Binary_Objects;assembly=Dev2.Data\" xmlns:ddd=\"clr-namespace:Dev2.Data.Decision;assembly=Dev2.Data\" xmlns:dddo=\"clr-namespace:Dev2.Data.Decisions.Operations;assembly=Dev2.Data\" xmlns:ddsm=\"clr-namespace:Dev2.Data.SystemTemplates.Models;assembly=Dev2.Data\" xmlns:mva=\"clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities\" xmlns:s=\"clr-namespace:System;assembly=mscorlib\" xmlns:sap=\"http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation\" xmlns:scg=\"clr-namespace:System.Collections.Generic;assembly=mscorlib\" xmlns:sco=\"clr-namespace:System.Collections.ObjectModel;assembly=mscorlib\" xmlns:uaba=\"clr-namespace:Unlimited.Applications.BusinessDesignStudio.Activities;assembly=Dev2.Activities\" xmlns:uf=\"clr-namespace:Unlimited.Framework;assembly=Dev2.Core\" xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"&gt;&lt;x:Members&gt;&lt;x:Property Name=\"AmbientDataList\" Type=\"InOutArgument(scg:List(x:String))\" /&gt;&lt;x:Property Name=\"ParentWorkflowInstanceId\" Type=\"InOutArgument(s:Guid)\" /&gt;&lt;x:Property Name=\"ParentServiceName\" Type=\"InOutArgument(x:String)\" /&gt;&lt;/x:Members&gt;&lt;sap:VirtualizedContainerService.HintSize&gt;654,676&lt;/sap:VirtualizedContainerService.HintSize&gt;&lt;mva:VisualBasic.Settings&gt;Assembly references and imported namespaces serialized as XML namespaces&lt;/mva:VisualBasic.Settings&gt;&lt;TextExpression.NamespacesForImplementation&gt;&lt;scg:List x:TypeArguments=\"x:String\" Capacity=\"7\"&gt;&lt;x:String&gt;Dev2.CommonDataUtils&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.Decisions.Operations&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.SystemTemplates.Models&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract.Binary_Objects&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Framework&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Applications.BusinessDesignStudio.Activities&lt;/x:String&gt;&lt;/scg:List&gt;&lt;/TextExpression.NamespacesForImplementation&gt;&lt;TextExpression.ReferencesForImplementation&gt;&lt;sco:Collection x:TypeArguments=\"AssemblyReference\"&gt;&lt;AssemblyReference&gt;Dev2.CommonDataUtils&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Data&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Core&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Activities&lt;/AssemblyReference&gt;&lt;/sco:Collection&gt;&lt;/TextExpression.ReferencesForImplementation&gt;&lt;Flowchart DisplayName=\"PBI 6690 - TEST\" sap:VirtualizedContainerService.HintSize=\"614,636\"&gt;&lt;Flowchart.Variables&gt;&lt;Variable x:TypeArguments=\"scg:List(x:String)\" Name=\"InstructionList\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"LastResult\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"HasError\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"ExplicitDataList\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"IsValid\" /&gt;&lt;Variable x:TypeArguments=\"uf:UnlimitedObject\" Name=\"d\" /&gt;&lt;Variable x:TypeArguments=\"uaba:Util\" Name=\"t\" /&gt;&lt;Variable x:TypeArguments=\"ddd:Dev2DataListDecisionHandler\" Name=\"Dev2DecisionHandler\" /&gt;&lt;/Flowchart.Variables&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;False&lt;/x:Boolean&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;270,2.5&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;60,75&lt;/av:Size&gt;&lt;av:PointCollection x:Key=\"ConnectorLocation\"&gt;300,77.5 300,107.5 310,107.5 310,211&lt;/av:PointCollection&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;Flowchart.StartNode&gt;&lt;x:Reference&gt;__ReferenceID0&lt;/x:Reference&gt;&lt;/Flowchart.StartNode&gt;&lt;FlowStep x:Name=\"__ReferenceID0\"&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;185,211&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,84&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActionName=\"{x:Null}\" ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"PBI 6690 - TEST Inputs\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"localhost\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,84\" IconPath=\"pack://application:,,,/Warewolf Studio;component/images/Workflow-32.png\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;n1&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n2&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n3&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"True\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;result&amp;quot; MapsTo=&amp;quot;result&amp;quot; Value=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"PBI 6690 - TEST Inputs\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"PBI 6690 - TEST Inputs\" Type=\"Workflow\" UniqueID=\"edadb62e-83f4-44bf-a260-7639d6b43169\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.HelpLink&gt;&lt;InArgument x:TypeArguments=\"x:String\"&gt;&lt;Literal x:TypeArguments=\"x:String\" Value=\"\" /&gt;&lt;/InArgument&gt;&lt;/uaba:DsfActivity.HelpLink&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;FlowStep&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;145,390&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,100&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" HelpLink=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" ActionName=\"dbo.spGetCountries\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"Countries\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"CitiesDb\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,100\" IconPath=\"[Nothing]\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;Prefix&amp;quot; Source=&amp;quot;Prefix&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"False\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;CountryID&amp;quot; MapsTo=&amp;quot;CountryID&amp;quot; Value=&amp;quot;[[GetCountries().CountryID]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;Output Name=&amp;quot;Description&amp;quot; MapsTo=&amp;quot;Name&amp;quot; Value=&amp;quot;[[GetCountries().Name]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"Countries\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"Countries\" Type=\"InvokeStoredProc\" UniqueID=\"33476822-9519-4ad5-8fee-1ae3b571115b\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;/Flowchart&gt;&lt;/Activity&gt;</XamlDefinition>";
            resourceModelMock.SetupGet(model => model.WorkflowXaml).Returns(new StringBuilder(WorkFlowXaml));
            resourceModelMock.SetupGet(model => model.Environment.EnvironmentID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ServerID).Returns(Guid.NewGuid);
            var view = new Mock<IView>();
            resourceModelMock.Setup(model => model.GetView(It.IsAny<Func<IView>>())).Returns(view.Object);
            var sorksurfaceContextManager = new WorksurfaceContextManager(false, _shellViewModel);
            var beforeCount = _shellViewModel.Items.Count;
            //---------------Assert Precondition----------------
            Assert.IsNotNull(sorksurfaceContextManager);
            //---------------Execute Test ----------------------
            sorksurfaceContextManager.EditOracleSource(resourceModelMock.Object, view.Object);
            var afterCount = _shellViewModel.Items.Count;
            //---------------Test Result -----------------------
            Assert.IsTrue(afterCount > beforeCount);
        }

        [TestMethod]
        [Owner("Nkosinathi Sangweni")]
        public void EditPostgreSqlSource_GivenResourceModel_ShouldPassThrough()
        {
            //---------------Set up test pack-------------------
            CreateFullExportsAndVm();
            var resourceModelMock = new Mock<IContextualResourceModel>();
            const string WorkFlowXaml = "<XamlDefinition>&lt;Activity x:Class=\"PBI 6690 - TEST\" xmlns=\"http://schemas.microsoft.com/netfx/2009/xaml/activities\" xmlns:av=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" xmlns:dc=\"clr-namespace:Dev2.Common;assembly=Dev2.CommonDataUtils\" xmlns:ddc=\"clr-namespace:Dev2.DataList.Contract;assembly=Dev2.Data\" xmlns:ddcb=\"clr-namespace:Dev2.DataList.Contract.Binary_Objects;assembly=Dev2.Data\" xmlns:ddd=\"clr-namespace:Dev2.Data.Decision;assembly=Dev2.Data\" xmlns:dddo=\"clr-namespace:Dev2.Data.Decisions.Operations;assembly=Dev2.Data\" xmlns:ddsm=\"clr-namespace:Dev2.Data.SystemTemplates.Models;assembly=Dev2.Data\" xmlns:mva=\"clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities\" xmlns:s=\"clr-namespace:System;assembly=mscorlib\" xmlns:sap=\"http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation\" xmlns:scg=\"clr-namespace:System.Collections.Generic;assembly=mscorlib\" xmlns:sco=\"clr-namespace:System.Collections.ObjectModel;assembly=mscorlib\" xmlns:uaba=\"clr-namespace:Unlimited.Applications.BusinessDesignStudio.Activities;assembly=Dev2.Activities\" xmlns:uf=\"clr-namespace:Unlimited.Framework;assembly=Dev2.Core\" xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"&gt;&lt;x:Members&gt;&lt;x:Property Name=\"AmbientDataList\" Type=\"InOutArgument(scg:List(x:String))\" /&gt;&lt;x:Property Name=\"ParentWorkflowInstanceId\" Type=\"InOutArgument(s:Guid)\" /&gt;&lt;x:Property Name=\"ParentServiceName\" Type=\"InOutArgument(x:String)\" /&gt;&lt;/x:Members&gt;&lt;sap:VirtualizedContainerService.HintSize&gt;654,676&lt;/sap:VirtualizedContainerService.HintSize&gt;&lt;mva:VisualBasic.Settings&gt;Assembly references and imported namespaces serialized as XML namespaces&lt;/mva:VisualBasic.Settings&gt;&lt;TextExpression.NamespacesForImplementation&gt;&lt;scg:List x:TypeArguments=\"x:String\" Capacity=\"7\"&gt;&lt;x:String&gt;Dev2.CommonDataUtils&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.Decisions.Operations&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.SystemTemplates.Models&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract.Binary_Objects&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Framework&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Applications.BusinessDesignStudio.Activities&lt;/x:String&gt;&lt;/scg:List&gt;&lt;/TextExpression.NamespacesForImplementation&gt;&lt;TextExpression.ReferencesForImplementation&gt;&lt;sco:Collection x:TypeArguments=\"AssemblyReference\"&gt;&lt;AssemblyReference&gt;Dev2.CommonDataUtils&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Data&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Core&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Activities&lt;/AssemblyReference&gt;&lt;/sco:Collection&gt;&lt;/TextExpression.ReferencesForImplementation&gt;&lt;Flowchart DisplayName=\"PBI 6690 - TEST\" sap:VirtualizedContainerService.HintSize=\"614,636\"&gt;&lt;Flowchart.Variables&gt;&lt;Variable x:TypeArguments=\"scg:List(x:String)\" Name=\"InstructionList\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"LastResult\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"HasError\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"ExplicitDataList\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"IsValid\" /&gt;&lt;Variable x:TypeArguments=\"uf:UnlimitedObject\" Name=\"d\" /&gt;&lt;Variable x:TypeArguments=\"uaba:Util\" Name=\"t\" /&gt;&lt;Variable x:TypeArguments=\"ddd:Dev2DataListDecisionHandler\" Name=\"Dev2DecisionHandler\" /&gt;&lt;/Flowchart.Variables&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;False&lt;/x:Boolean&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;270,2.5&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;60,75&lt;/av:Size&gt;&lt;av:PointCollection x:Key=\"ConnectorLocation\"&gt;300,77.5 300,107.5 310,107.5 310,211&lt;/av:PointCollection&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;Flowchart.StartNode&gt;&lt;x:Reference&gt;__ReferenceID0&lt;/x:Reference&gt;&lt;/Flowchart.StartNode&gt;&lt;FlowStep x:Name=\"__ReferenceID0\"&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;185,211&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,84&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActionName=\"{x:Null}\" ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"PBI 6690 - TEST Inputs\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"localhost\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,84\" IconPath=\"pack://application:,,,/Warewolf Studio;component/images/Workflow-32.png\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;n1&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n2&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n3&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"True\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;result&amp;quot; MapsTo=&amp;quot;result&amp;quot; Value=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"PBI 6690 - TEST Inputs\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"PBI 6690 - TEST Inputs\" Type=\"Workflow\" UniqueID=\"edadb62e-83f4-44bf-a260-7639d6b43169\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.HelpLink&gt;&lt;InArgument x:TypeArguments=\"x:String\"&gt;&lt;Literal x:TypeArguments=\"x:String\" Value=\"\" /&gt;&lt;/InArgument&gt;&lt;/uaba:DsfActivity.HelpLink&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;FlowStep&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;145,390&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,100&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" HelpLink=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" ActionName=\"dbo.spGetCountries\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"Countries\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"CitiesDb\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,100\" IconPath=\"[Nothing]\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;Prefix&amp;quot; Source=&amp;quot;Prefix&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"False\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;CountryID&amp;quot; MapsTo=&amp;quot;CountryID&amp;quot; Value=&amp;quot;[[GetCountries().CountryID]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;Output Name=&amp;quot;Description&amp;quot; MapsTo=&amp;quot;Name&amp;quot; Value=&amp;quot;[[GetCountries().Name]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"Countries\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"Countries\" Type=\"InvokeStoredProc\" UniqueID=\"33476822-9519-4ad5-8fee-1ae3b571115b\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;/Flowchart&gt;&lt;/Activity&gt;</XamlDefinition>";
            resourceModelMock.SetupGet(model => model.WorkflowXaml).Returns(new StringBuilder(WorkFlowXaml));
            resourceModelMock.SetupGet(model => model.Environment.EnvironmentID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ServerID).Returns(Guid.NewGuid);
            var view = new Mock<IView>();
            resourceModelMock.Setup(model => model.GetView(It.IsAny<Func<IView>>())).Returns(view.Object);
            var sorksurfaceContextManager = new WorksurfaceContextManager(false, _shellViewModel);
            var beforeCount = _shellViewModel.Items.Count;
            //---------------Assert Precondition----------------
            Assert.IsNotNull(sorksurfaceContextManager);
            //---------------Execute Test ----------------------
            sorksurfaceContextManager.EditPostgreSqlSource(resourceModelMock.Object, view.Object);
            var afterCount = _shellViewModel.Items.Count;
            //---------------Test Result -----------------------
            Assert.IsTrue(afterCount > beforeCount);
        }
        
        [TestMethod]
        [Owner("Nkosinathi Sangweni")]
        public void EditMySqlSource_GivenResourceModel_ShouldPassThrough()
        {
            //---------------Set up test pack-------------------
            CreateFullExportsAndVm();
            var resourceModelMock = new Mock<IContextualResourceModel>();
            const string WorkFlowXaml = "<XamlDefinition>&lt;Activity x:Class=\"PBI 6690 - TEST\" xmlns=\"http://schemas.microsoft.com/netfx/2009/xaml/activities\" xmlns:av=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" xmlns:dc=\"clr-namespace:Dev2.Common;assembly=Dev2.CommonDataUtils\" xmlns:ddc=\"clr-namespace:Dev2.DataList.Contract;assembly=Dev2.Data\" xmlns:ddcb=\"clr-namespace:Dev2.DataList.Contract.Binary_Objects;assembly=Dev2.Data\" xmlns:ddd=\"clr-namespace:Dev2.Data.Decision;assembly=Dev2.Data\" xmlns:dddo=\"clr-namespace:Dev2.Data.Decisions.Operations;assembly=Dev2.Data\" xmlns:ddsm=\"clr-namespace:Dev2.Data.SystemTemplates.Models;assembly=Dev2.Data\" xmlns:mva=\"clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities\" xmlns:s=\"clr-namespace:System;assembly=mscorlib\" xmlns:sap=\"http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation\" xmlns:scg=\"clr-namespace:System.Collections.Generic;assembly=mscorlib\" xmlns:sco=\"clr-namespace:System.Collections.ObjectModel;assembly=mscorlib\" xmlns:uaba=\"clr-namespace:Unlimited.Applications.BusinessDesignStudio.Activities;assembly=Dev2.Activities\" xmlns:uf=\"clr-namespace:Unlimited.Framework;assembly=Dev2.Core\" xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"&gt;&lt;x:Members&gt;&lt;x:Property Name=\"AmbientDataList\" Type=\"InOutArgument(scg:List(x:String))\" /&gt;&lt;x:Property Name=\"ParentWorkflowInstanceId\" Type=\"InOutArgument(s:Guid)\" /&gt;&lt;x:Property Name=\"ParentServiceName\" Type=\"InOutArgument(x:String)\" /&gt;&lt;/x:Members&gt;&lt;sap:VirtualizedContainerService.HintSize&gt;654,676&lt;/sap:VirtualizedContainerService.HintSize&gt;&lt;mva:VisualBasic.Settings&gt;Assembly references and imported namespaces serialized as XML namespaces&lt;/mva:VisualBasic.Settings&gt;&lt;TextExpression.NamespacesForImplementation&gt;&lt;scg:List x:TypeArguments=\"x:String\" Capacity=\"7\"&gt;&lt;x:String&gt;Dev2.CommonDataUtils&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.Decisions.Operations&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.SystemTemplates.Models&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract.Binary_Objects&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Framework&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Applications.BusinessDesignStudio.Activities&lt;/x:String&gt;&lt;/scg:List&gt;&lt;/TextExpression.NamespacesForImplementation&gt;&lt;TextExpression.ReferencesForImplementation&gt;&lt;sco:Collection x:TypeArguments=\"AssemblyReference\"&gt;&lt;AssemblyReference&gt;Dev2.CommonDataUtils&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Data&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Core&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Activities&lt;/AssemblyReference&gt;&lt;/sco:Collection&gt;&lt;/TextExpression.ReferencesForImplementation&gt;&lt;Flowchart DisplayName=\"PBI 6690 - TEST\" sap:VirtualizedContainerService.HintSize=\"614,636\"&gt;&lt;Flowchart.Variables&gt;&lt;Variable x:TypeArguments=\"scg:List(x:String)\" Name=\"InstructionList\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"LastResult\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"HasError\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"ExplicitDataList\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"IsValid\" /&gt;&lt;Variable x:TypeArguments=\"uf:UnlimitedObject\" Name=\"d\" /&gt;&lt;Variable x:TypeArguments=\"uaba:Util\" Name=\"t\" /&gt;&lt;Variable x:TypeArguments=\"ddd:Dev2DataListDecisionHandler\" Name=\"Dev2DecisionHandler\" /&gt;&lt;/Flowchart.Variables&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;False&lt;/x:Boolean&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;270,2.5&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;60,75&lt;/av:Size&gt;&lt;av:PointCollection x:Key=\"ConnectorLocation\"&gt;300,77.5 300,107.5 310,107.5 310,211&lt;/av:PointCollection&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;Flowchart.StartNode&gt;&lt;x:Reference&gt;__ReferenceID0&lt;/x:Reference&gt;&lt;/Flowchart.StartNode&gt;&lt;FlowStep x:Name=\"__ReferenceID0\"&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;185,211&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,84&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActionName=\"{x:Null}\" ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"PBI 6690 - TEST Inputs\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"localhost\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,84\" IconPath=\"pack://application:,,,/Warewolf Studio;component/images/Workflow-32.png\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;n1&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n2&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n3&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"True\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;result&amp;quot; MapsTo=&amp;quot;result&amp;quot; Value=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"PBI 6690 - TEST Inputs\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"PBI 6690 - TEST Inputs\" Type=\"Workflow\" UniqueID=\"edadb62e-83f4-44bf-a260-7639d6b43169\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.HelpLink&gt;&lt;InArgument x:TypeArguments=\"x:String\"&gt;&lt;Literal x:TypeArguments=\"x:String\" Value=\"\" /&gt;&lt;/InArgument&gt;&lt;/uaba:DsfActivity.HelpLink&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;FlowStep&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;145,390&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,100&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" HelpLink=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" ActionName=\"dbo.spGetCountries\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"Countries\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"CitiesDb\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,100\" IconPath=\"[Nothing]\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;Prefix&amp;quot; Source=&amp;quot;Prefix&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"False\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;CountryID&amp;quot; MapsTo=&amp;quot;CountryID&amp;quot; Value=&amp;quot;[[GetCountries().CountryID]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;Output Name=&amp;quot;Description&amp;quot; MapsTo=&amp;quot;Name&amp;quot; Value=&amp;quot;[[GetCountries().Name]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"Countries\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"Countries\" Type=\"InvokeStoredProc\" UniqueID=\"33476822-9519-4ad5-8fee-1ae3b571115b\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;/Flowchart&gt;&lt;/Activity&gt;</XamlDefinition>";
            resourceModelMock.SetupGet(model => model.WorkflowXaml).Returns(new StringBuilder(WorkFlowXaml));
            resourceModelMock.SetupGet(model => model.Environment.EnvironmentID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ServerID).Returns(Guid.NewGuid);
            var view = new Mock<IView>();
            resourceModelMock.Setup(model => model.GetView(It.IsAny<Func<IView>>())).Returns(view.Object);
            var sorksurfaceContextManager = new WorksurfaceContextManager(false, _shellViewModel);
            var beforeCount = _shellViewModel.Items.Count;
            //---------------Assert Precondition----------------
            Assert.IsNotNull(sorksurfaceContextManager);
            //---------------Execute Test ----------------------
            sorksurfaceContextManager.EditMySqlSource(resourceModelMock.Object, view.Object);
            var afterCount = _shellViewModel.Items.Count;
            //---------------Test Result -----------------------
            Assert.IsTrue(afterCount > beforeCount);
        }

        [TestMethod]
        [Owner("Nkosinathi Sangweni")]
        public void EditSqlServerSource_GivenResourceModel_ShouldPassThrough()
        {
            //---------------Set up test pack-------------------
            CreateFullExportsAndVm();
            var resourceModelMock = new Mock<IContextualResourceModel>();
            const string WorkFlowXaml = "<XamlDefinition>&lt;Activity x:Class=\"PBI 6690 - TEST\" xmlns=\"http://schemas.microsoft.com/netfx/2009/xaml/activities\" xmlns:av=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" xmlns:dc=\"clr-namespace:Dev2.Common;assembly=Dev2.CommonDataUtils\" xmlns:ddc=\"clr-namespace:Dev2.DataList.Contract;assembly=Dev2.Data\" xmlns:ddcb=\"clr-namespace:Dev2.DataList.Contract.Binary_Objects;assembly=Dev2.Data\" xmlns:ddd=\"clr-namespace:Dev2.Data.Decision;assembly=Dev2.Data\" xmlns:dddo=\"clr-namespace:Dev2.Data.Decisions.Operations;assembly=Dev2.Data\" xmlns:ddsm=\"clr-namespace:Dev2.Data.SystemTemplates.Models;assembly=Dev2.Data\" xmlns:mva=\"clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities\" xmlns:s=\"clr-namespace:System;assembly=mscorlib\" xmlns:sap=\"http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation\" xmlns:scg=\"clr-namespace:System.Collections.Generic;assembly=mscorlib\" xmlns:sco=\"clr-namespace:System.Collections.ObjectModel;assembly=mscorlib\" xmlns:uaba=\"clr-namespace:Unlimited.Applications.BusinessDesignStudio.Activities;assembly=Dev2.Activities\" xmlns:uf=\"clr-namespace:Unlimited.Framework;assembly=Dev2.Core\" xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"&gt;&lt;x:Members&gt;&lt;x:Property Name=\"AmbientDataList\" Type=\"InOutArgument(scg:List(x:String))\" /&gt;&lt;x:Property Name=\"ParentWorkflowInstanceId\" Type=\"InOutArgument(s:Guid)\" /&gt;&lt;x:Property Name=\"ParentServiceName\" Type=\"InOutArgument(x:String)\" /&gt;&lt;/x:Members&gt;&lt;sap:VirtualizedContainerService.HintSize&gt;654,676&lt;/sap:VirtualizedContainerService.HintSize&gt;&lt;mva:VisualBasic.Settings&gt;Assembly references and imported namespaces serialized as XML namespaces&lt;/mva:VisualBasic.Settings&gt;&lt;TextExpression.NamespacesForImplementation&gt;&lt;scg:List x:TypeArguments=\"x:String\" Capacity=\"7\"&gt;&lt;x:String&gt;Dev2.CommonDataUtils&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.Decisions.Operations&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.SystemTemplates.Models&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract.Binary_Objects&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Framework&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Applications.BusinessDesignStudio.Activities&lt;/x:String&gt;&lt;/scg:List&gt;&lt;/TextExpression.NamespacesForImplementation&gt;&lt;TextExpression.ReferencesForImplementation&gt;&lt;sco:Collection x:TypeArguments=\"AssemblyReference\"&gt;&lt;AssemblyReference&gt;Dev2.CommonDataUtils&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Data&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Core&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Activities&lt;/AssemblyReference&gt;&lt;/sco:Collection&gt;&lt;/TextExpression.ReferencesForImplementation&gt;&lt;Flowchart DisplayName=\"PBI 6690 - TEST\" sap:VirtualizedContainerService.HintSize=\"614,636\"&gt;&lt;Flowchart.Variables&gt;&lt;Variable x:TypeArguments=\"scg:List(x:String)\" Name=\"InstructionList\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"LastResult\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"HasError\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"ExplicitDataList\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"IsValid\" /&gt;&lt;Variable x:TypeArguments=\"uf:UnlimitedObject\" Name=\"d\" /&gt;&lt;Variable x:TypeArguments=\"uaba:Util\" Name=\"t\" /&gt;&lt;Variable x:TypeArguments=\"ddd:Dev2DataListDecisionHandler\" Name=\"Dev2DecisionHandler\" /&gt;&lt;/Flowchart.Variables&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;False&lt;/x:Boolean&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;270,2.5&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;60,75&lt;/av:Size&gt;&lt;av:PointCollection x:Key=\"ConnectorLocation\"&gt;300,77.5 300,107.5 310,107.5 310,211&lt;/av:PointCollection&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;Flowchart.StartNode&gt;&lt;x:Reference&gt;__ReferenceID0&lt;/x:Reference&gt;&lt;/Flowchart.StartNode&gt;&lt;FlowStep x:Name=\"__ReferenceID0\"&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;185,211&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,84&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActionName=\"{x:Null}\" ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"PBI 6690 - TEST Inputs\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"localhost\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,84\" IconPath=\"pack://application:,,,/Warewolf Studio;component/images/Workflow-32.png\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;n1&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n2&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n3&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"True\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;result&amp;quot; MapsTo=&amp;quot;result&amp;quot; Value=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"PBI 6690 - TEST Inputs\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"PBI 6690 - TEST Inputs\" Type=\"Workflow\" UniqueID=\"edadb62e-83f4-44bf-a260-7639d6b43169\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.HelpLink&gt;&lt;InArgument x:TypeArguments=\"x:String\"&gt;&lt;Literal x:TypeArguments=\"x:String\" Value=\"\" /&gt;&lt;/InArgument&gt;&lt;/uaba:DsfActivity.HelpLink&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;FlowStep&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;145,390&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,100&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" HelpLink=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" ActionName=\"dbo.spGetCountries\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"Countries\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"CitiesDb\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,100\" IconPath=\"[Nothing]\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;Prefix&amp;quot; Source=&amp;quot;Prefix&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"False\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;CountryID&amp;quot; MapsTo=&amp;quot;CountryID&amp;quot; Value=&amp;quot;[[GetCountries().CountryID]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;Output Name=&amp;quot;Description&amp;quot; MapsTo=&amp;quot;Name&amp;quot; Value=&amp;quot;[[GetCountries().Name]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"Countries\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"Countries\" Type=\"InvokeStoredProc\" UniqueID=\"33476822-9519-4ad5-8fee-1ae3b571115b\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;/Flowchart&gt;&lt;/Activity&gt;</XamlDefinition>";
            resourceModelMock.SetupGet(model => model.WorkflowXaml).Returns(new StringBuilder(WorkFlowXaml));
            resourceModelMock.SetupGet(model => model.Environment.EnvironmentID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ServerID).Returns(Guid.NewGuid);
            var view = new Mock<IView>();
            resourceModelMock.Setup(model => model.GetView(It.IsAny<Func<IView>>())).Returns(view.Object);
            var sorksurfaceContextManager = new WorksurfaceContextManager(false, _shellViewModel);
            var beforeCount = _shellViewModel.Items.Count;
            //---------------Assert Precondition----------------
            Assert.IsNotNull(sorksurfaceContextManager);
            Assert.AreEqual(2, beforeCount);
            //---------------Execute Test ----------------------
            sorksurfaceContextManager.EditMySqlSource(resourceModelMock.Object, view.Object);
            var afterCount = _shellViewModel.Items.Count;
            //---------------Test Result -----------------------
            Assert.IsTrue(afterCount > beforeCount);
        }

        [TestMethod]
        [Owner("Nkosinathi Sangweni")]
        public void DisplayResourceWizard_GivenSqlDatabaseResourceType_ShouldEditSqlDatabse()
        {
            //---------------Set up test pack-------------------
            CreateFullExportsAndVm();
            var resourceModelMock = new Mock<IContextualResourceModel>();
            resourceModelMock.SetupGet(model => model.ServerResourceType).Returns("SqlDatabase");
            const string WorkFlowXaml = "<XamlDefinition>&lt;Activity x:Class=\"PBI 6690 - TEST\" xmlns=\"http://schemas.microsoft.com/netfx/2009/xaml/activities\" xmlns:av=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" xmlns:dc=\"clr-namespace:Dev2.Common;assembly=Dev2.CommonDataUtils\" xmlns:ddc=\"clr-namespace:Dev2.DataList.Contract;assembly=Dev2.Data\" xmlns:ddcb=\"clr-namespace:Dev2.DataList.Contract.Binary_Objects;assembly=Dev2.Data\" xmlns:ddd=\"clr-namespace:Dev2.Data.Decision;assembly=Dev2.Data\" xmlns:dddo=\"clr-namespace:Dev2.Data.Decisions.Operations;assembly=Dev2.Data\" xmlns:ddsm=\"clr-namespace:Dev2.Data.SystemTemplates.Models;assembly=Dev2.Data\" xmlns:mva=\"clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities\" xmlns:s=\"clr-namespace:System;assembly=mscorlib\" xmlns:sap=\"http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation\" xmlns:scg=\"clr-namespace:System.Collections.Generic;assembly=mscorlib\" xmlns:sco=\"clr-namespace:System.Collections.ObjectModel;assembly=mscorlib\" xmlns:uaba=\"clr-namespace:Unlimited.Applications.BusinessDesignStudio.Activities;assembly=Dev2.Activities\" xmlns:uf=\"clr-namespace:Unlimited.Framework;assembly=Dev2.Core\" xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"&gt;&lt;x:Members&gt;&lt;x:Property Name=\"AmbientDataList\" Type=\"InOutArgument(scg:List(x:String))\" /&gt;&lt;x:Property Name=\"ParentWorkflowInstanceId\" Type=\"InOutArgument(s:Guid)\" /&gt;&lt;x:Property Name=\"ParentServiceName\" Type=\"InOutArgument(x:String)\" /&gt;&lt;/x:Members&gt;&lt;sap:VirtualizedContainerService.HintSize&gt;654,676&lt;/sap:VirtualizedContainerService.HintSize&gt;&lt;mva:VisualBasic.Settings&gt;Assembly references and imported namespaces serialized as XML namespaces&lt;/mva:VisualBasic.Settings&gt;&lt;TextExpression.NamespacesForImplementation&gt;&lt;scg:List x:TypeArguments=\"x:String\" Capacity=\"7\"&gt;&lt;x:String&gt;Dev2.CommonDataUtils&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.Decisions.Operations&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.SystemTemplates.Models&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract.Binary_Objects&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Framework&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Applications.BusinessDesignStudio.Activities&lt;/x:String&gt;&lt;/scg:List&gt;&lt;/TextExpression.NamespacesForImplementation&gt;&lt;TextExpression.ReferencesForImplementation&gt;&lt;sco:Collection x:TypeArguments=\"AssemblyReference\"&gt;&lt;AssemblyReference&gt;Dev2.CommonDataUtils&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Data&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Core&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Activities&lt;/AssemblyReference&gt;&lt;/sco:Collection&gt;&lt;/TextExpression.ReferencesForImplementation&gt;&lt;Flowchart DisplayName=\"PBI 6690 - TEST\" sap:VirtualizedContainerService.HintSize=\"614,636\"&gt;&lt;Flowchart.Variables&gt;&lt;Variable x:TypeArguments=\"scg:List(x:String)\" Name=\"InstructionList\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"LastResult\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"HasError\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"ExplicitDataList\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"IsValid\" /&gt;&lt;Variable x:TypeArguments=\"uf:UnlimitedObject\" Name=\"d\" /&gt;&lt;Variable x:TypeArguments=\"uaba:Util\" Name=\"t\" /&gt;&lt;Variable x:TypeArguments=\"ddd:Dev2DataListDecisionHandler\" Name=\"Dev2DecisionHandler\" /&gt;&lt;/Flowchart.Variables&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;False&lt;/x:Boolean&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;270,2.5&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;60,75&lt;/av:Size&gt;&lt;av:PointCollection x:Key=\"ConnectorLocation\"&gt;300,77.5 300,107.5 310,107.5 310,211&lt;/av:PointCollection&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;Flowchart.StartNode&gt;&lt;x:Reference&gt;__ReferenceID0&lt;/x:Reference&gt;&lt;/Flowchart.StartNode&gt;&lt;FlowStep x:Name=\"__ReferenceID0\"&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;185,211&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,84&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActionName=\"{x:Null}\" ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"PBI 6690 - TEST Inputs\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"localhost\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,84\" IconPath=\"pack://application:,,,/Warewolf Studio;component/images/Workflow-32.png\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;n1&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n2&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n3&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"True\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;result&amp;quot; MapsTo=&amp;quot;result&amp;quot; Value=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"PBI 6690 - TEST Inputs\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"PBI 6690 - TEST Inputs\" Type=\"Workflow\" UniqueID=\"edadb62e-83f4-44bf-a260-7639d6b43169\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.HelpLink&gt;&lt;InArgument x:TypeArguments=\"x:String\"&gt;&lt;Literal x:TypeArguments=\"x:String\" Value=\"\" /&gt;&lt;/InArgument&gt;&lt;/uaba:DsfActivity.HelpLink&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;FlowStep&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;145,390&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,100&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" HelpLink=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" ActionName=\"dbo.spGetCountries\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"Countries\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"CitiesDb\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,100\" IconPath=\"[Nothing]\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;Prefix&amp;quot; Source=&amp;quot;Prefix&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"False\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;CountryID&amp;quot; MapsTo=&amp;quot;CountryID&amp;quot; Value=&amp;quot;[[GetCountries().CountryID]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;Output Name=&amp;quot;Description&amp;quot; MapsTo=&amp;quot;Name&amp;quot; Value=&amp;quot;[[GetCountries().Name]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"Countries\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"Countries\" Type=\"InvokeStoredProc\" UniqueID=\"33476822-9519-4ad5-8fee-1ae3b571115b\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;/Flowchart&gt;&lt;/Activity&gt;</XamlDefinition>";
            resourceModelMock.SetupGet(model => model.WorkflowXaml).Returns(new StringBuilder(WorkFlowXaml));
            resourceModelMock.SetupGet(model => model.Environment.EnvironmentID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ServerID).Returns(Guid.NewGuid);
            var sorksurfaceContextManager = new WorksurfaceContextManager(false, _shellViewModel, new Mock<IServerRepository>().Object, new Mock<IViewFactory>().Object);

            var beforeCount = _shellViewModel.Items.Count;
            //---------------Assert Precondition----------------
            Assert.IsNotNull(sorksurfaceContextManager);
            Assert.AreEqual(2, beforeCount);
            var server = new Mock<IServer>();
            server.Setup(server1 => server1.UpdateRepository).Returns(new Mock<IStudioUpdateManager>().Object);
            server.Setup(server1 => server1.QueryProxy).Returns(new Mock<IQueryManager>().Object);
            server.Setup(server1 => server1.Name).Returns("localhost");
            _shellViewModel.ActiveServer = server.Object;
            _activeEnvironment.Setup(model => model.Name).Returns("localhost");
            //---------------Execute Test ----------------------
            sorksurfaceContextManager.DisplayResourceWizard(resourceModelMock.Object);

            //---------------Test Result -----------------------
            var workSurfaceViewModels = _shellViewModel.Items.Any(model => model.WorkSurfaceViewModel is ViewModels.SourceViewModel<Common.Interfaces.ServerProxyLayer.IDbSource>);
            Assert.IsTrue(workSurfaceViewModels);
        }

        [TestMethod]
        [Owner("Nkosinathi Sangweni")]
        public void DisplayResourceWizard_GivenODBCResourceType_ShouldEditODBC()
        {
            //---------------Set up test pack-------------------
            CreateFullExportsAndVm();
            var resourceModelMock = new Mock<IContextualResourceModel>();
            resourceModelMock.SetupGet(model => model.ServerResourceType).Returns("ODBC");
            const string WorkFlowXaml = "<XamlDefinition>&lt;Activity x:Class=\"PBI 6690 - TEST\" xmlns=\"http://schemas.microsoft.com/netfx/2009/xaml/activities\" xmlns:av=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" xmlns:dc=\"clr-namespace:Dev2.Common;assembly=Dev2.CommonDataUtils\" xmlns:ddc=\"clr-namespace:Dev2.DataList.Contract;assembly=Dev2.Data\" xmlns:ddcb=\"clr-namespace:Dev2.DataList.Contract.Binary_Objects;assembly=Dev2.Data\" xmlns:ddd=\"clr-namespace:Dev2.Data.Decision;assembly=Dev2.Data\" xmlns:dddo=\"clr-namespace:Dev2.Data.Decisions.Operations;assembly=Dev2.Data\" xmlns:ddsm=\"clr-namespace:Dev2.Data.SystemTemplates.Models;assembly=Dev2.Data\" xmlns:mva=\"clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities\" xmlns:s=\"clr-namespace:System;assembly=mscorlib\" xmlns:sap=\"http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation\" xmlns:scg=\"clr-namespace:System.Collections.Generic;assembly=mscorlib\" xmlns:sco=\"clr-namespace:System.Collections.ObjectModel;assembly=mscorlib\" xmlns:uaba=\"clr-namespace:Unlimited.Applications.BusinessDesignStudio.Activities;assembly=Dev2.Activities\" xmlns:uf=\"clr-namespace:Unlimited.Framework;assembly=Dev2.Core\" xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"&gt;&lt;x:Members&gt;&lt;x:Property Name=\"AmbientDataList\" Type=\"InOutArgument(scg:List(x:String))\" /&gt;&lt;x:Property Name=\"ParentWorkflowInstanceId\" Type=\"InOutArgument(s:Guid)\" /&gt;&lt;x:Property Name=\"ParentServiceName\" Type=\"InOutArgument(x:String)\" /&gt;&lt;/x:Members&gt;&lt;sap:VirtualizedContainerService.HintSize&gt;654,676&lt;/sap:VirtualizedContainerService.HintSize&gt;&lt;mva:VisualBasic.Settings&gt;Assembly references and imported namespaces serialized as XML namespaces&lt;/mva:VisualBasic.Settings&gt;&lt;TextExpression.NamespacesForImplementation&gt;&lt;scg:List x:TypeArguments=\"x:String\" Capacity=\"7\"&gt;&lt;x:String&gt;Dev2.CommonDataUtils&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.Decisions.Operations&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.SystemTemplates.Models&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract.Binary_Objects&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Framework&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Applications.BusinessDesignStudio.Activities&lt;/x:String&gt;&lt;/scg:List&gt;&lt;/TextExpression.NamespacesForImplementation&gt;&lt;TextExpression.ReferencesForImplementation&gt;&lt;sco:Collection x:TypeArguments=\"AssemblyReference\"&gt;&lt;AssemblyReference&gt;Dev2.CommonDataUtils&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Data&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Core&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Activities&lt;/AssemblyReference&gt;&lt;/sco:Collection&gt;&lt;/TextExpression.ReferencesForImplementation&gt;&lt;Flowchart DisplayName=\"PBI 6690 - TEST\" sap:VirtualizedContainerService.HintSize=\"614,636\"&gt;&lt;Flowchart.Variables&gt;&lt;Variable x:TypeArguments=\"scg:List(x:String)\" Name=\"InstructionList\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"LastResult\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"HasError\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"ExplicitDataList\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"IsValid\" /&gt;&lt;Variable x:TypeArguments=\"uf:UnlimitedObject\" Name=\"d\" /&gt;&lt;Variable x:TypeArguments=\"uaba:Util\" Name=\"t\" /&gt;&lt;Variable x:TypeArguments=\"ddd:Dev2DataListDecisionHandler\" Name=\"Dev2DecisionHandler\" /&gt;&lt;/Flowchart.Variables&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;False&lt;/x:Boolean&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;270,2.5&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;60,75&lt;/av:Size&gt;&lt;av:PointCollection x:Key=\"ConnectorLocation\"&gt;300,77.5 300,107.5 310,107.5 310,211&lt;/av:PointCollection&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;Flowchart.StartNode&gt;&lt;x:Reference&gt;__ReferenceID0&lt;/x:Reference&gt;&lt;/Flowchart.StartNode&gt;&lt;FlowStep x:Name=\"__ReferenceID0\"&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;185,211&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,84&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActionName=\"{x:Null}\" ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"PBI 6690 - TEST Inputs\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"localhost\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,84\" IconPath=\"pack://application:,,,/Warewolf Studio;component/images/Workflow-32.png\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;n1&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n2&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n3&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"True\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;result&amp;quot; MapsTo=&amp;quot;result&amp;quot; Value=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"PBI 6690 - TEST Inputs\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"PBI 6690 - TEST Inputs\" Type=\"Workflow\" UniqueID=\"edadb62e-83f4-44bf-a260-7639d6b43169\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.HelpLink&gt;&lt;InArgument x:TypeArguments=\"x:String\"&gt;&lt;Literal x:TypeArguments=\"x:String\" Value=\"\" /&gt;&lt;/InArgument&gt;&lt;/uaba:DsfActivity.HelpLink&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;FlowStep&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;145,390&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,100&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" HelpLink=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" ActionName=\"dbo.spGetCountries\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"Countries\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"CitiesDb\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,100\" IconPath=\"[Nothing]\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;Prefix&amp;quot; Source=&amp;quot;Prefix&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"False\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;CountryID&amp;quot; MapsTo=&amp;quot;CountryID&amp;quot; Value=&amp;quot;[[GetCountries().CountryID]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;Output Name=&amp;quot;Description&amp;quot; MapsTo=&amp;quot;Name&amp;quot; Value=&amp;quot;[[GetCountries().Name]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"Countries\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"Countries\" Type=\"InvokeStoredProc\" UniqueID=\"33476822-9519-4ad5-8fee-1ae3b571115b\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;/Flowchart&gt;&lt;/Activity&gt;</XamlDefinition>";
            resourceModelMock.SetupGet(model => model.WorkflowXaml).Returns(new StringBuilder(WorkFlowXaml));
            resourceModelMock.SetupGet(model => model.Environment.EnvironmentID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ServerID).Returns(Guid.NewGuid);
            var sorksurfaceContextManager = new WorksurfaceContextManager(false, _shellViewModel);
            var beforeCount = _shellViewModel.Items.Count;
            var server = new Mock<IServer>();
            server.Setup(server1 => server1.UpdateRepository).Returns(new Mock<IStudioUpdateManager>().Object);
            server.Setup(server1 => server1.QueryProxy).Returns(new Mock<IQueryManager>().Object);
            server.Setup(server1 => server1.Name).Returns("localhost");
            _shellViewModel.ActiveServer = server.Object;
            _activeEnvironment.Setup(model => model.Name).Returns("localhost");
            //---------------Assert Precondition----------------
            Assert.IsNotNull(sorksurfaceContextManager);
            Assert.AreEqual(2, beforeCount);
            //---------------Execute Test ----------------------
            sorksurfaceContextManager.DisplayResourceWizard(resourceModelMock.Object);
            //---------------Test Result -----------------------
            var workSurfaceViewModels = _shellViewModel.Items.Any(model => model.WorkSurfaceViewModel is ViewModels.SourceViewModel<Common.Interfaces.ServerProxyLayer.IDbSource>);
            Assert.IsTrue(workSurfaceViewModels);
        }
        
        [TestMethod]
        [Owner("Nkosinathi Sangweni")]
        [DoNotParallelize]
        public void DisplayResourceWizard_GivenOracleResourceType_ShouldEditODBC()
        {
            //---------------Set up test pack-------------------
            CreateFullExportsAndVm();
            var resourceModelMock = new Mock<IContextualResourceModel>();
            resourceModelMock.SetupGet(model => model.ServerResourceType).Returns("Oracle");
            const string WorkFlowXaml = "<XamlDefinition>&lt;Activity x:Class=\"PBI 6690 - TEST\" xmlns=\"http://schemas.microsoft.com/netfx/2009/xaml/activities\" xmlns:av=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" xmlns:dc=\"clr-namespace:Dev2.Common;assembly=Dev2.CommonDataUtils\" xmlns:ddc=\"clr-namespace:Dev2.DataList.Contract;assembly=Dev2.Data\" xmlns:ddcb=\"clr-namespace:Dev2.DataList.Contract.Binary_Objects;assembly=Dev2.Data\" xmlns:ddd=\"clr-namespace:Dev2.Data.Decision;assembly=Dev2.Data\" xmlns:dddo=\"clr-namespace:Dev2.Data.Decisions.Operations;assembly=Dev2.Data\" xmlns:ddsm=\"clr-namespace:Dev2.Data.SystemTemplates.Models;assembly=Dev2.Data\" xmlns:mva=\"clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities\" xmlns:s=\"clr-namespace:System;assembly=mscorlib\" xmlns:sap=\"http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation\" xmlns:scg=\"clr-namespace:System.Collections.Generic;assembly=mscorlib\" xmlns:sco=\"clr-namespace:System.Collections.ObjectModel;assembly=mscorlib\" xmlns:uaba=\"clr-namespace:Unlimited.Applications.BusinessDesignStudio.Activities;assembly=Dev2.Activities\" xmlns:uf=\"clr-namespace:Unlimited.Framework;assembly=Dev2.Core\" xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"&gt;&lt;x:Members&gt;&lt;x:Property Name=\"AmbientDataList\" Type=\"InOutArgument(scg:List(x:String))\" /&gt;&lt;x:Property Name=\"ParentWorkflowInstanceId\" Type=\"InOutArgument(s:Guid)\" /&gt;&lt;x:Property Name=\"ParentServiceName\" Type=\"InOutArgument(x:String)\" /&gt;&lt;/x:Members&gt;&lt;sap:VirtualizedContainerService.HintSize&gt;654,676&lt;/sap:VirtualizedContainerService.HintSize&gt;&lt;mva:VisualBasic.Settings&gt;Assembly references and imported namespaces serialized as XML namespaces&lt;/mva:VisualBasic.Settings&gt;&lt;TextExpression.NamespacesForImplementation&gt;&lt;scg:List x:TypeArguments=\"x:String\" Capacity=\"7\"&gt;&lt;x:String&gt;Dev2.CommonDataUtils&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.Decisions.Operations&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.SystemTemplates.Models&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract.Binary_Objects&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Framework&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Applications.BusinessDesignStudio.Activities&lt;/x:String&gt;&lt;/scg:List&gt;&lt;/TextExpression.NamespacesForImplementation&gt;&lt;TextExpression.ReferencesForImplementation&gt;&lt;sco:Collection x:TypeArguments=\"AssemblyReference\"&gt;&lt;AssemblyReference&gt;Dev2.CommonDataUtils&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Data&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Core&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Activities&lt;/AssemblyReference&gt;&lt;/sco:Collection&gt;&lt;/TextExpression.ReferencesForImplementation&gt;&lt;Flowchart DisplayName=\"PBI 6690 - TEST\" sap:VirtualizedContainerService.HintSize=\"614,636\"&gt;&lt;Flowchart.Variables&gt;&lt;Variable x:TypeArguments=\"scg:List(x:String)\" Name=\"InstructionList\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"LastResult\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"HasError\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"ExplicitDataList\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"IsValid\" /&gt;&lt;Variable x:TypeArguments=\"uf:UnlimitedObject\" Name=\"d\" /&gt;&lt;Variable x:TypeArguments=\"uaba:Util\" Name=\"t\" /&gt;&lt;Variable x:TypeArguments=\"ddd:Dev2DataListDecisionHandler\" Name=\"Dev2DecisionHandler\" /&gt;&lt;/Flowchart.Variables&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;False&lt;/x:Boolean&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;270,2.5&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;60,75&lt;/av:Size&gt;&lt;av:PointCollection x:Key=\"ConnectorLocation\"&gt;300,77.5 300,107.5 310,107.5 310,211&lt;/av:PointCollection&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;Flowchart.StartNode&gt;&lt;x:Reference&gt;__ReferenceID0&lt;/x:Reference&gt;&lt;/Flowchart.StartNode&gt;&lt;FlowStep x:Name=\"__ReferenceID0\"&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;185,211&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,84&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActionName=\"{x:Null}\" ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"PBI 6690 - TEST Inputs\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"localhost\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,84\" IconPath=\"pack://application:,,,/Warewolf Studio;component/images/Workflow-32.png\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;n1&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n2&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n3&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"True\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;result&amp;quot; MapsTo=&amp;quot;result&amp;quot; Value=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"PBI 6690 - TEST Inputs\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"PBI 6690 - TEST Inputs\" Type=\"Workflow\" UniqueID=\"edadb62e-83f4-44bf-a260-7639d6b43169\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.HelpLink&gt;&lt;InArgument x:TypeArguments=\"x:String\"&gt;&lt;Literal x:TypeArguments=\"x:String\" Value=\"\" /&gt;&lt;/InArgument&gt;&lt;/uaba:DsfActivity.HelpLink&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;FlowStep&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;145,390&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,100&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" HelpLink=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" ActionName=\"dbo.spGetCountries\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"Countries\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"CitiesDb\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,100\" IconPath=\"[Nothing]\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;Prefix&amp;quot; Source=&amp;quot;Prefix&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"False\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;CountryID&amp;quot; MapsTo=&amp;quot;CountryID&amp;quot; Value=&amp;quot;[[GetCountries().CountryID]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;Output Name=&amp;quot;Description&amp;quot; MapsTo=&amp;quot;Name&amp;quot; Value=&amp;quot;[[GetCountries().Name]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"Countries\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"Countries\" Type=\"InvokeStoredProc\" UniqueID=\"33476822-9519-4ad5-8fee-1ae3b571115b\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;/Flowchart&gt;&lt;/Activity&gt;</XamlDefinition>";
            resourceModelMock.SetupGet(model => model.WorkflowXaml).Returns(new StringBuilder(WorkFlowXaml));
            resourceModelMock.SetupGet(model => model.Environment.EnvironmentID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ServerID).Returns(Guid.NewGuid);
            var sorksurfaceContextManager = new WorksurfaceContextManager(false, _shellViewModel, new Mock<IServerRepository>().Object, new Mock<IViewFactory>().Object);
            var beforeCount = _shellViewModel.Items.Count;
            var server = new Mock<IServer>();
            server.Setup(server1 => server1.UpdateRepository).Returns(new Mock<IStudioUpdateManager>().Object);
            server.Setup(server1 => server1.QueryProxy).Returns(new Mock<IQueryManager>().Object);
            server.Setup(server1 => server1.Name).Returns("localhost");
            _shellViewModel.ActiveServer = server.Object;
            _activeEnvironment.Setup(model => model.Name).Returns("localhost");
            //---------------Assert Precondition----------------
            Assert.IsNotNull(sorksurfaceContextManager);
            Assert.AreEqual(2, beforeCount);
            //---------------Execute Test ----------------------
            sorksurfaceContextManager.DisplayResourceWizard(resourceModelMock.Object);
            //---------------Test Result -----------------------
            var workSurfaceViewModels = _shellViewModel.Items.Any(model => model.WorkSurfaceViewModel is ViewModels.SourceViewModel<Common.Interfaces.ServerProxyLayer.IDbSource>);
            Assert.IsTrue(workSurfaceViewModels);
        }

        [TestMethod]
        [Owner("Nkosinathi Sangweni")]
        [DoNotParallelize]
        public void DisplayResourceWizard_GivenPostgreSQLResourceType_ShouldEditODBC()
        {
            //---------------Set up test pack-------------------
            CreateFullExportsAndVm();
            var resourceModelMock = new Mock<IContextualResourceModel>();
            resourceModelMock.SetupGet(model => model.ServerResourceType).Returns("PostgreSQL");
            const string WorkFlowXaml = "<XamlDefinition>&lt;Activity x:Class=\"PBI 6690 - TEST\" xmlns=\"http://schemas.microsoft.com/netfx/2009/xaml/activities\" xmlns:av=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" xmlns:dc=\"clr-namespace:Dev2.Common;assembly=Dev2.CommonDataUtils\" xmlns:ddc=\"clr-namespace:Dev2.DataList.Contract;assembly=Dev2.Data\" xmlns:ddcb=\"clr-namespace:Dev2.DataList.Contract.Binary_Objects;assembly=Dev2.Data\" xmlns:ddd=\"clr-namespace:Dev2.Data.Decision;assembly=Dev2.Data\" xmlns:dddo=\"clr-namespace:Dev2.Data.Decisions.Operations;assembly=Dev2.Data\" xmlns:ddsm=\"clr-namespace:Dev2.Data.SystemTemplates.Models;assembly=Dev2.Data\" xmlns:mva=\"clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities\" xmlns:s=\"clr-namespace:System;assembly=mscorlib\" xmlns:sap=\"http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation\" xmlns:scg=\"clr-namespace:System.Collections.Generic;assembly=mscorlib\" xmlns:sco=\"clr-namespace:System.Collections.ObjectModel;assembly=mscorlib\" xmlns:uaba=\"clr-namespace:Unlimited.Applications.BusinessDesignStudio.Activities;assembly=Dev2.Activities\" xmlns:uf=\"clr-namespace:Unlimited.Framework;assembly=Dev2.Core\" xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"&gt;&lt;x:Members&gt;&lt;x:Property Name=\"AmbientDataList\" Type=\"InOutArgument(scg:List(x:String))\" /&gt;&lt;x:Property Name=\"ParentWorkflowInstanceId\" Type=\"InOutArgument(s:Guid)\" /&gt;&lt;x:Property Name=\"ParentServiceName\" Type=\"InOutArgument(x:String)\" /&gt;&lt;/x:Members&gt;&lt;sap:VirtualizedContainerService.HintSize&gt;654,676&lt;/sap:VirtualizedContainerService.HintSize&gt;&lt;mva:VisualBasic.Settings&gt;Assembly references and imported namespaces serialized as XML namespaces&lt;/mva:VisualBasic.Settings&gt;&lt;TextExpression.NamespacesForImplementation&gt;&lt;scg:List x:TypeArguments=\"x:String\" Capacity=\"7\"&gt;&lt;x:String&gt;Dev2.CommonDataUtils&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.Decisions.Operations&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.SystemTemplates.Models&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract.Binary_Objects&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Framework&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Applications.BusinessDesignStudio.Activities&lt;/x:String&gt;&lt;/scg:List&gt;&lt;/TextExpression.NamespacesForImplementation&gt;&lt;TextExpression.ReferencesForImplementation&gt;&lt;sco:Collection x:TypeArguments=\"AssemblyReference\"&gt;&lt;AssemblyReference&gt;Dev2.CommonDataUtils&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Data&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Core&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Activities&lt;/AssemblyReference&gt;&lt;/sco:Collection&gt;&lt;/TextExpression.ReferencesForImplementation&gt;&lt;Flowchart DisplayName=\"PBI 6690 - TEST\" sap:VirtualizedContainerService.HintSize=\"614,636\"&gt;&lt;Flowchart.Variables&gt;&lt;Variable x:TypeArguments=\"scg:List(x:String)\" Name=\"InstructionList\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"LastResult\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"HasError\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"ExplicitDataList\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"IsValid\" /&gt;&lt;Variable x:TypeArguments=\"uf:UnlimitedObject\" Name=\"d\" /&gt;&lt;Variable x:TypeArguments=\"uaba:Util\" Name=\"t\" /&gt;&lt;Variable x:TypeArguments=\"ddd:Dev2DataListDecisionHandler\" Name=\"Dev2DecisionHandler\" /&gt;&lt;/Flowchart.Variables&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;False&lt;/x:Boolean&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;270,2.5&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;60,75&lt;/av:Size&gt;&lt;av:PointCollection x:Key=\"ConnectorLocation\"&gt;300,77.5 300,107.5 310,107.5 310,211&lt;/av:PointCollection&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;Flowchart.StartNode&gt;&lt;x:Reference&gt;__ReferenceID0&lt;/x:Reference&gt;&lt;/Flowchart.StartNode&gt;&lt;FlowStep x:Name=\"__ReferenceID0\"&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;185,211&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,84&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActionName=\"{x:Null}\" ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"PBI 6690 - TEST Inputs\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"localhost\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,84\" IconPath=\"pack://application:,,,/Warewolf Studio;component/images/Workflow-32.png\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;n1&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n2&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n3&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"True\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;result&amp;quot; MapsTo=&amp;quot;result&amp;quot; Value=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"PBI 6690 - TEST Inputs\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"PBI 6690 - TEST Inputs\" Type=\"Workflow\" UniqueID=\"edadb62e-83f4-44bf-a260-7639d6b43169\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.HelpLink&gt;&lt;InArgument x:TypeArguments=\"x:String\"&gt;&lt;Literal x:TypeArguments=\"x:String\" Value=\"\" /&gt;&lt;/InArgument&gt;&lt;/uaba:DsfActivity.HelpLink&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;FlowStep&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;145,390&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,100&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" HelpLink=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" ActionName=\"dbo.spGetCountries\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"Countries\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"CitiesDb\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,100\" IconPath=\"[Nothing]\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;Prefix&amp;quot; Source=&amp;quot;Prefix&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"False\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;CountryID&amp;quot; MapsTo=&amp;quot;CountryID&amp;quot; Value=&amp;quot;[[GetCountries().CountryID]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;Output Name=&amp;quot;Description&amp;quot; MapsTo=&amp;quot;Name&amp;quot; Value=&amp;quot;[[GetCountries().Name]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"Countries\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"Countries\" Type=\"InvokeStoredProc\" UniqueID=\"33476822-9519-4ad5-8fee-1ae3b571115b\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;/Flowchart&gt;&lt;/Activity&gt;</XamlDefinition>";
            resourceModelMock.SetupGet(model => model.WorkflowXaml).Returns(new StringBuilder(WorkFlowXaml));
            resourceModelMock.SetupGet(model => model.Environment.EnvironmentID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ServerID).Returns(Guid.NewGuid);
            var sorksurfaceContextManager = new WorksurfaceContextManager(false, _shellViewModel);
            var beforeCount = _shellViewModel.Items.Count;
            var server = new Mock<IServer>();
            server.Setup(server1 => server1.UpdateRepository).Returns(new Mock<IStudioUpdateManager>().Object);
            server.Setup(server1 => server1.QueryProxy).Returns(new Mock<IQueryManager>().Object);
            _shellViewModel.ActiveServer = server.Object;
            _activeEnvironment.Setup(model => model.Name).Returns("localhost");
            //---------------Assert Precondition----------------
            Assert.IsNotNull(sorksurfaceContextManager);
            Assert.AreEqual(2, beforeCount);
            //---------------Execute Test ----------------------
            sorksurfaceContextManager.DisplayResourceWizard(resourceModelMock.Object);
            //---------------Test Result -----------------------
            var workSurfaceViewModels = _shellViewModel.Items.Any(model => model.WorkSurfaceViewModel is ViewModels.SourceViewModel<Common.Interfaces.ServerProxyLayer.IDbSource>);
            Assert.IsTrue(workSurfaceViewModels);
        }

        [TestMethod]
        [Owner("Nkosinathi Sangweni")]
        [DoNotParallelize]
        public void DisplayResourceWizard_GivenMySqlDatabaseResourceType_ShouldEditODBC()
        {
            //---------------Set up test pack-------------------
            CreateFullExportsAndVm();
            var resourceModelMock = new Mock<IContextualResourceModel>();
            resourceModelMock.SetupGet(model => model.ServerResourceType).Returns("MySqlDatabase");
            const string WorkFlowXaml = "<XamlDefinition>&lt;Activity x:Class=\"PBI 6690 - TEST\" xmlns=\"http://schemas.microsoft.com/netfx/2009/xaml/activities\" xmlns:av=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" xmlns:dc=\"clr-namespace:Dev2.Common;assembly=Dev2.CommonDataUtils\" xmlns:ddc=\"clr-namespace:Dev2.DataList.Contract;assembly=Dev2.Data\" xmlns:ddcb=\"clr-namespace:Dev2.DataList.Contract.Binary_Objects;assembly=Dev2.Data\" xmlns:ddd=\"clr-namespace:Dev2.Data.Decision;assembly=Dev2.Data\" xmlns:dddo=\"clr-namespace:Dev2.Data.Decisions.Operations;assembly=Dev2.Data\" xmlns:ddsm=\"clr-namespace:Dev2.Data.SystemTemplates.Models;assembly=Dev2.Data\" xmlns:mva=\"clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities\" xmlns:s=\"clr-namespace:System;assembly=mscorlib\" xmlns:sap=\"http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation\" xmlns:scg=\"clr-namespace:System.Collections.Generic;assembly=mscorlib\" xmlns:sco=\"clr-namespace:System.Collections.ObjectModel;assembly=mscorlib\" xmlns:uaba=\"clr-namespace:Unlimited.Applications.BusinessDesignStudio.Activities;assembly=Dev2.Activities\" xmlns:uf=\"clr-namespace:Unlimited.Framework;assembly=Dev2.Core\" xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"&gt;&lt;x:Members&gt;&lt;x:Property Name=\"AmbientDataList\" Type=\"InOutArgument(scg:List(x:String))\" /&gt;&lt;x:Property Name=\"ParentWorkflowInstanceId\" Type=\"InOutArgument(s:Guid)\" /&gt;&lt;x:Property Name=\"ParentServiceName\" Type=\"InOutArgument(x:String)\" /&gt;&lt;/x:Members&gt;&lt;sap:VirtualizedContainerService.HintSize&gt;654,676&lt;/sap:VirtualizedContainerService.HintSize&gt;&lt;mva:VisualBasic.Settings&gt;Assembly references and imported namespaces serialized as XML namespaces&lt;/mva:VisualBasic.Settings&gt;&lt;TextExpression.NamespacesForImplementation&gt;&lt;scg:List x:TypeArguments=\"x:String\" Capacity=\"7\"&gt;&lt;x:String&gt;Dev2.CommonDataUtils&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.Decisions.Operations&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.SystemTemplates.Models&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract.Binary_Objects&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Framework&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Applications.BusinessDesignStudio.Activities&lt;/x:String&gt;&lt;/scg:List&gt;&lt;/TextExpression.NamespacesForImplementation&gt;&lt;TextExpression.ReferencesForImplementation&gt;&lt;sco:Collection x:TypeArguments=\"AssemblyReference\"&gt;&lt;AssemblyReference&gt;Dev2.CommonDataUtils&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Data&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Core&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Activities&lt;/AssemblyReference&gt;&lt;/sco:Collection&gt;&lt;/TextExpression.ReferencesForImplementation&gt;&lt;Flowchart DisplayName=\"PBI 6690 - TEST\" sap:VirtualizedContainerService.HintSize=\"614,636\"&gt;&lt;Flowchart.Variables&gt;&lt;Variable x:TypeArguments=\"scg:List(x:String)\" Name=\"InstructionList\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"LastResult\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"HasError\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"ExplicitDataList\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"IsValid\" /&gt;&lt;Variable x:TypeArguments=\"uf:UnlimitedObject\" Name=\"d\" /&gt;&lt;Variable x:TypeArguments=\"uaba:Util\" Name=\"t\" /&gt;&lt;Variable x:TypeArguments=\"ddd:Dev2DataListDecisionHandler\" Name=\"Dev2DecisionHandler\" /&gt;&lt;/Flowchart.Variables&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;False&lt;/x:Boolean&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;270,2.5&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;60,75&lt;/av:Size&gt;&lt;av:PointCollection x:Key=\"ConnectorLocation\"&gt;300,77.5 300,107.5 310,107.5 310,211&lt;/av:PointCollection&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;Flowchart.StartNode&gt;&lt;x:Reference&gt;__ReferenceID0&lt;/x:Reference&gt;&lt;/Flowchart.StartNode&gt;&lt;FlowStep x:Name=\"__ReferenceID0\"&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;185,211&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,84&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActionName=\"{x:Null}\" ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"PBI 6690 - TEST Inputs\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"localhost\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,84\" IconPath=\"pack://application:,,,/Warewolf Studio;component/images/Workflow-32.png\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;n1&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n2&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n3&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"True\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;result&amp;quot; MapsTo=&amp;quot;result&amp;quot; Value=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"PBI 6690 - TEST Inputs\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"PBI 6690 - TEST Inputs\" Type=\"Workflow\" UniqueID=\"edadb62e-83f4-44bf-a260-7639d6b43169\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.HelpLink&gt;&lt;InArgument x:TypeArguments=\"x:String\"&gt;&lt;Literal x:TypeArguments=\"x:String\" Value=\"\" /&gt;&lt;/InArgument&gt;&lt;/uaba:DsfActivity.HelpLink&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;FlowStep&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;145,390&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,100&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" HelpLink=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" ActionName=\"dbo.spGetCountries\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"Countries\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"CitiesDb\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,100\" IconPath=\"[Nothing]\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;Prefix&amp;quot; Source=&amp;quot;Prefix&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"False\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;CountryID&amp;quot; MapsTo=&amp;quot;CountryID&amp;quot; Value=&amp;quot;[[GetCountries().CountryID]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;Output Name=&amp;quot;Description&amp;quot; MapsTo=&amp;quot;Name&amp;quot; Value=&amp;quot;[[GetCountries().Name]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"Countries\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"Countries\" Type=\"InvokeStoredProc\" UniqueID=\"33476822-9519-4ad5-8fee-1ae3b571115b\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;/Flowchart&gt;&lt;/Activity&gt;</XamlDefinition>";
            resourceModelMock.SetupGet(model => model.WorkflowXaml).Returns(new StringBuilder(WorkFlowXaml));
            resourceModelMock.SetupGet(model => model.Environment.EnvironmentID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ServerID).Returns(Guid.NewGuid);
            var sorksurfaceContextManager = new WorksurfaceContextManager(false, _shellViewModel);
            var beforeCount = _shellViewModel.Items.Count;
            var server = new Mock<IServer>();
            server.Setup(server1 => server1.UpdateRepository).Returns(new Mock<IStudioUpdateManager>().Object);
            server.Setup(server1 => server1.QueryProxy).Returns(new Mock<IQueryManager>().Object);
            _shellViewModel.ActiveServer = server.Object;
            _activeEnvironment.Setup(model => model.Name).Returns("localhost");
            //---------------Assert Precondition----------------
            Assert.IsNotNull(sorksurfaceContextManager);
            Assert.AreEqual(2, beforeCount);
            //---------------Execute Test ----------------------
            sorksurfaceContextManager.DisplayResourceWizard(resourceModelMock.Object);
            //---------------Test Result -----------------------
            var workSurfaceViewModels = _shellViewModel.Items.Any(model => model.WorkSurfaceViewModel is ViewModels.SourceViewModel<Common.Interfaces.ServerProxyLayer.IDbSource>);
            Assert.IsTrue(workSurfaceViewModels);
        }

        [TestMethod]
        [Owner("Nkosinathi Sangweni")]
        public void DisplayResourceWizard_GivenWebSourceResourceType_ShouldEditWebSource()
        {
            //---------------Set up test pack-------------------
            CreateFullExportsAndVm();
            var resourceModelMock = new Mock<IContextualResourceModel>();
            resourceModelMock.SetupGet(model => model.ServerResourceType).Returns("WebSource");
            const string WorkFlowXaml = "<XamlDefinition>&lt;Activity x:Class=\"PBI 6690 - TEST\" xmlns=\"http://schemas.microsoft.com/netfx/2009/xaml/activities\" xmlns:av=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" xmlns:dc=\"clr-namespace:Dev2.Common;assembly=Dev2.CommonDataUtils\" xmlns:ddc=\"clr-namespace:Dev2.DataList.Contract;assembly=Dev2.Data\" xmlns:ddcb=\"clr-namespace:Dev2.DataList.Contract.Binary_Objects;assembly=Dev2.Data\" xmlns:ddd=\"clr-namespace:Dev2.Data.Decision;assembly=Dev2.Data\" xmlns:dddo=\"clr-namespace:Dev2.Data.Decisions.Operations;assembly=Dev2.Data\" xmlns:ddsm=\"clr-namespace:Dev2.Data.SystemTemplates.Models;assembly=Dev2.Data\" xmlns:mva=\"clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities\" xmlns:s=\"clr-namespace:System;assembly=mscorlib\" xmlns:sap=\"http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation\" xmlns:scg=\"clr-namespace:System.Collections.Generic;assembly=mscorlib\" xmlns:sco=\"clr-namespace:System.Collections.ObjectModel;assembly=mscorlib\" xmlns:uaba=\"clr-namespace:Unlimited.Applications.BusinessDesignStudio.Activities;assembly=Dev2.Activities\" xmlns:uf=\"clr-namespace:Unlimited.Framework;assembly=Dev2.Core\" xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"&gt;&lt;x:Members&gt;&lt;x:Property Name=\"AmbientDataList\" Type=\"InOutArgument(scg:List(x:String))\" /&gt;&lt;x:Property Name=\"ParentWorkflowInstanceId\" Type=\"InOutArgument(s:Guid)\" /&gt;&lt;x:Property Name=\"ParentServiceName\" Type=\"InOutArgument(x:String)\" /&gt;&lt;/x:Members&gt;&lt;sap:VirtualizedContainerService.HintSize&gt;654,676&lt;/sap:VirtualizedContainerService.HintSize&gt;&lt;mva:VisualBasic.Settings&gt;Assembly references and imported namespaces serialized as XML namespaces&lt;/mva:VisualBasic.Settings&gt;&lt;TextExpression.NamespacesForImplementation&gt;&lt;scg:List x:TypeArguments=\"x:String\" Capacity=\"7\"&gt;&lt;x:String&gt;Dev2.CommonDataUtils&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.Decisions.Operations&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.SystemTemplates.Models&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract.Binary_Objects&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Framework&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Applications.BusinessDesignStudio.Activities&lt;/x:String&gt;&lt;/scg:List&gt;&lt;/TextExpression.NamespacesForImplementation&gt;&lt;TextExpression.ReferencesForImplementation&gt;&lt;sco:Collection x:TypeArguments=\"AssemblyReference\"&gt;&lt;AssemblyReference&gt;Dev2.CommonDataUtils&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Data&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Core&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Activities&lt;/AssemblyReference&gt;&lt;/sco:Collection&gt;&lt;/TextExpression.ReferencesForImplementation&gt;&lt;Flowchart DisplayName=\"PBI 6690 - TEST\" sap:VirtualizedContainerService.HintSize=\"614,636\"&gt;&lt;Flowchart.Variables&gt;&lt;Variable x:TypeArguments=\"scg:List(x:String)\" Name=\"InstructionList\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"LastResult\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"HasError\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"ExplicitDataList\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"IsValid\" /&gt;&lt;Variable x:TypeArguments=\"uf:UnlimitedObject\" Name=\"d\" /&gt;&lt;Variable x:TypeArguments=\"uaba:Util\" Name=\"t\" /&gt;&lt;Variable x:TypeArguments=\"ddd:Dev2DataListDecisionHandler\" Name=\"Dev2DecisionHandler\" /&gt;&lt;/Flowchart.Variables&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;False&lt;/x:Boolean&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;270,2.5&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;60,75&lt;/av:Size&gt;&lt;av:PointCollection x:Key=\"ConnectorLocation\"&gt;300,77.5 300,107.5 310,107.5 310,211&lt;/av:PointCollection&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;Flowchart.StartNode&gt;&lt;x:Reference&gt;__ReferenceID0&lt;/x:Reference&gt;&lt;/Flowchart.StartNode&gt;&lt;FlowStep x:Name=\"__ReferenceID0\"&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;185,211&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,84&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActionName=\"{x:Null}\" ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"PBI 6690 - TEST Inputs\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"localhost\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,84\" IconPath=\"pack://application:,,,/Warewolf Studio;component/images/Workflow-32.png\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;n1&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n2&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n3&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"True\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;result&amp;quot; MapsTo=&amp;quot;result&amp;quot; Value=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"PBI 6690 - TEST Inputs\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"PBI 6690 - TEST Inputs\" Type=\"Workflow\" UniqueID=\"edadb62e-83f4-44bf-a260-7639d6b43169\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.HelpLink&gt;&lt;InArgument x:TypeArguments=\"x:String\"&gt;&lt;Literal x:TypeArguments=\"x:String\" Value=\"\" /&gt;&lt;/InArgument&gt;&lt;/uaba:DsfActivity.HelpLink&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;FlowStep&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;145,390&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,100&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" HelpLink=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" ActionName=\"dbo.spGetCountries\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"Countries\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"CitiesDb\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,100\" IconPath=\"[Nothing]\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;Prefix&amp;quot; Source=&amp;quot;Prefix&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"False\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;CountryID&amp;quot; MapsTo=&amp;quot;CountryID&amp;quot; Value=&amp;quot;[[GetCountries().CountryID]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;Output Name=&amp;quot;Description&amp;quot; MapsTo=&amp;quot;Name&amp;quot; Value=&amp;quot;[[GetCountries().Name]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"Countries\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"Countries\" Type=\"InvokeStoredProc\" UniqueID=\"33476822-9519-4ad5-8fee-1ae3b571115b\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;/Flowchart&gt;&lt;/Activity&gt;</XamlDefinition>";
            resourceModelMock.SetupGet(model => model.WorkflowXaml).Returns(new StringBuilder(WorkFlowXaml));
            resourceModelMock.SetupGet(model => model.Environment.EnvironmentID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ServerID).Returns(Guid.NewGuid);
            var sorksurfaceContextManager = new WorksurfaceContextManager(false, _shellViewModel);
            var beforeCount = _shellViewModel.Items.Count;
            var server = new Mock<IServer>();
            server.Setup(server1 => server1.UpdateRepository).Returns(new Mock<IStudioUpdateManager>().Object);
            server.Setup(server1 => server1.QueryProxy).Returns(new Mock<IQueryManager>().Object);
            _shellViewModel.ActiveServer = server.Object;
            _activeEnvironment.Setup(model => model.Name).Returns("localhost");
            //---------------Assert Precondition----------------
            Assert.IsNotNull(sorksurfaceContextManager);
            Assert.AreEqual(2, beforeCount);
            //---------------Execute Test ----------------------
            sorksurfaceContextManager.DisplayResourceWizard(resourceModelMock.Object);
            //---------------Test Result -----------------------
            var workSurfaceViewModels = _shellViewModel.Items.Any(model => model.WorkSurfaceViewModel is ViewModels.SourceViewModel<Common.Interfaces.ServerProxyLayer.IWebServiceSource>);
            Assert.IsTrue(workSurfaceViewModels);

        }

        [TestMethod]
        [Owner("Nkosinathi Sangweni")]
        [DoNotParallelize]
        public void DisplayResourceWizard_GivenWcfSourceResourceType_ShouldEditWcfSource()
        {
            //---------------Set up test pack-------------------
            CreateFullExportsAndVm();
            var resourceModelMock = new Mock<IContextualResourceModel>();
            resourceModelMock.SetupGet(model => model.ServerResourceType).Returns("WcfSource");
            const string WorkFlowXaml = "<XamlDefinition>&lt;Activity x:Class=\"PBI 6690 - TEST\" xmlns=\"http://schemas.microsoft.com/netfx/2009/xaml/activities\" xmlns:av=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" xmlns:dc=\"clr-namespace:Dev2.Common;assembly=Dev2.CommonDataUtils\" xmlns:ddc=\"clr-namespace:Dev2.DataList.Contract;assembly=Dev2.Data\" xmlns:ddcb=\"clr-namespace:Dev2.DataList.Contract.Binary_Objects;assembly=Dev2.Data\" xmlns:ddd=\"clr-namespace:Dev2.Data.Decision;assembly=Dev2.Data\" xmlns:dddo=\"clr-namespace:Dev2.Data.Decisions.Operations;assembly=Dev2.Data\" xmlns:ddsm=\"clr-namespace:Dev2.Data.SystemTemplates.Models;assembly=Dev2.Data\" xmlns:mva=\"clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities\" xmlns:s=\"clr-namespace:System;assembly=mscorlib\" xmlns:sap=\"http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation\" xmlns:scg=\"clr-namespace:System.Collections.Generic;assembly=mscorlib\" xmlns:sco=\"clr-namespace:System.Collections.ObjectModel;assembly=mscorlib\" xmlns:uaba=\"clr-namespace:Unlimited.Applications.BusinessDesignStudio.Activities;assembly=Dev2.Activities\" xmlns:uf=\"clr-namespace:Unlimited.Framework;assembly=Dev2.Core\" xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"&gt;&lt;x:Members&gt;&lt;x:Property Name=\"AmbientDataList\" Type=\"InOutArgument(scg:List(x:String))\" /&gt;&lt;x:Property Name=\"ParentWorkflowInstanceId\" Type=\"InOutArgument(s:Guid)\" /&gt;&lt;x:Property Name=\"ParentServiceName\" Type=\"InOutArgument(x:String)\" /&gt;&lt;/x:Members&gt;&lt;sap:VirtualizedContainerService.HintSize&gt;654,676&lt;/sap:VirtualizedContainerService.HintSize&gt;&lt;mva:VisualBasic.Settings&gt;Assembly references and imported namespaces serialized as XML namespaces&lt;/mva:VisualBasic.Settings&gt;&lt;TextExpression.NamespacesForImplementation&gt;&lt;scg:List x:TypeArguments=\"x:String\" Capacity=\"7\"&gt;&lt;x:String&gt;Dev2.CommonDataUtils&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.Decisions.Operations&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.SystemTemplates.Models&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract.Binary_Objects&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Framework&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Applications.BusinessDesignStudio.Activities&lt;/x:String&gt;&lt;/scg:List&gt;&lt;/TextExpression.NamespacesForImplementation&gt;&lt;TextExpression.ReferencesForImplementation&gt;&lt;sco:Collection x:TypeArguments=\"AssemblyReference\"&gt;&lt;AssemblyReference&gt;Dev2.CommonDataUtils&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Data&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Core&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Activities&lt;/AssemblyReference&gt;&lt;/sco:Collection&gt;&lt;/TextExpression.ReferencesForImplementation&gt;&lt;Flowchart DisplayName=\"PBI 6690 - TEST\" sap:VirtualizedContainerService.HintSize=\"614,636\"&gt;&lt;Flowchart.Variables&gt;&lt;Variable x:TypeArguments=\"scg:List(x:String)\" Name=\"InstructionList\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"LastResult\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"HasError\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"ExplicitDataList\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"IsValid\" /&gt;&lt;Variable x:TypeArguments=\"uf:UnlimitedObject\" Name=\"d\" /&gt;&lt;Variable x:TypeArguments=\"uaba:Util\" Name=\"t\" /&gt;&lt;Variable x:TypeArguments=\"ddd:Dev2DataListDecisionHandler\" Name=\"Dev2DecisionHandler\" /&gt;&lt;/Flowchart.Variables&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;False&lt;/x:Boolean&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;270,2.5&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;60,75&lt;/av:Size&gt;&lt;av:PointCollection x:Key=\"ConnectorLocation\"&gt;300,77.5 300,107.5 310,107.5 310,211&lt;/av:PointCollection&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;Flowchart.StartNode&gt;&lt;x:Reference&gt;__ReferenceID0&lt;/x:Reference&gt;&lt;/Flowchart.StartNode&gt;&lt;FlowStep x:Name=\"__ReferenceID0\"&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;185,211&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,84&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActionName=\"{x:Null}\" ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"PBI 6690 - TEST Inputs\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"localhost\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,84\" IconPath=\"pack://application:,,,/Warewolf Studio;component/images/Workflow-32.png\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;n1&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n2&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n3&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"True\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;result&amp;quot; MapsTo=&amp;quot;result&amp;quot; Value=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"PBI 6690 - TEST Inputs\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"PBI 6690 - TEST Inputs\" Type=\"Workflow\" UniqueID=\"edadb62e-83f4-44bf-a260-7639d6b43169\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.HelpLink&gt;&lt;InArgument x:TypeArguments=\"x:String\"&gt;&lt;Literal x:TypeArguments=\"x:String\" Value=\"\" /&gt;&lt;/InArgument&gt;&lt;/uaba:DsfActivity.HelpLink&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;FlowStep&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;145,390&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,100&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" HelpLink=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" ActionName=\"dbo.spGetCountries\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"Countries\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"CitiesDb\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,100\" IconPath=\"[Nothing]\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;Prefix&amp;quot; Source=&amp;quot;Prefix&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"False\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;CountryID&amp;quot; MapsTo=&amp;quot;CountryID&amp;quot; Value=&amp;quot;[[GetCountries().CountryID]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;Output Name=&amp;quot;Description&amp;quot; MapsTo=&amp;quot;Name&amp;quot; Value=&amp;quot;[[GetCountries().Name]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"Countries\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"Countries\" Type=\"InvokeStoredProc\" UniqueID=\"33476822-9519-4ad5-8fee-1ae3b571115b\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;/Flowchart&gt;&lt;/Activity&gt;</XamlDefinition>";
            resourceModelMock.SetupGet(model => model.WorkflowXaml).Returns(new StringBuilder(WorkFlowXaml));
            resourceModelMock.SetupGet(model => model.Environment.EnvironmentID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ServerID).Returns(Guid.NewGuid);
            var sorksurfaceContextManager = new WorksurfaceContextManager(false, _shellViewModel);
            var beforeCount = _shellViewModel.Items.Count;
            var server = new Mock<IServer>();
            server.Setup(server1 => server1.UpdateRepository).Returns(new Mock<IStudioUpdateManager>().Object);
            server.Setup(server1 => server1.QueryProxy).Returns(new Mock<IQueryManager>().Object);
            _shellViewModel.ActiveServer = server.Object;
            _activeEnvironment.Setup(model => model.Name).Returns("localhost");
            //---------------Assert Precondition----------------
            Assert.IsNotNull(sorksurfaceContextManager);
            Assert.AreEqual(2, beforeCount);
            //---------------Execute Test ----------------------
            sorksurfaceContextManager.DisplayResourceWizard(resourceModelMock.Object);
            //---------------Test Result -----------------------
            var workSurfaceViewModels = _shellViewModel.Items.Any(model => model.WorkSurfaceViewModel is ViewModels.SourceViewModel<IWcfServerSource>);
            Assert.IsTrue(workSurfaceViewModels);
        }

        [TestMethod]
        [Owner("Nkosinathi Sangweni")]
        public void DisplayResourceWizard_GivenEmailSourceResourceType_ShouldEditEmailSource()
        {
            //---------------Set up test pack-------------------
            CreateFullExportsAndVm();
            var resourceModelMock = new Mock<IContextualResourceModel>();
            resourceModelMock.SetupGet(model => model.ServerResourceType).Returns("EmailSource");
            const string WorkFlowXaml = "<XamlDefinition>&lt;Activity x:Class=\"PBI 6690 - TEST\" xmlns=\"http://schemas.microsoft.com/netfx/2009/xaml/activities\" xmlns:av=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" xmlns:dc=\"clr-namespace:Dev2.Common;assembly=Dev2.CommonDataUtils\" xmlns:ddc=\"clr-namespace:Dev2.DataList.Contract;assembly=Dev2.Data\" xmlns:ddcb=\"clr-namespace:Dev2.DataList.Contract.Binary_Objects;assembly=Dev2.Data\" xmlns:ddd=\"clr-namespace:Dev2.Data.Decision;assembly=Dev2.Data\" xmlns:dddo=\"clr-namespace:Dev2.Data.Decisions.Operations;assembly=Dev2.Data\" xmlns:ddsm=\"clr-namespace:Dev2.Data.SystemTemplates.Models;assembly=Dev2.Data\" xmlns:mva=\"clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities\" xmlns:s=\"clr-namespace:System;assembly=mscorlib\" xmlns:sap=\"http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation\" xmlns:scg=\"clr-namespace:System.Collections.Generic;assembly=mscorlib\" xmlns:sco=\"clr-namespace:System.Collections.ObjectModel;assembly=mscorlib\" xmlns:uaba=\"clr-namespace:Unlimited.Applications.BusinessDesignStudio.Activities;assembly=Dev2.Activities\" xmlns:uf=\"clr-namespace:Unlimited.Framework;assembly=Dev2.Core\" xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"&gt;&lt;x:Members&gt;&lt;x:Property Name=\"AmbientDataList\" Type=\"InOutArgument(scg:List(x:String))\" /&gt;&lt;x:Property Name=\"ParentWorkflowInstanceId\" Type=\"InOutArgument(s:Guid)\" /&gt;&lt;x:Property Name=\"ParentServiceName\" Type=\"InOutArgument(x:String)\" /&gt;&lt;/x:Members&gt;&lt;sap:VirtualizedContainerService.HintSize&gt;654,676&lt;/sap:VirtualizedContainerService.HintSize&gt;&lt;mva:VisualBasic.Settings&gt;Assembly references and imported namespaces serialized as XML namespaces&lt;/mva:VisualBasic.Settings&gt;&lt;TextExpression.NamespacesForImplementation&gt;&lt;scg:List x:TypeArguments=\"x:String\" Capacity=\"7\"&gt;&lt;x:String&gt;Dev2.CommonDataUtils&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.Decisions.Operations&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.SystemTemplates.Models&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract.Binary_Objects&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Framework&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Applications.BusinessDesignStudio.Activities&lt;/x:String&gt;&lt;/scg:List&gt;&lt;/TextExpression.NamespacesForImplementation&gt;&lt;TextExpression.ReferencesForImplementation&gt;&lt;sco:Collection x:TypeArguments=\"AssemblyReference\"&gt;&lt;AssemblyReference&gt;Dev2.CommonDataUtils&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Data&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Core&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Activities&lt;/AssemblyReference&gt;&lt;/sco:Collection&gt;&lt;/TextExpression.ReferencesForImplementation&gt;&lt;Flowchart DisplayName=\"PBI 6690 - TEST\" sap:VirtualizedContainerService.HintSize=\"614,636\"&gt;&lt;Flowchart.Variables&gt;&lt;Variable x:TypeArguments=\"scg:List(x:String)\" Name=\"InstructionList\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"LastResult\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"HasError\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"ExplicitDataList\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"IsValid\" /&gt;&lt;Variable x:TypeArguments=\"uf:UnlimitedObject\" Name=\"d\" /&gt;&lt;Variable x:TypeArguments=\"uaba:Util\" Name=\"t\" /&gt;&lt;Variable x:TypeArguments=\"ddd:Dev2DataListDecisionHandler\" Name=\"Dev2DecisionHandler\" /&gt;&lt;/Flowchart.Variables&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;False&lt;/x:Boolean&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;270,2.5&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;60,75&lt;/av:Size&gt;&lt;av:PointCollection x:Key=\"ConnectorLocation\"&gt;300,77.5 300,107.5 310,107.5 310,211&lt;/av:PointCollection&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;Flowchart.StartNode&gt;&lt;x:Reference&gt;__ReferenceID0&lt;/x:Reference&gt;&lt;/Flowchart.StartNode&gt;&lt;FlowStep x:Name=\"__ReferenceID0\"&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;185,211&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,84&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActionName=\"{x:Null}\" ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"PBI 6690 - TEST Inputs\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"localhost\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,84\" IconPath=\"pack://application:,,,/Warewolf Studio;component/images/Workflow-32.png\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;n1&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n2&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n3&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"True\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;result&amp;quot; MapsTo=&amp;quot;result&amp;quot; Value=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"PBI 6690 - TEST Inputs\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"PBI 6690 - TEST Inputs\" Type=\"Workflow\" UniqueID=\"edadb62e-83f4-44bf-a260-7639d6b43169\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.HelpLink&gt;&lt;InArgument x:TypeArguments=\"x:String\"&gt;&lt;Literal x:TypeArguments=\"x:String\" Value=\"\" /&gt;&lt;/InArgument&gt;&lt;/uaba:DsfActivity.HelpLink&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;FlowStep&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;145,390&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,100&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" HelpLink=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" ActionName=\"dbo.spGetCountries\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"Countries\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"CitiesDb\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,100\" IconPath=\"[Nothing]\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;Prefix&amp;quot; Source=&amp;quot;Prefix&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"False\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;CountryID&amp;quot; MapsTo=&amp;quot;CountryID&amp;quot; Value=&amp;quot;[[GetCountries().CountryID]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;Output Name=&amp;quot;Description&amp;quot; MapsTo=&amp;quot;Name&amp;quot; Value=&amp;quot;[[GetCountries().Name]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"Countries\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"Countries\" Type=\"InvokeStoredProc\" UniqueID=\"33476822-9519-4ad5-8fee-1ae3b571115b\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;/Flowchart&gt;&lt;/Activity&gt;</XamlDefinition>";
            resourceModelMock.SetupGet(model => model.WorkflowXaml).Returns(new StringBuilder(WorkFlowXaml));
            resourceModelMock.SetupGet(model => model.Environment.EnvironmentID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ServerID).Returns(Guid.NewGuid);
            var sorksurfaceContextManager = new WorksurfaceContextManager(false, _shellViewModel);
            var beforeCount = _shellViewModel.Items.Count;
            var server = new Mock<IServer>();
            server.Setup(server1 => server1.UpdateRepository).Returns(new Mock<IStudioUpdateManager>().Object);
            server.Setup(server1 => server1.QueryProxy).Returns(new Mock<IQueryManager>().Object);
            _shellViewModel.ActiveServer = server.Object;
            _activeEnvironment.Setup(model => model.Name).Returns("localhost");
            //---------------Assert Precondition----------------
            Assert.IsNotNull(sorksurfaceContextManager);
            Assert.AreEqual(2, beforeCount);
            //---------------Execute Test ----------------------
            sorksurfaceContextManager.DisplayResourceWizard(resourceModelMock.Object);
            //---------------Test Result -----------------------
            var workSurfaceViewModels = _shellViewModel.Items.Any(model => model.WorkSurfaceViewModel is ViewModels.SourceViewModel<IEmailServiceSource>);
            Assert.IsTrue(workSurfaceViewModels);
        }

        [TestMethod]
        [Owner("Nkosinathi Sangweni")]
        public void DisplayResourceWizard_GivenExchangeSourceResourceType_ShouldEditExchangeSource()
        {
            //---------------Set up test pack-------------------
            CreateFullExportsAndVm();
            var resourceModelMock = new Mock<IContextualResourceModel>();
            resourceModelMock.SetupGet(model => model.ServerResourceType).Returns("ExchangeSource");
            const string WorkFlowXaml = "<XamlDefinition>&lt;Activity x:Class=\"PBI 6690 - TEST\" xmlns=\"http://schemas.microsoft.com/netfx/2009/xaml/activities\" xmlns:av=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" xmlns:dc=\"clr-namespace:Dev2.Common;assembly=Dev2.CommonDataUtils\" xmlns:ddc=\"clr-namespace:Dev2.DataList.Contract;assembly=Dev2.Data\" xmlns:ddcb=\"clr-namespace:Dev2.DataList.Contract.Binary_Objects;assembly=Dev2.Data\" xmlns:ddd=\"clr-namespace:Dev2.Data.Decision;assembly=Dev2.Data\" xmlns:dddo=\"clr-namespace:Dev2.Data.Decisions.Operations;assembly=Dev2.Data\" xmlns:ddsm=\"clr-namespace:Dev2.Data.SystemTemplates.Models;assembly=Dev2.Data\" xmlns:mva=\"clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities\" xmlns:s=\"clr-namespace:System;assembly=mscorlib\" xmlns:sap=\"http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation\" xmlns:scg=\"clr-namespace:System.Collections.Generic;assembly=mscorlib\" xmlns:sco=\"clr-namespace:System.Collections.ObjectModel;assembly=mscorlib\" xmlns:uaba=\"clr-namespace:Unlimited.Applications.BusinessDesignStudio.Activities;assembly=Dev2.Activities\" xmlns:uf=\"clr-namespace:Unlimited.Framework;assembly=Dev2.Core\" xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"&gt;&lt;x:Members&gt;&lt;x:Property Name=\"AmbientDataList\" Type=\"InOutArgument(scg:List(x:String))\" /&gt;&lt;x:Property Name=\"ParentWorkflowInstanceId\" Type=\"InOutArgument(s:Guid)\" /&gt;&lt;x:Property Name=\"ParentServiceName\" Type=\"InOutArgument(x:String)\" /&gt;&lt;/x:Members&gt;&lt;sap:VirtualizedContainerService.HintSize&gt;654,676&lt;/sap:VirtualizedContainerService.HintSize&gt;&lt;mva:VisualBasic.Settings&gt;Assembly references and imported namespaces serialized as XML namespaces&lt;/mva:VisualBasic.Settings&gt;&lt;TextExpression.NamespacesForImplementation&gt;&lt;scg:List x:TypeArguments=\"x:String\" Capacity=\"7\"&gt;&lt;x:String&gt;Dev2.CommonDataUtils&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.Decisions.Operations&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.SystemTemplates.Models&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract.Binary_Objects&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Framework&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Applications.BusinessDesignStudio.Activities&lt;/x:String&gt;&lt;/scg:List&gt;&lt;/TextExpression.NamespacesForImplementation&gt;&lt;TextExpression.ReferencesForImplementation&gt;&lt;sco:Collection x:TypeArguments=\"AssemblyReference\"&gt;&lt;AssemblyReference&gt;Dev2.CommonDataUtils&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Data&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Core&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Activities&lt;/AssemblyReference&gt;&lt;/sco:Collection&gt;&lt;/TextExpression.ReferencesForImplementation&gt;&lt;Flowchart DisplayName=\"PBI 6690 - TEST\" sap:VirtualizedContainerService.HintSize=\"614,636\"&gt;&lt;Flowchart.Variables&gt;&lt;Variable x:TypeArguments=\"scg:List(x:String)\" Name=\"InstructionList\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"LastResult\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"HasError\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"ExplicitDataList\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"IsValid\" /&gt;&lt;Variable x:TypeArguments=\"uf:UnlimitedObject\" Name=\"d\" /&gt;&lt;Variable x:TypeArguments=\"uaba:Util\" Name=\"t\" /&gt;&lt;Variable x:TypeArguments=\"ddd:Dev2DataListDecisionHandler\" Name=\"Dev2DecisionHandler\" /&gt;&lt;/Flowchart.Variables&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;False&lt;/x:Boolean&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;270,2.5&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;60,75&lt;/av:Size&gt;&lt;av:PointCollection x:Key=\"ConnectorLocation\"&gt;300,77.5 300,107.5 310,107.5 310,211&lt;/av:PointCollection&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;Flowchart.StartNode&gt;&lt;x:Reference&gt;__ReferenceID0&lt;/x:Reference&gt;&lt;/Flowchart.StartNode&gt;&lt;FlowStep x:Name=\"__ReferenceID0\"&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;185,211&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,84&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActionName=\"{x:Null}\" ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"PBI 6690 - TEST Inputs\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"localhost\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,84\" IconPath=\"pack://application:,,,/Warewolf Studio;component/images/Workflow-32.png\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;n1&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n2&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n3&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"True\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;result&amp;quot; MapsTo=&amp;quot;result&amp;quot; Value=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"PBI 6690 - TEST Inputs\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"PBI 6690 - TEST Inputs\" Type=\"Workflow\" UniqueID=\"edadb62e-83f4-44bf-a260-7639d6b43169\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.HelpLink&gt;&lt;InArgument x:TypeArguments=\"x:String\"&gt;&lt;Literal x:TypeArguments=\"x:String\" Value=\"\" /&gt;&lt;/InArgument&gt;&lt;/uaba:DsfActivity.HelpLink&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;FlowStep&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;145,390&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,100&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" HelpLink=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" ActionName=\"dbo.spGetCountries\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"Countries\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"CitiesDb\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,100\" IconPath=\"[Nothing]\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;Prefix&amp;quot; Source=&amp;quot;Prefix&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"False\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;CountryID&amp;quot; MapsTo=&amp;quot;CountryID&amp;quot; Value=&amp;quot;[[GetCountries().CountryID]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;Output Name=&amp;quot;Description&amp;quot; MapsTo=&amp;quot;Name&amp;quot; Value=&amp;quot;[[GetCountries().Name]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"Countries\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"Countries\" Type=\"InvokeStoredProc\" UniqueID=\"33476822-9519-4ad5-8fee-1ae3b571115b\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;/Flowchart&gt;&lt;/Activity&gt;</XamlDefinition>";
            resourceModelMock.SetupGet(model => model.WorkflowXaml).Returns(new StringBuilder(WorkFlowXaml));
            resourceModelMock.SetupGet(model => model.Environment.EnvironmentID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ServerID).Returns(Guid.NewGuid);
            var sorksurfaceContextManager = new WorksurfaceContextManager(false, _shellViewModel);
            var beforeCount = _shellViewModel.Items.Count;
            var server = new Mock<IServer>();
            server.Setup(server1 => server1.UpdateRepository).Returns(new Mock<IStudioUpdateManager>().Object);
            server.Setup(server1 => server1.QueryProxy).Returns(new Mock<IQueryManager>().Object);
            _shellViewModel.ActiveServer = server.Object;
            _activeEnvironment.Setup(model => model.Name).Returns("localhost");
            //---------------Assert Precondition----------------
            Assert.IsNotNull(sorksurfaceContextManager);
            Assert.AreEqual(2, beforeCount);
            //---------------Execute Test ----------------------
            System.Windows.Threading.Dispatcher.CurrentDispatcher.Invoke(System.Windows.Threading.DispatcherPriority.Send, new Action(() => sorksurfaceContextManager.DisplayResourceWizard(resourceModelMock.Object)));
            //---------------Test Result -----------------------
            var workSurfaceViewModels = _shellViewModel.Items.Any(model => model.WorkSurfaceViewModel is ViewModels.SourceViewModel<IExchangeSource>);
            Assert.IsTrue(workSurfaceViewModels);
        }

        [TestMethod]
        [Owner("Nkosinathi Sangweni")]
        public void DisplayResourceWizard_GivenDropBoxSourceResourceType_ShouldEditDropBoxSource()
        {
            //---------------Set up test pack-------------------
            CreateFullExportsAndVm();
            var resourceModelMock = new Mock<IContextualResourceModel>();
            resourceModelMock.SetupGet(model => model.ServerResourceType).Returns("DropBoxSource");
            const string WorkFlowXaml = "<XamlDefinition>&lt;Activity x:Class=\"PBI 6690 - TEST\" xmlns=\"http://schemas.microsoft.com/netfx/2009/xaml/activities\" xmlns:av=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" xmlns:dc=\"clr-namespace:Dev2.Common;assembly=Dev2.CommonDataUtils\" xmlns:ddc=\"clr-namespace:Dev2.DataList.Contract;assembly=Dev2.Data\" xmlns:ddcb=\"clr-namespace:Dev2.DataList.Contract.Binary_Objects;assembly=Dev2.Data\" xmlns:ddd=\"clr-namespace:Dev2.Data.Decision;assembly=Dev2.Data\" xmlns:dddo=\"clr-namespace:Dev2.Data.Decisions.Operations;assembly=Dev2.Data\" xmlns:ddsm=\"clr-namespace:Dev2.Data.SystemTemplates.Models;assembly=Dev2.Data\" xmlns:mva=\"clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities\" xmlns:s=\"clr-namespace:System;assembly=mscorlib\" xmlns:sap=\"http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation\" xmlns:scg=\"clr-namespace:System.Collections.Generic;assembly=mscorlib\" xmlns:sco=\"clr-namespace:System.Collections.ObjectModel;assembly=mscorlib\" xmlns:uaba=\"clr-namespace:Unlimited.Applications.BusinessDesignStudio.Activities;assembly=Dev2.Activities\" xmlns:uf=\"clr-namespace:Unlimited.Framework;assembly=Dev2.Core\" xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"&gt;&lt;x:Members&gt;&lt;x:Property Name=\"AmbientDataList\" Type=\"InOutArgument(scg:List(x:String))\" /&gt;&lt;x:Property Name=\"ParentWorkflowInstanceId\" Type=\"InOutArgument(s:Guid)\" /&gt;&lt;x:Property Name=\"ParentServiceName\" Type=\"InOutArgument(x:String)\" /&gt;&lt;/x:Members&gt;&lt;sap:VirtualizedContainerService.HintSize&gt;654,676&lt;/sap:VirtualizedContainerService.HintSize&gt;&lt;mva:VisualBasic.Settings&gt;Assembly references and imported namespaces serialized as XML namespaces&lt;/mva:VisualBasic.Settings&gt;&lt;TextExpression.NamespacesForImplementation&gt;&lt;scg:List x:TypeArguments=\"x:String\" Capacity=\"7\"&gt;&lt;x:String&gt;Dev2.CommonDataUtils&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.Decisions.Operations&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.SystemTemplates.Models&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract.Binary_Objects&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Framework&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Applications.BusinessDesignStudio.Activities&lt;/x:String&gt;&lt;/scg:List&gt;&lt;/TextExpression.NamespacesForImplementation&gt;&lt;TextExpression.ReferencesForImplementation&gt;&lt;sco:Collection x:TypeArguments=\"AssemblyReference\"&gt;&lt;AssemblyReference&gt;Dev2.CommonDataUtils&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Data&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Core&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Activities&lt;/AssemblyReference&gt;&lt;/sco:Collection&gt;&lt;/TextExpression.ReferencesForImplementation&gt;&lt;Flowchart DisplayName=\"PBI 6690 - TEST\" sap:VirtualizedContainerService.HintSize=\"614,636\"&gt;&lt;Flowchart.Variables&gt;&lt;Variable x:TypeArguments=\"scg:List(x:String)\" Name=\"InstructionList\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"LastResult\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"HasError\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"ExplicitDataList\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"IsValid\" /&gt;&lt;Variable x:TypeArguments=\"uf:UnlimitedObject\" Name=\"d\" /&gt;&lt;Variable x:TypeArguments=\"uaba:Util\" Name=\"t\" /&gt;&lt;Variable x:TypeArguments=\"ddd:Dev2DataListDecisionHandler\" Name=\"Dev2DecisionHandler\" /&gt;&lt;/Flowchart.Variables&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;False&lt;/x:Boolean&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;270,2.5&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;60,75&lt;/av:Size&gt;&lt;av:PointCollection x:Key=\"ConnectorLocation\"&gt;300,77.5 300,107.5 310,107.5 310,211&lt;/av:PointCollection&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;Flowchart.StartNode&gt;&lt;x:Reference&gt;__ReferenceID0&lt;/x:Reference&gt;&lt;/Flowchart.StartNode&gt;&lt;FlowStep x:Name=\"__ReferenceID0\"&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;185,211&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,84&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActionName=\"{x:Null}\" ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"PBI 6690 - TEST Inputs\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"localhost\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,84\" IconPath=\"pack://application:,,,/Warewolf Studio;component/images/Workflow-32.png\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;n1&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n2&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n3&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"True\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;result&amp;quot; MapsTo=&amp;quot;result&amp;quot; Value=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"PBI 6690 - TEST Inputs\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"PBI 6690 - TEST Inputs\" Type=\"Workflow\" UniqueID=\"edadb62e-83f4-44bf-a260-7639d6b43169\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.HelpLink&gt;&lt;InArgument x:TypeArguments=\"x:String\"&gt;&lt;Literal x:TypeArguments=\"x:String\" Value=\"\" /&gt;&lt;/InArgument&gt;&lt;/uaba:DsfActivity.HelpLink&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;FlowStep&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;145,390&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,100&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" HelpLink=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" ActionName=\"dbo.spGetCountries\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"Countries\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"CitiesDb\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,100\" IconPath=\"[Nothing]\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;Prefix&amp;quot; Source=&amp;quot;Prefix&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"False\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;CountryID&amp;quot; MapsTo=&amp;quot;CountryID&amp;quot; Value=&amp;quot;[[GetCountries().CountryID]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;Output Name=&amp;quot;Description&amp;quot; MapsTo=&amp;quot;Name&amp;quot; Value=&amp;quot;[[GetCountries().Name]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"Countries\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"Countries\" Type=\"InvokeStoredProc\" UniqueID=\"33476822-9519-4ad5-8fee-1ae3b571115b\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;/Flowchart&gt;&lt;/Activity&gt;</XamlDefinition>";
            resourceModelMock.SetupGet(model => model.WorkflowXaml).Returns(new StringBuilder(WorkFlowXaml));
            resourceModelMock.SetupGet(model => model.Environment.EnvironmentID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ServerID).Returns(Guid.NewGuid);
            var sorksurfaceContextManager = new WorksurfaceContextManager(false, _shellViewModel);
            var beforeCount = _shellViewModel.Items.Count;
            var server = new Mock<IServer>();
            server.Setup(server1 => server1.UpdateRepository).Returns(new Mock<IStudioUpdateManager>().Object);
            server.Setup(server1 => server1.QueryProxy).Returns(new Mock<IQueryManager>().Object);
            _shellViewModel.ActiveServer = server.Object;
            _activeEnvironment.Setup(model => model.Name).Returns("localhost");
            //---------------Assert Precondition----------------
            Assert.IsNotNull(sorksurfaceContextManager);
            Assert.AreEqual(2, beforeCount);
            //---------------Execute Test ----------------------
            System.Windows.Threading.Dispatcher.CurrentDispatcher.Invoke(System.Windows.Threading.DispatcherPriority.Send, new Action(() => sorksurfaceContextManager.DisplayResourceWizard(resourceModelMock.Object)));
            //---------------Test Result -----------------------
            var workSurfaceViewModels = _shellViewModel.Items.Any(model => model.WorkSurfaceViewModel is ViewModels.SourceViewModel<IOAuthSource>);
            Assert.IsTrue(workSurfaceViewModels);
        }

        [TestMethod]
        [Owner("Nkosinathi Sangweni")]
        [DoNotParallelize]
        public void DisplayResourceWizard_GivenSharepointServerSourceResourceType_ShouldEditSharepointServerSource()
        {
            //---------------Set up test pack-------------------
            CreateFullExportsAndVm();
            var resourceModelMock = new Mock<IContextualResourceModel>();
            resourceModelMock.SetupGet(model => model.ServerResourceType).Returns("SharepointServerSource");
            const string WorkFlowXaml = "<XamlDefinition>&lt;Activity x:Class=\"PBI 6690 - TEST\" xmlns=\"http://schemas.microsoft.com/netfx/2009/xaml/activities\" xmlns:av=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" xmlns:dc=\"clr-namespace:Dev2.Common;assembly=Dev2.CommonDataUtils\" xmlns:ddc=\"clr-namespace:Dev2.DataList.Contract;assembly=Dev2.Data\" xmlns:ddcb=\"clr-namespace:Dev2.DataList.Contract.Binary_Objects;assembly=Dev2.Data\" xmlns:ddd=\"clr-namespace:Dev2.Data.Decision;assembly=Dev2.Data\" xmlns:dddo=\"clr-namespace:Dev2.Data.Decisions.Operations;assembly=Dev2.Data\" xmlns:ddsm=\"clr-namespace:Dev2.Data.SystemTemplates.Models;assembly=Dev2.Data\" xmlns:mva=\"clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities\" xmlns:s=\"clr-namespace:System;assembly=mscorlib\" xmlns:sap=\"http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation\" xmlns:scg=\"clr-namespace:System.Collections.Generic;assembly=mscorlib\" xmlns:sco=\"clr-namespace:System.Collections.ObjectModel;assembly=mscorlib\" xmlns:uaba=\"clr-namespace:Unlimited.Applications.BusinessDesignStudio.Activities;assembly=Dev2.Activities\" xmlns:uf=\"clr-namespace:Unlimited.Framework;assembly=Dev2.Core\" xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"&gt;&lt;x:Members&gt;&lt;x:Property Name=\"AmbientDataList\" Type=\"InOutArgument(scg:List(x:String))\" /&gt;&lt;x:Property Name=\"ParentWorkflowInstanceId\" Type=\"InOutArgument(s:Guid)\" /&gt;&lt;x:Property Name=\"ParentServiceName\" Type=\"InOutArgument(x:String)\" /&gt;&lt;/x:Members&gt;&lt;sap:VirtualizedContainerService.HintSize&gt;654,676&lt;/sap:VirtualizedContainerService.HintSize&gt;&lt;mva:VisualBasic.Settings&gt;Assembly references and imported namespaces serialized as XML namespaces&lt;/mva:VisualBasic.Settings&gt;&lt;TextExpression.NamespacesForImplementation&gt;&lt;scg:List x:TypeArguments=\"x:String\" Capacity=\"7\"&gt;&lt;x:String&gt;Dev2.CommonDataUtils&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.Decisions.Operations&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.SystemTemplates.Models&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract.Binary_Objects&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Framework&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Applications.BusinessDesignStudio.Activities&lt;/x:String&gt;&lt;/scg:List&gt;&lt;/TextExpression.NamespacesForImplementation&gt;&lt;TextExpression.ReferencesForImplementation&gt;&lt;sco:Collection x:TypeArguments=\"AssemblyReference\"&gt;&lt;AssemblyReference&gt;Dev2.CommonDataUtils&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Data&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Core&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Activities&lt;/AssemblyReference&gt;&lt;/sco:Collection&gt;&lt;/TextExpression.ReferencesForImplementation&gt;&lt;Flowchart DisplayName=\"PBI 6690 - TEST\" sap:VirtualizedContainerService.HintSize=\"614,636\"&gt;&lt;Flowchart.Variables&gt;&lt;Variable x:TypeArguments=\"scg:List(x:String)\" Name=\"InstructionList\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"LastResult\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"HasError\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"ExplicitDataList\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"IsValid\" /&gt;&lt;Variable x:TypeArguments=\"uf:UnlimitedObject\" Name=\"d\" /&gt;&lt;Variable x:TypeArguments=\"uaba:Util\" Name=\"t\" /&gt;&lt;Variable x:TypeArguments=\"ddd:Dev2DataListDecisionHandler\" Name=\"Dev2DecisionHandler\" /&gt;&lt;/Flowchart.Variables&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;False&lt;/x:Boolean&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;270,2.5&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;60,75&lt;/av:Size&gt;&lt;av:PointCollection x:Key=\"ConnectorLocation\"&gt;300,77.5 300,107.5 310,107.5 310,211&lt;/av:PointCollection&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;Flowchart.StartNode&gt;&lt;x:Reference&gt;__ReferenceID0&lt;/x:Reference&gt;&lt;/Flowchart.StartNode&gt;&lt;FlowStep x:Name=\"__ReferenceID0\"&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;185,211&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,84&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActionName=\"{x:Null}\" ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"PBI 6690 - TEST Inputs\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"localhost\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,84\" IconPath=\"pack://application:,,,/Warewolf Studio;component/images/Workflow-32.png\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;n1&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n2&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n3&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"True\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;result&amp;quot; MapsTo=&amp;quot;result&amp;quot; Value=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"PBI 6690 - TEST Inputs\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"PBI 6690 - TEST Inputs\" Type=\"Workflow\" UniqueID=\"edadb62e-83f4-44bf-a260-7639d6b43169\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.HelpLink&gt;&lt;InArgument x:TypeArguments=\"x:String\"&gt;&lt;Literal x:TypeArguments=\"x:String\" Value=\"\" /&gt;&lt;/InArgument&gt;&lt;/uaba:DsfActivity.HelpLink&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;FlowStep&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;145,390&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,100&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" HelpLink=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" ActionName=\"dbo.spGetCountries\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"Countries\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"CitiesDb\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,100\" IconPath=\"[Nothing]\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;Prefix&amp;quot; Source=&amp;quot;Prefix&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"False\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;CountryID&amp;quot; MapsTo=&amp;quot;CountryID&amp;quot; Value=&amp;quot;[[GetCountries().CountryID]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;Output Name=&amp;quot;Description&amp;quot; MapsTo=&amp;quot;Name&amp;quot; Value=&amp;quot;[[GetCountries().Name]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"Countries\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"Countries\" Type=\"InvokeStoredProc\" UniqueID=\"33476822-9519-4ad5-8fee-1ae3b571115b\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;/Flowchart&gt;&lt;/Activity&gt;</XamlDefinition>";
            resourceModelMock.SetupGet(model => model.WorkflowXaml).Returns(new StringBuilder(WorkFlowXaml));
            resourceModelMock.SetupGet(model => model.Environment.EnvironmentID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ServerID).Returns(Guid.NewGuid);
            var sorksurfaceContextManager = new WorksurfaceContextManager(false, _shellViewModel);
            var beforeCount = _shellViewModel.Items.Count;
            var server = new Mock<IServer>();
            server.Setup(server1 => server1.UpdateRepository).Returns(new Mock<IStudioUpdateManager>().Object);
            server.Setup(server1 => server1.QueryProxy).Returns(new Mock<IQueryManager>().Object);
            _shellViewModel.ActiveServer = server.Object;
            _activeEnvironment.Setup(model => model.Name).Returns("localhost");
            //---------------Assert Precondition----------------
            Assert.IsNotNull(sorksurfaceContextManager);
            Assert.AreEqual(2, beforeCount);
            //---------------Execute Test ----------------------
            System.Windows.Threading.Dispatcher.CurrentDispatcher.Invoke(System.Windows.Threading.DispatcherPriority.Send, new Action(() => sorksurfaceContextManager.DisplayResourceWizard(resourceModelMock.Object)));
            //---------------Test Result -----------------------
            var workSurfaceViewModels = _shellViewModel.Items.Any(model => model.WorkSurfaceViewModel is ViewModels.SourceViewModel<ISharepointServerSource>);
            Assert.IsTrue(workSurfaceViewModels);
        }

        [TestMethod]
        [Owner("Nkosinathi Sangweni")]
        [DoNotParallelize]
        public void DisplayResourceWizard_GivenOauthSourceResourceType_ShouldEditOauthSource()
        {
            //---------------Set up test pack-------------------
            CreateFullExportsAndVm();
            var resourceModelMock = new Mock<IContextualResourceModel>();
            resourceModelMock.SetupGet(model => model.ServerResourceType).Returns("OauthSource");
            const string WorkFlowXaml = "<XamlDefinition>&lt;Activity x:Class=\"PBI 6690 - TEST\" xmlns=\"http://schemas.microsoft.com/netfx/2009/xaml/activities\" xmlns:av=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" xmlns:dc=\"clr-namespace:Dev2.Common;assembly=Dev2.CommonDataUtils\" xmlns:ddc=\"clr-namespace:Dev2.DataList.Contract;assembly=Dev2.Data\" xmlns:ddcb=\"clr-namespace:Dev2.DataList.Contract.Binary_Objects;assembly=Dev2.Data\" xmlns:ddd=\"clr-namespace:Dev2.Data.Decision;assembly=Dev2.Data\" xmlns:dddo=\"clr-namespace:Dev2.Data.Decisions.Operations;assembly=Dev2.Data\" xmlns:ddsm=\"clr-namespace:Dev2.Data.SystemTemplates.Models;assembly=Dev2.Data\" xmlns:mva=\"clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities\" xmlns:s=\"clr-namespace:System;assembly=mscorlib\" xmlns:sap=\"http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation\" xmlns:scg=\"clr-namespace:System.Collections.Generic;assembly=mscorlib\" xmlns:sco=\"clr-namespace:System.Collections.ObjectModel;assembly=mscorlib\" xmlns:uaba=\"clr-namespace:Unlimited.Applications.BusinessDesignStudio.Activities;assembly=Dev2.Activities\" xmlns:uf=\"clr-namespace:Unlimited.Framework;assembly=Dev2.Core\" xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"&gt;&lt;x:Members&gt;&lt;x:Property Name=\"AmbientDataList\" Type=\"InOutArgument(scg:List(x:String))\" /&gt;&lt;x:Property Name=\"ParentWorkflowInstanceId\" Type=\"InOutArgument(s:Guid)\" /&gt;&lt;x:Property Name=\"ParentServiceName\" Type=\"InOutArgument(x:String)\" /&gt;&lt;/x:Members&gt;&lt;sap:VirtualizedContainerService.HintSize&gt;654,676&lt;/sap:VirtualizedContainerService.HintSize&gt;&lt;mva:VisualBasic.Settings&gt;Assembly references and imported namespaces serialized as XML namespaces&lt;/mva:VisualBasic.Settings&gt;&lt;TextExpression.NamespacesForImplementation&gt;&lt;scg:List x:TypeArguments=\"x:String\" Capacity=\"7\"&gt;&lt;x:String&gt;Dev2.CommonDataUtils&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.Decisions.Operations&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.SystemTemplates.Models&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract.Binary_Objects&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Framework&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Applications.BusinessDesignStudio.Activities&lt;/x:String&gt;&lt;/scg:List&gt;&lt;/TextExpression.NamespacesForImplementation&gt;&lt;TextExpression.ReferencesForImplementation&gt;&lt;sco:Collection x:TypeArguments=\"AssemblyReference\"&gt;&lt;AssemblyReference&gt;Dev2.CommonDataUtils&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Data&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Core&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Activities&lt;/AssemblyReference&gt;&lt;/sco:Collection&gt;&lt;/TextExpression.ReferencesForImplementation&gt;&lt;Flowchart DisplayName=\"PBI 6690 - TEST\" sap:VirtualizedContainerService.HintSize=\"614,636\"&gt;&lt;Flowchart.Variables&gt;&lt;Variable x:TypeArguments=\"scg:List(x:String)\" Name=\"InstructionList\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"LastResult\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"HasError\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"ExplicitDataList\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"IsValid\" /&gt;&lt;Variable x:TypeArguments=\"uf:UnlimitedObject\" Name=\"d\" /&gt;&lt;Variable x:TypeArguments=\"uaba:Util\" Name=\"t\" /&gt;&lt;Variable x:TypeArguments=\"ddd:Dev2DataListDecisionHandler\" Name=\"Dev2DecisionHandler\" /&gt;&lt;/Flowchart.Variables&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;False&lt;/x:Boolean&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;270,2.5&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;60,75&lt;/av:Size&gt;&lt;av:PointCollection x:Key=\"ConnectorLocation\"&gt;300,77.5 300,107.5 310,107.5 310,211&lt;/av:PointCollection&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;Flowchart.StartNode&gt;&lt;x:Reference&gt;__ReferenceID0&lt;/x:Reference&gt;&lt;/Flowchart.StartNode&gt;&lt;FlowStep x:Name=\"__ReferenceID0\"&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;185,211&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,84&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActionName=\"{x:Null}\" ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"PBI 6690 - TEST Inputs\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"localhost\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,84\" IconPath=\"pack://application:,,,/Warewolf Studio;component/images/Workflow-32.png\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;n1&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n2&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n3&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"True\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;result&amp;quot; MapsTo=&amp;quot;result&amp;quot; Value=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"PBI 6690 - TEST Inputs\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"PBI 6690 - TEST Inputs\" Type=\"Workflow\" UniqueID=\"edadb62e-83f4-44bf-a260-7639d6b43169\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.HelpLink&gt;&lt;InArgument x:TypeArguments=\"x:String\"&gt;&lt;Literal x:TypeArguments=\"x:String\" Value=\"\" /&gt;&lt;/InArgument&gt;&lt;/uaba:DsfActivity.HelpLink&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;FlowStep&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;145,390&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,100&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" HelpLink=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" ActionName=\"dbo.spGetCountries\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"Countries\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"CitiesDb\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,100\" IconPath=\"[Nothing]\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;Prefix&amp;quot; Source=&amp;quot;Prefix&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"False\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;CountryID&amp;quot; MapsTo=&amp;quot;CountryID&amp;quot; Value=&amp;quot;[[GetCountries().CountryID]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;Output Name=&amp;quot;Description&amp;quot; MapsTo=&amp;quot;Name&amp;quot; Value=&amp;quot;[[GetCountries().Name]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"Countries\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"Countries\" Type=\"InvokeStoredProc\" UniqueID=\"33476822-9519-4ad5-8fee-1ae3b571115b\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;/Flowchart&gt;&lt;/Activity&gt;</XamlDefinition>";
            resourceModelMock.SetupGet(model => model.WorkflowXaml).Returns(new StringBuilder(WorkFlowXaml));
            resourceModelMock.SetupGet(model => model.Environment.EnvironmentID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ServerID).Returns(Guid.NewGuid);
            var mock = new Mock<IServerRepository>();
            var viewFactory = new Mock<IViewFactory>();
            var sorksurfaceContextManager = new WorksurfaceContextManager(false, _shellViewModel, mock.Object, viewFactory.Object);
            var beforeCount = _shellViewModel.Items.Count;
            var server = new Mock<IServer>();
            server.Setup(server1 => server1.UpdateRepository).Returns(new Mock<IStudioUpdateManager>().Object);
            server.Setup(server1 => server1.QueryProxy).Returns(new Mock<IQueryManager>().Object);
            _shellViewModel.ActiveServer = server.Object;
            _activeEnvironment.Setup(model => model.Name).Returns("localhost");
            //---------------Assert Precondition----------------
            Assert.IsNotNull(sorksurfaceContextManager);
            Assert.AreEqual(2, beforeCount);
            //---------------Execute Test ----------------------
            sorksurfaceContextManager.DisplayResourceWizard(resourceModelMock.Object);
            //---------------Test Result -----------------------
            var workSurfaceViewModels = _shellViewModel.Items.Any(model => model.WorkSurfaceViewModel is ViewModels.SourceViewModel<IOAuthSource>);
            Assert.IsTrue(workSurfaceViewModels);
        }

        [TestMethod]
        [Owner("Nkosinathi Sangweni")]
        public void DisplayResourceWizard_GivenRabbitMQSourceResourceType_ShouldEditRabbitMQSource()
        {
            //---------------Set up test pack-------------------
            CreateFullExportsAndVm();
            var resourceModelMock = new Mock<IContextualResourceModel>();
            resourceModelMock.SetupGet(model => model.ServerResourceType).Returns("RabbitMQSource");
            const string WorkFlowXaml = "<XamlDefinition>&lt;Activity x:Class=\"PBI 6690 - TEST\" xmlns=\"http://schemas.microsoft.com/netfx/2009/xaml/activities\" xmlns:av=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" xmlns:dc=\"clr-namespace:Dev2.Common;assembly=Dev2.CommonDataUtils\" xmlns:ddc=\"clr-namespace:Dev2.DataList.Contract;assembly=Dev2.Data\" xmlns:ddcb=\"clr-namespace:Dev2.DataList.Contract.Binary_Objects;assembly=Dev2.Data\" xmlns:ddd=\"clr-namespace:Dev2.Data.Decision;assembly=Dev2.Data\" xmlns:dddo=\"clr-namespace:Dev2.Data.Decisions.Operations;assembly=Dev2.Data\" xmlns:ddsm=\"clr-namespace:Dev2.Data.SystemTemplates.Models;assembly=Dev2.Data\" xmlns:mva=\"clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities\" xmlns:s=\"clr-namespace:System;assembly=mscorlib\" xmlns:sap=\"http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation\" xmlns:scg=\"clr-namespace:System.Collections.Generic;assembly=mscorlib\" xmlns:sco=\"clr-namespace:System.Collections.ObjectModel;assembly=mscorlib\" xmlns:uaba=\"clr-namespace:Unlimited.Applications.BusinessDesignStudio.Activities;assembly=Dev2.Activities\" xmlns:uf=\"clr-namespace:Unlimited.Framework;assembly=Dev2.Core\" xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"&gt;&lt;x:Members&gt;&lt;x:Property Name=\"AmbientDataList\" Type=\"InOutArgument(scg:List(x:String))\" /&gt;&lt;x:Property Name=\"ParentWorkflowInstanceId\" Type=\"InOutArgument(s:Guid)\" /&gt;&lt;x:Property Name=\"ParentServiceName\" Type=\"InOutArgument(x:String)\" /&gt;&lt;/x:Members&gt;&lt;sap:VirtualizedContainerService.HintSize&gt;654,676&lt;/sap:VirtualizedContainerService.HintSize&gt;&lt;mva:VisualBasic.Settings&gt;Assembly references and imported namespaces serialized as XML namespaces&lt;/mva:VisualBasic.Settings&gt;&lt;TextExpression.NamespacesForImplementation&gt;&lt;scg:List x:TypeArguments=\"x:String\" Capacity=\"7\"&gt;&lt;x:String&gt;Dev2.CommonDataUtils&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.Decisions.Operations&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.SystemTemplates.Models&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract.Binary_Objects&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Framework&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Applications.BusinessDesignStudio.Activities&lt;/x:String&gt;&lt;/scg:List&gt;&lt;/TextExpression.NamespacesForImplementation&gt;&lt;TextExpression.ReferencesForImplementation&gt;&lt;sco:Collection x:TypeArguments=\"AssemblyReference\"&gt;&lt;AssemblyReference&gt;Dev2.CommonDataUtils&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Data&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Core&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Activities&lt;/AssemblyReference&gt;&lt;/sco:Collection&gt;&lt;/TextExpression.ReferencesForImplementation&gt;&lt;Flowchart DisplayName=\"PBI 6690 - TEST\" sap:VirtualizedContainerService.HintSize=\"614,636\"&gt;&lt;Flowchart.Variables&gt;&lt;Variable x:TypeArguments=\"scg:List(x:String)\" Name=\"InstructionList\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"LastResult\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"HasError\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"ExplicitDataList\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"IsValid\" /&gt;&lt;Variable x:TypeArguments=\"uf:UnlimitedObject\" Name=\"d\" /&gt;&lt;Variable x:TypeArguments=\"uaba:Util\" Name=\"t\" /&gt;&lt;Variable x:TypeArguments=\"ddd:Dev2DataListDecisionHandler\" Name=\"Dev2DecisionHandler\" /&gt;&lt;/Flowchart.Variables&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;False&lt;/x:Boolean&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;270,2.5&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;60,75&lt;/av:Size&gt;&lt;av:PointCollection x:Key=\"ConnectorLocation\"&gt;300,77.5 300,107.5 310,107.5 310,211&lt;/av:PointCollection&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;Flowchart.StartNode&gt;&lt;x:Reference&gt;__ReferenceID0&lt;/x:Reference&gt;&lt;/Flowchart.StartNode&gt;&lt;FlowStep x:Name=\"__ReferenceID0\"&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;185,211&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,84&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActionName=\"{x:Null}\" ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"PBI 6690 - TEST Inputs\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"localhost\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,84\" IconPath=\"pack://application:,,,/Warewolf Studio;component/images/Workflow-32.png\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;n1&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n2&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n3&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"True\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;result&amp;quot; MapsTo=&amp;quot;result&amp;quot; Value=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"PBI 6690 - TEST Inputs\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"PBI 6690 - TEST Inputs\" Type=\"Workflow\" UniqueID=\"edadb62e-83f4-44bf-a260-7639d6b43169\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.HelpLink&gt;&lt;InArgument x:TypeArguments=\"x:String\"&gt;&lt;Literal x:TypeArguments=\"x:String\" Value=\"\" /&gt;&lt;/InArgument&gt;&lt;/uaba:DsfActivity.HelpLink&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;FlowStep&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;145,390&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,100&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" HelpLink=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" ActionName=\"dbo.spGetCountries\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"Countries\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"CitiesDb\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,100\" IconPath=\"[Nothing]\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;Prefix&amp;quot; Source=&amp;quot;Prefix&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"False\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;CountryID&amp;quot; MapsTo=&amp;quot;CountryID&amp;quot; Value=&amp;quot;[[GetCountries().CountryID]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;Output Name=&amp;quot;Description&amp;quot; MapsTo=&amp;quot;Name&amp;quot; Value=&amp;quot;[[GetCountries().Name]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"Countries\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"Countries\" Type=\"InvokeStoredProc\" UniqueID=\"33476822-9519-4ad5-8fee-1ae3b571115b\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;/Flowchart&gt;&lt;/Activity&gt;</XamlDefinition>";
            resourceModelMock.SetupGet(model => model.WorkflowXaml).Returns(new StringBuilder(WorkFlowXaml));
            resourceModelMock.SetupGet(model => model.Environment.EnvironmentID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ServerID).Returns(Guid.NewGuid);
            var sorksurfaceContextManager = new WorksurfaceContextManager(false, _shellViewModel, new Mock<IServerRepository>().Object, new Mock<IViewFactory>().Object);
            var beforeCount = _shellViewModel.Items.Count;
            var server = new Mock<IServer>();
            server.Setup(server1 => server1.UpdateRepository).Returns(new Mock<IStudioUpdateManager>().Object);
            server.Setup(server1 => server1.QueryProxy).Returns(new Mock<IQueryManager>().Object);
            _shellViewModel.ActiveServer = server.Object;
            _activeEnvironment.Setup(model => model.Name).Returns("localhost");
            //---------------Assert Precondition----------------
            Assert.IsNotNull(sorksurfaceContextManager);
            Assert.AreEqual(2, beforeCount);
            //---------------Execute Test ----------------------
            System.Windows.Threading.Dispatcher.CurrentDispatcher.Invoke(System.Windows.Threading.DispatcherPriority.Send, new Action(() => sorksurfaceContextManager.DisplayResourceWizard(resourceModelMock.Object)));
            //---------------Test Result -----------------------
            var workSurfaceViewModels = _shellViewModel.Items.Any(model => model.WorkSurfaceViewModel is ViewModels.SourceViewModel<IRabbitMQServiceSourceDefinition>);
            Assert.IsTrue(workSurfaceViewModels);
        }

        [TestMethod]
        [Owner("Nkosinathi Sangweni")]
        [DoNotParallelize]
        public void DisplayResourceWizard_GivenServerType_ShouldEditServer()
        {
            //---------------Set up test pack-------------------
            CreateFullExportsAndVm();
            var resourceModelMock = new Mock<IContextualResourceModel>();
            resourceModelMock.SetupGet(model => model.ServerResourceType).Returns("Server");
            const string WorkFlowXaml = "<XamlDefinition>&lt;Activity x:Class=\"PBI 6690 - TEST\" xmlns=\"http://schemas.microsoft.com/netfx/2009/xaml/activities\" xmlns:av=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" xmlns:dc=\"clr-namespace:Dev2.Common;assembly=Dev2.CommonDataUtils\" xmlns:ddc=\"clr-namespace:Dev2.DataList.Contract;assembly=Dev2.Data\" xmlns:ddcb=\"clr-namespace:Dev2.DataList.Contract.Binary_Objects;assembly=Dev2.Data\" xmlns:ddd=\"clr-namespace:Dev2.Data.Decision;assembly=Dev2.Data\" xmlns:dddo=\"clr-namespace:Dev2.Data.Decisions.Operations;assembly=Dev2.Data\" xmlns:ddsm=\"clr-namespace:Dev2.Data.SystemTemplates.Models;assembly=Dev2.Data\" xmlns:mva=\"clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities\" xmlns:s=\"clr-namespace:System;assembly=mscorlib\" xmlns:sap=\"http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation\" xmlns:scg=\"clr-namespace:System.Collections.Generic;assembly=mscorlib\" xmlns:sco=\"clr-namespace:System.Collections.ObjectModel;assembly=mscorlib\" xmlns:uaba=\"clr-namespace:Unlimited.Applications.BusinessDesignStudio.Activities;assembly=Dev2.Activities\" xmlns:uf=\"clr-namespace:Unlimited.Framework;assembly=Dev2.Core\" xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"&gt;&lt;x:Members&gt;&lt;x:Property Name=\"AmbientDataList\" Type=\"InOutArgument(scg:List(x:String))\" /&gt;&lt;x:Property Name=\"ParentWorkflowInstanceId\" Type=\"InOutArgument(s:Guid)\" /&gt;&lt;x:Property Name=\"ParentServiceName\" Type=\"InOutArgument(x:String)\" /&gt;&lt;/x:Members&gt;&lt;sap:VirtualizedContainerService.HintSize&gt;654,676&lt;/sap:VirtualizedContainerService.HintSize&gt;&lt;mva:VisualBasic.Settings&gt;Assembly references and imported namespaces serialized as XML namespaces&lt;/mva:VisualBasic.Settings&gt;&lt;TextExpression.NamespacesForImplementation&gt;&lt;scg:List x:TypeArguments=\"x:String\" Capacity=\"7\"&gt;&lt;x:String&gt;Dev2.CommonDataUtils&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.Decisions.Operations&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.SystemTemplates.Models&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract.Binary_Objects&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Framework&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Applications.BusinessDesignStudio.Activities&lt;/x:String&gt;&lt;/scg:List&gt;&lt;/TextExpression.NamespacesForImplementation&gt;&lt;TextExpression.ReferencesForImplementation&gt;&lt;sco:Collection x:TypeArguments=\"AssemblyReference\"&gt;&lt;AssemblyReference&gt;Dev2.CommonDataUtils&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Data&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Core&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Activities&lt;/AssemblyReference&gt;&lt;/sco:Collection&gt;&lt;/TextExpression.ReferencesForImplementation&gt;&lt;Flowchart DisplayName=\"PBI 6690 - TEST\" sap:VirtualizedContainerService.HintSize=\"614,636\"&gt;&lt;Flowchart.Variables&gt;&lt;Variable x:TypeArguments=\"scg:List(x:String)\" Name=\"InstructionList\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"LastResult\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"HasError\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"ExplicitDataList\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"IsValid\" /&gt;&lt;Variable x:TypeArguments=\"uf:UnlimitedObject\" Name=\"d\" /&gt;&lt;Variable x:TypeArguments=\"uaba:Util\" Name=\"t\" /&gt;&lt;Variable x:TypeArguments=\"ddd:Dev2DataListDecisionHandler\" Name=\"Dev2DecisionHandler\" /&gt;&lt;/Flowchart.Variables&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;False&lt;/x:Boolean&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;270,2.5&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;60,75&lt;/av:Size&gt;&lt;av:PointCollection x:Key=\"ConnectorLocation\"&gt;300,77.5 300,107.5 310,107.5 310,211&lt;/av:PointCollection&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;Flowchart.StartNode&gt;&lt;x:Reference&gt;__ReferenceID0&lt;/x:Reference&gt;&lt;/Flowchart.StartNode&gt;&lt;FlowStep x:Name=\"__ReferenceID0\"&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;185,211&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,84&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActionName=\"{x:Null}\" ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"PBI 6690 - TEST Inputs\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"localhost\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,84\" IconPath=\"pack://application:,,,/Warewolf Studio;component/images/Workflow-32.png\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;n1&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n2&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n3&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"True\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;result&amp;quot; MapsTo=&amp;quot;result&amp;quot; Value=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"PBI 6690 - TEST Inputs\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"PBI 6690 - TEST Inputs\" Type=\"Workflow\" UniqueID=\"edadb62e-83f4-44bf-a260-7639d6b43169\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.HelpLink&gt;&lt;InArgument x:TypeArguments=\"x:String\"&gt;&lt;Literal x:TypeArguments=\"x:String\" Value=\"\" /&gt;&lt;/InArgument&gt;&lt;/uaba:DsfActivity.HelpLink&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;FlowStep&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;145,390&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,100&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" HelpLink=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" ActionName=\"dbo.spGetCountries\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"Countries\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"CitiesDb\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,100\" IconPath=\"[Nothing]\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;Prefix&amp;quot; Source=&amp;quot;Prefix&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"False\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;CountryID&amp;quot; MapsTo=&amp;quot;CountryID&amp;quot; Value=&amp;quot;[[GetCountries().CountryID]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;Output Name=&amp;quot;Description&amp;quot; MapsTo=&amp;quot;Name&amp;quot; Value=&amp;quot;[[GetCountries().Name]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"Countries\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"Countries\" Type=\"InvokeStoredProc\" UniqueID=\"33476822-9519-4ad5-8fee-1ae3b571115b\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;/Flowchart&gt;&lt;/Activity&gt;</XamlDefinition>";
            resourceModelMock.SetupGet(model => model.WorkflowXaml).Returns(new StringBuilder(WorkFlowXaml));
            resourceModelMock.SetupGet(model => model.Environment.EnvironmentID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ServerID).Returns(Guid.NewGuid);
            var envRepo = new Mock<IServerRepository>();
            var envModel = new Mock<IServer>();
            envRepo.Setup(repository => repository.Get(It.IsAny<Guid>())).Returns(envModel.Object);
            var beforeCount = _shellViewModel.Items.Count;
            var sorksurfaceContextManager = new WorksurfaceContextManager(false, _shellViewModel, new Mock<IServerRepository>().Object, new Mock<IViewFactory>().Object);
            _setActiveServerAction.Invoke();
            //---------------Assert Precondition----------------
            Assert.IsNotNull(sorksurfaceContextManager);
            Assert.AreEqual(2, beforeCount);
            //---------------Execute Test ----------------------
            sorksurfaceContextManager.DisplayResourceWizard(resourceModelMock.Object);
            //---------------Test Result -----------------------
            var workSurfaceViewModels = _shellViewModel.Items.Any(model => model.WorkSurfaceViewModel is ViewModels.SourceViewModel<IServerSource>);
            Assert.IsTrue(workSurfaceViewModels);
        }

        [TestMethod]
        [Owner("Nkosinathi Sangweni")]
        public void DisplayResourceWizard_GivenDev2ServerType_ShouldDev2Server()
        {
            //---------------Set up test pack-------------------
            CreateFullExportsAndVm();
            var resourceModelMock = new Mock<IContextualResourceModel>();
            resourceModelMock.SetupGet(model => model.ServerResourceType).Returns("Dev2Server");
            const string WorkFlowXaml = "<XamlDefinition>&lt;Activity x:Class=\"PBI 6690 - TEST\" xmlns=\"http://schemas.microsoft.com/netfx/2009/xaml/activities\" xmlns:av=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" xmlns:dc=\"clr-namespace:Dev2.Common;assembly=Dev2.CommonDataUtils\" xmlns:ddc=\"clr-namespace:Dev2.DataList.Contract;assembly=Dev2.Data\" xmlns:ddcb=\"clr-namespace:Dev2.DataList.Contract.Binary_Objects;assembly=Dev2.Data\" xmlns:ddd=\"clr-namespace:Dev2.Data.Decision;assembly=Dev2.Data\" xmlns:dddo=\"clr-namespace:Dev2.Data.Decisions.Operations;assembly=Dev2.Data\" xmlns:ddsm=\"clr-namespace:Dev2.Data.SystemTemplates.Models;assembly=Dev2.Data\" xmlns:mva=\"clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities\" xmlns:s=\"clr-namespace:System;assembly=mscorlib\" xmlns:sap=\"http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation\" xmlns:scg=\"clr-namespace:System.Collections.Generic;assembly=mscorlib\" xmlns:sco=\"clr-namespace:System.Collections.ObjectModel;assembly=mscorlib\" xmlns:uaba=\"clr-namespace:Unlimited.Applications.BusinessDesignStudio.Activities;assembly=Dev2.Activities\" xmlns:uf=\"clr-namespace:Unlimited.Framework;assembly=Dev2.Core\" xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"&gt;&lt;x:Members&gt;&lt;x:Property Name=\"AmbientDataList\" Type=\"InOutArgument(scg:List(x:String))\" /&gt;&lt;x:Property Name=\"ParentWorkflowInstanceId\" Type=\"InOutArgument(s:Guid)\" /&gt;&lt;x:Property Name=\"ParentServiceName\" Type=\"InOutArgument(x:String)\" /&gt;&lt;/x:Members&gt;&lt;sap:VirtualizedContainerService.HintSize&gt;654,676&lt;/sap:VirtualizedContainerService.HintSize&gt;&lt;mva:VisualBasic.Settings&gt;Assembly references and imported namespaces serialized as XML namespaces&lt;/mva:VisualBasic.Settings&gt;&lt;TextExpression.NamespacesForImplementation&gt;&lt;scg:List x:TypeArguments=\"x:String\" Capacity=\"7\"&gt;&lt;x:String&gt;Dev2.CommonDataUtils&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.Decisions.Operations&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.SystemTemplates.Models&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract.Binary_Objects&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Framework&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Applications.BusinessDesignStudio.Activities&lt;/x:String&gt;&lt;/scg:List&gt;&lt;/TextExpression.NamespacesForImplementation&gt;&lt;TextExpression.ReferencesForImplementation&gt;&lt;sco:Collection x:TypeArguments=\"AssemblyReference\"&gt;&lt;AssemblyReference&gt;Dev2.CommonDataUtils&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Data&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Core&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Activities&lt;/AssemblyReference&gt;&lt;/sco:Collection&gt;&lt;/TextExpression.ReferencesForImplementation&gt;&lt;Flowchart DisplayName=\"PBI 6690 - TEST\" sap:VirtualizedContainerService.HintSize=\"614,636\"&gt;&lt;Flowchart.Variables&gt;&lt;Variable x:TypeArguments=\"scg:List(x:String)\" Name=\"InstructionList\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"LastResult\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"HasError\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"ExplicitDataList\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"IsValid\" /&gt;&lt;Variable x:TypeArguments=\"uf:UnlimitedObject\" Name=\"d\" /&gt;&lt;Variable x:TypeArguments=\"uaba:Util\" Name=\"t\" /&gt;&lt;Variable x:TypeArguments=\"ddd:Dev2DataListDecisionHandler\" Name=\"Dev2DecisionHandler\" /&gt;&lt;/Flowchart.Variables&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;False&lt;/x:Boolean&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;270,2.5&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;60,75&lt;/av:Size&gt;&lt;av:PointCollection x:Key=\"ConnectorLocation\"&gt;300,77.5 300,107.5 310,107.5 310,211&lt;/av:PointCollection&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;Flowchart.StartNode&gt;&lt;x:Reference&gt;__ReferenceID0&lt;/x:Reference&gt;&lt;/Flowchart.StartNode&gt;&lt;FlowStep x:Name=\"__ReferenceID0\"&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;185,211&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,84&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActionName=\"{x:Null}\" ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"PBI 6690 - TEST Inputs\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"localhost\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,84\" IconPath=\"pack://application:,,,/Warewolf Studio;component/images/Workflow-32.png\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;n1&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n2&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n3&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"True\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;result&amp;quot; MapsTo=&amp;quot;result&amp;quot; Value=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"PBI 6690 - TEST Inputs\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"PBI 6690 - TEST Inputs\" Type=\"Workflow\" UniqueID=\"edadb62e-83f4-44bf-a260-7639d6b43169\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.HelpLink&gt;&lt;InArgument x:TypeArguments=\"x:String\"&gt;&lt;Literal x:TypeArguments=\"x:String\" Value=\"\" /&gt;&lt;/InArgument&gt;&lt;/uaba:DsfActivity.HelpLink&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;FlowStep&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;145,390&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,100&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" HelpLink=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" ActionName=\"dbo.spGetCountries\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"Countries\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"CitiesDb\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,100\" IconPath=\"[Nothing]\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;Prefix&amp;quot; Source=&amp;quot;Prefix&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"False\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;CountryID&amp;quot; MapsTo=&amp;quot;CountryID&amp;quot; Value=&amp;quot;[[GetCountries().CountryID]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;Output Name=&amp;quot;Description&amp;quot; MapsTo=&amp;quot;Name&amp;quot; Value=&amp;quot;[[GetCountries().Name]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"Countries\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"Countries\" Type=\"InvokeStoredProc\" UniqueID=\"33476822-9519-4ad5-8fee-1ae3b571115b\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;/Flowchart&gt;&lt;/Activity&gt;</XamlDefinition>";
            resourceModelMock.SetupGet(model => model.WorkflowXaml).Returns(new StringBuilder(WorkFlowXaml));
            resourceModelMock.SetupGet(model => model.Environment.EnvironmentID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ServerID).Returns(Guid.NewGuid);
            var view = new Mock<IView>();
            resourceModelMock.Setup(model => model.GetView(It.IsAny<Func<IView>>())).Returns(view.Object);
            var serverRepo = new Mock<IServerRepository>();
            var vieFactory = new Mock<IViewFactory>();
            var viewMock = new Mock<IView>();
            vieFactory.Setup(factory => factory.GetViewGivenServerResourceType(It.IsAny<string>())).Returns(viewMock.Object);
            serverRepo.Setup(repository => repository.Get(It.IsAny<Guid>())).Returns(_activeEnvironment.Object);
            var sorksurfaceContextManager = new WorksurfaceContextManager(false, _shellViewModel, serverRepo.Object, vieFactory.Object);
            _setActiveServerAction.Invoke();
            var beforeCount = _shellViewModel.Items.Count;
            //---------------Assert Precondition----------------
            Assert.IsNotNull(sorksurfaceContextManager);
            Assert.AreEqual(2, beforeCount);
            //---------------Execute Test ----------------------
            sorksurfaceContextManager.DisplayResourceWizard(resourceModelMock.Object);
            //---------------Test Result -----------------------
            var workSurfaceViewModels = _shellViewModel.Items.Any(model => model.WorkSurfaceViewModel is ViewModels.SourceViewModel<IServerSource>);
            Assert.IsTrue(workSurfaceViewModels);
        }

        [TestMethod]
        [Owner("Nkosinathi Sangweni")]
        [DoNotParallelize]
        public void DisplayResourceWizard_GivenServerSourceType_ShouldServerSource()
        {
            //---------------Set up test pack-------------------
            CreateFullExportsAndVm();
            var resourceModelMock = new Mock<IContextualResourceModel>();
            resourceModelMock.SetupGet(model => model.ServerResourceType).Returns("Dev2Server");
            const string WorkFlowXaml = "<XamlDefinition>&lt;Activity x:Class=\"PBI 6690 - TEST\" xmlns=\"http://schemas.microsoft.com/netfx/2009/xaml/activities\" xmlns:av=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" xmlns:dc=\"clr-namespace:Dev2.Common;assembly=Dev2.CommonDataUtils\" xmlns:ddc=\"clr-namespace:Dev2.DataList.Contract;assembly=Dev2.Data\" xmlns:ddcb=\"clr-namespace:Dev2.DataList.Contract.Binary_Objects;assembly=Dev2.Data\" xmlns:ddd=\"clr-namespace:Dev2.Data.Decision;assembly=Dev2.Data\" xmlns:dddo=\"clr-namespace:Dev2.Data.Decisions.Operations;assembly=Dev2.Data\" xmlns:ddsm=\"clr-namespace:Dev2.Data.SystemTemplates.Models;assembly=Dev2.Data\" xmlns:mva=\"clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities\" xmlns:s=\"clr-namespace:System;assembly=mscorlib\" xmlns:sap=\"http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation\" xmlns:scg=\"clr-namespace:System.Collections.Generic;assembly=mscorlib\" xmlns:sco=\"clr-namespace:System.Collections.ObjectModel;assembly=mscorlib\" xmlns:uaba=\"clr-namespace:Unlimited.Applications.BusinessDesignStudio.Activities;assembly=Dev2.Activities\" xmlns:uf=\"clr-namespace:Unlimited.Framework;assembly=Dev2.Core\" xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"&gt;&lt;x:Members&gt;&lt;x:Property Name=\"AmbientDataList\" Type=\"InOutArgument(scg:List(x:String))\" /&gt;&lt;x:Property Name=\"ParentWorkflowInstanceId\" Type=\"InOutArgument(s:Guid)\" /&gt;&lt;x:Property Name=\"ParentServiceName\" Type=\"InOutArgument(x:String)\" /&gt;&lt;/x:Members&gt;&lt;sap:VirtualizedContainerService.HintSize&gt;654,676&lt;/sap:VirtualizedContainerService.HintSize&gt;&lt;mva:VisualBasic.Settings&gt;Assembly references and imported namespaces serialized as XML namespaces&lt;/mva:VisualBasic.Settings&gt;&lt;TextExpression.NamespacesForImplementation&gt;&lt;scg:List x:TypeArguments=\"x:String\" Capacity=\"7\"&gt;&lt;x:String&gt;Dev2.CommonDataUtils&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.Decisions.Operations&lt;/x:String&gt;&lt;x:String&gt;Dev2.Data.SystemTemplates.Models&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract&lt;/x:String&gt;&lt;x:String&gt;Dev2.DataList.Contract.Binary_Objects&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Framework&lt;/x:String&gt;&lt;x:String&gt;Unlimited.Applications.BusinessDesignStudio.Activities&lt;/x:String&gt;&lt;/scg:List&gt;&lt;/TextExpression.NamespacesForImplementation&gt;&lt;TextExpression.ReferencesForImplementation&gt;&lt;sco:Collection x:TypeArguments=\"AssemblyReference\"&gt;&lt;AssemblyReference&gt;Dev2.CommonDataUtils&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Data&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Core&lt;/AssemblyReference&gt;&lt;AssemblyReference&gt;Dev2.Activities&lt;/AssemblyReference&gt;&lt;/sco:Collection&gt;&lt;/TextExpression.ReferencesForImplementation&gt;&lt;Flowchart DisplayName=\"PBI 6690 - TEST\" sap:VirtualizedContainerService.HintSize=\"614,636\"&gt;&lt;Flowchart.Variables&gt;&lt;Variable x:TypeArguments=\"scg:List(x:String)\" Name=\"InstructionList\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"LastResult\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"HasError\" /&gt;&lt;Variable x:TypeArguments=\"x:String\" Name=\"ExplicitDataList\" /&gt;&lt;Variable x:TypeArguments=\"x:Boolean\" Name=\"IsValid\" /&gt;&lt;Variable x:TypeArguments=\"uf:UnlimitedObject\" Name=\"d\" /&gt;&lt;Variable x:TypeArguments=\"uaba:Util\" Name=\"t\" /&gt;&lt;Variable x:TypeArguments=\"ddd:Dev2DataListDecisionHandler\" Name=\"Dev2DecisionHandler\" /&gt;&lt;/Flowchart.Variables&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;False&lt;/x:Boolean&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;270,2.5&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;60,75&lt;/av:Size&gt;&lt;av:PointCollection x:Key=\"ConnectorLocation\"&gt;300,77.5 300,107.5 310,107.5 310,211&lt;/av:PointCollection&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;Flowchart.StartNode&gt;&lt;x:Reference&gt;__ReferenceID0&lt;/x:Reference&gt;&lt;/Flowchart.StartNode&gt;&lt;FlowStep x:Name=\"__ReferenceID0\"&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;185,211&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,84&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActionName=\"{x:Null}\" ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"PBI 6690 - TEST Inputs\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"localhost\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,84\" IconPath=\"pack://application:,,,/Warewolf Studio;component/images/Workflow-32.png\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;n1&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n2&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;Input Name=&amp;quot;n3&amp;quot; Source=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"True\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;result&amp;quot; MapsTo=&amp;quot;result&amp;quot; Value=&amp;quot;&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"PBI 6690 - TEST Inputs\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"PBI 6690 - TEST Inputs\" Type=\"Workflow\" UniqueID=\"edadb62e-83f4-44bf-a260-7639d6b43169\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.HelpLink&gt;&lt;InArgument x:TypeArguments=\"x:String\"&gt;&lt;Literal x:TypeArguments=\"x:String\" Value=\"\" /&gt;&lt;/InArgument&gt;&lt;/uaba:DsfActivity.HelpLink&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;FlowStep&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;av:Point x:Key=\"ShapeLocation\"&gt;145,390&lt;/av:Point&gt;&lt;av:Size x:Key=\"ShapeSize\"&gt;250,100&lt;/av:Size&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;uaba:DsfActivity ActivityStateData=\"{x:Null}\" AuthorRoles=\"{x:Null}\" Category=\"{x:Null}\" Compiler=\"{x:Null}\" CurrentResult=\"{x:Null}\" DataObject=\"{x:Null}\" DataTags=\"{x:Null}\" ExplicitDataList=\"{x:Null}\" HelpLink=\"{x:Null}\" InputTransformation=\"{x:Null}\" OnResumeKeepList=\"{x:Null}\" ParentServiceID=\"{x:Null}\" ParentServiceName=\"{x:Null}\" ParentWorkflowInstanceId=\"{x:Null}\" ResultTransformation=\"{x:Null}\" ResultValidationExpression=\"{x:Null}\" ResultValidationRequiredTags=\"{x:Null}\" ScenarioID=\"{x:Null}\" ScopingObject=\"{x:Null}\" ServiceUri=\"{x:Null}\" SimulationOutput=\"{x:Null}\" Tags=\"{x:Null}\" ActionName=\"dbo.spGetCountries\" AddMode=\"False\" DatabindRecursive=\"False\" DeferExecution=\"False\" DisplayName=\"Countries\" EnvironmentID=\"00000000-0000-0000-0000-000000000000\" FriendlySourceName=\"CitiesDb\" HasError=\"[HasError]\" sap:VirtualizedContainerService.HintSize=\"250,100\" IconPath=\"[Nothing]\" InputMapping=\"&amp;lt;Inputs&amp;gt;&amp;lt;Input Name=&amp;quot;Prefix&amp;quot; Source=&amp;quot;Prefix&amp;quot; /&amp;gt;&amp;lt;/Inputs&amp;gt;\" InstructionList=\"[InstructionList]\" IsSimulationEnabled=\"False\" IsUIStep=\"False\" IsValid=\"[IsValid]\" IsWorkflow=\"False\" OnResumeClearAmbientDataList=\"False\" OnResumeClearTags=\"FormView,InstanceId,Bookmark,ParentWorkflowInstanceId,ParentServiceName,WebPage\" OutputMapping=\"&amp;lt;Outputs&amp;gt;&amp;lt;Output Name=&amp;quot;CountryID&amp;quot; MapsTo=&amp;quot;CountryID&amp;quot; Value=&amp;quot;[[GetCountries().CountryID]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;Output Name=&amp;quot;Description&amp;quot; MapsTo=&amp;quot;Name&amp;quot; Value=&amp;quot;[[GetCountries().Name]]&amp;quot; Recordset=&amp;quot;GetCountries&amp;quot; /&amp;gt;&amp;lt;/Outputs&amp;gt;\" RemoveInputFromOutput=\"False\" ServiceName=\"Countries\" ServiceServer=\"00000000-0000-0000-0000-000000000000\" SimulationMode=\"OnDemand\" ToolboxFriendlyName=\"Countries\" Type=\"InvokeStoredProc\" UniqueID=\"33476822-9519-4ad5-8fee-1ae3b571115b\"&gt;&lt;uaba:DsfActivity.AmbientDataList&gt;&lt;InOutArgument x:TypeArguments=\"scg:List(x:String)\" /&gt;&lt;/uaba:DsfActivity.AmbientDataList&gt;&lt;uaba:DsfActivity.ParentInstanceID&gt;&lt;InOutArgument x:TypeArguments=\"x:String\" /&gt;&lt;/uaba:DsfActivity.ParentInstanceID&gt;&lt;sap:WorkflowViewStateService.ViewState&gt;&lt;scg:Dictionary x:TypeArguments=\"x:String, x:Object\"&gt;&lt;x:Boolean x:Key=\"IsExpanded\"&gt;True&lt;/x:Boolean&gt;&lt;/scg:Dictionary&gt;&lt;/sap:WorkflowViewStateService.ViewState&gt;&lt;/uaba:DsfActivity&gt;&lt;/FlowStep&gt;&lt;/Flowchart&gt;&lt;/Activity&gt;</XamlDefinition>";
            resourceModelMock.SetupGet(model => model.WorkflowXaml).Returns(new StringBuilder(WorkFlowXaml));
            resourceModelMock.SetupGet(model => model.Environment.EnvironmentID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ServerID).Returns(Guid.NewGuid);
            var sorksurfaceContextManager = new WorksurfaceContextManager(false, _shellViewModel);
            _setActiveServerAction.Invoke();
            var beforeCount = _shellViewModel.Items.Count;
            //---------------Assert Precondition----------------
            Assert.IsNotNull(sorksurfaceContextManager);
            Assert.AreEqual(2, beforeCount);
            //---------------Execute Test ----------------------
            System.Windows.Threading.Dispatcher.CurrentDispatcher.Invoke(System.Windows.Threading.DispatcherPriority.Send, new Action(() => sorksurfaceContextManager.DisplayResourceWizard(resourceModelMock.Object)));
            //---------------Test Result -----------------------
            var workSurfaceViewModels = _shellViewModel.Items.Any(model => model.WorkSurfaceViewModel is ViewModels.SourceViewModel<IServerSource>);
            Assert.IsTrue(workSurfaceViewModels);
        }

        [TestMethod]
        [Owner("Nkosinathi Sangweni")]
        public void OpenVersion_GivenVersionType_ShouldLoadResourceModel()
        {
            //---------------Set up test pack-------------------
            CreateFullExportsAndVm();
            var resourceModelMock = new Mock<IContextualResourceModel>();
            resourceModelMock.SetupGet(model => model.ServerResourceType).Returns("Dev2Server");
            var workFlow = XML.XmlResource.Fetch("ResourceWithErrors");
            var workFlowXaml = workFlow.ToString(SaveOptions.DisableFormatting);
            resourceModelMock.SetupGet(model => model.WorkflowXaml).Returns(new StringBuilder(workFlowXaml));
            resourceModelMock.SetupGet(model => model.Environment.EnvironmentID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.Environment.ResourceRepository).Returns(new Mock<IResourceRepository>().Object);
            resourceModelMock.SetupGet(model => model.ID).Returns(Guid.NewGuid);
            resourceModelMock.SetupGet(model => model.ServerID).Returns(Guid.NewGuid);
            _activeEnvironment.Setup(model => model.ResourceRepository.LoadContextualResourceModel(It.IsAny<Guid>())).Returns(resourceModelMock.Object);

            var versionMock = new Mock<IVersionInfo>();
            //---------------Assert Precondition----------------
            //---------------Execute Test ----------------------
            try
            {
                _shellViewModel.OpenVersion(Guid.NewGuid(), versionMock.Object);
            }
            catch (Exception)//Weird error cause by empty designer on unittests
            {
                //---------------Test Result -----------------------
                _verifyAction.Invoke();
                _activeEnvironment.Verify(model => model.ResourceRepository.LoadContextualResourceModel(It.IsAny<Guid>()));
            }
        }

        [TestMethod]
        [Owner("Hagashen Naidu")]
        public void AddEventsWorkSurface_ShouldPassThrough()
        {
            //---------------Set up test pack-------------------
            CreateFullExportsAndVm();
            CustomContainer.Register<IShellViewModel>(_shellViewModel);
            var worksurfaceContextManager = new WorksurfaceContextManager(false, _shellViewModel);
            var beforeCount = _shellViewModel.Items.Count;
            //---------------Assert Precondition----------------
            Assert.IsNotNull(worksurfaceContextManager);
            //---------------Execute Test ----------------------

            worksurfaceContextManager.AddQueuesWorkSurface();
            var afterCount = _shellViewModel.Items.Count;
            //---------------Test Result -----------------------
            Assert.IsTrue(afterCount > beforeCount);
        }

        [TestMethod]
        [Owner("Hagashen Naidu")]
        [DoNotParallelize]
        public void AddSchedulerWorkSurface_ShouldPassThrough()
        {
            //---------------Set up test pack-------------------
            CreateFullExportsAndVm();
            CustomContainer.Register<IShellViewModel>(_shellViewModel);
            var worksurfaceContextManager = new WorksurfaceContextManager(false, _shellViewModel);
            var beforeCount = _shellViewModel.Items.Count;
            //---------------Assert Precondition----------------
            Assert.IsNotNull(worksurfaceContextManager);
            //---------------Execute Test ----------------------

            worksurfaceContextManager.AddSchedulerWorkSurface();
            var afterCount = _shellViewModel.Items.Count;
            //---------------Test Result -----------------------
            Assert.IsTrue(afterCount > beforeCount);
        }

        [TestMethod]
        [Owner("Hagashen Naidu")]
        public void AddTasksSurface_ShouldPassThrough()
        {
            //---------------Set up test pack-------------------
            CreateFullExportsAndVm();
            CustomContainer.Register<IShellViewModel>(_shellViewModel);
            var worksurfaceContextManager = new WorksurfaceContextManager(false, _shellViewModel);
            var beforeCount = _shellViewModel.Items.Count;
            //---------------Assert Precondition----------------
            Assert.IsNotNull(worksurfaceContextManager);
            //---------------Execute Test ----------------------

            worksurfaceContextManager.AddTriggersWorkSurface();
            var afterCount = _shellViewModel.Items.Count;
            //---------------Test Result -----------------------
            Assert.IsTrue(afterCount > beforeCount);
        }
    }
}
