{"version":3,"file":"platform-server.umd.js","sources":["../../../../../../../../../../external/angular_deps/node_modules/tslib/tslib.es6.js","../../../../../packages/platform-server/src/domino_adapter.ts","../../../../../packages/platform-server/src/platform_state.ts","../../../../../packages/platform-server/src/http.ts","../../../../../packages/platform-server/src/tokens.ts","../../../../../packages/platform-server/src/location.ts","../../../../../packages/platform-server/src/server_events.ts","../../../../../packages/platform-server/src/server_renderer.ts","../../../../../packages/platform-server/src/styles_host.ts","../../../../../packages/platform-server/src/server.ts","../../../../../packages/platform-server/src/transfer_state.ts","../../../../../packages/platform-server/src/utils.ts","../../../../../packages/platform-server/src/private_export.ts","../../../../../packages/platform-server/src/version.ts","../../../../../packages/platform-server/src/platform-server.ts","../../../../../packages/platform-server/public_api.ts","../../../../../packages/platform-server/index.ts","../../../../../packages/platform-server/platform-server.ts"],"sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\r\n            t[p[i]] = s[p[i]];\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nconst domino = require('domino');\n\nimport {ÉµBrowserDomAdapter as BrowserDomAdapter, ÉµsetRootDomAdapter as setRootDomAdapter} from '@angular/platform-browser';\n\nfunction _notImplemented(methodName: string) {\n  return new Error('This method is not implemented in DominoAdapter: ' + methodName);\n}\n\nfunction setDomTypes() {\n  // Make all Domino types available as types in the global env.\n  Object.assign(global, domino.impl);\n  (global as any)['KeyboardEvent'] = domino.impl.Event;\n}\n\n/**\n * Parses a document string to a Document object.\n */\nexport function parseDocument(html: string, url = '/') {\n  let window = domino.createWindow(html, url);\n  let doc = window.document;\n  return doc;\n}\n\n/**\n * Serializes a document to string.\n */\nexport function serializeDocument(doc: Document): string {\n  return (doc as any).serialize();\n}\n\n/**\n * DOM Adapter for the server platform based on https://github.com/fgnass/domino.\n */\nexport class DominoAdapter extends BrowserDomAdapter {\n  static makeCurrent() {\n    setDomTypes();\n    setRootDomAdapter(new DominoAdapter());\n  }\n\n  private static defaultDoc: Document;\n\n  logError(error: string) { console.error(error); }\n\n  log(error: string) {\n    // tslint:disable-next-line:no-console\n    console.log(error);\n  }\n\n  logGroup(error: string) { console.error(error); }\n\n  logGroupEnd() {}\n\n  supportsDOMEvents(): boolean { return false; }\n  supportsNativeShadowDOM(): boolean { return false; }\n\n  contains(nodeA: any, nodeB: any): boolean {\n    let inner = nodeB;\n    while (inner) {\n      if (inner === nodeA) return true;\n      inner = inner.parent;\n    }\n    return false;\n  }\n\n  createHtmlDocument(): HTMLDocument {\n    return parseDocument('<html><head><title>fakeTitle</title></head><body></body></html>');\n  }\n\n  getDefaultDocument(): Document {\n    if (!DominoAdapter.defaultDoc) {\n      DominoAdapter.defaultDoc = domino.createDocument();\n    }\n    return DominoAdapter.defaultDoc;\n  }\n\n  createShadowRoot(el: any, doc: Document = document): DocumentFragment {\n    el.shadowRoot = doc.createDocumentFragment();\n    el.shadowRoot.parent = el;\n    return el.shadowRoot;\n  }\n  getShadowRoot(el: any): DocumentFragment { return el.shadowRoot; }\n\n  isTextNode(node: any): boolean { return node.nodeType === DominoAdapter.defaultDoc.TEXT_NODE; }\n  isCommentNode(node: any): boolean {\n    return node.nodeType === DominoAdapter.defaultDoc.COMMENT_NODE;\n  }\n  isElementNode(node: any): boolean {\n    return node ? node.nodeType === DominoAdapter.defaultDoc.ELEMENT_NODE : false;\n  }\n  hasShadowRoot(node: any): boolean { return node.shadowRoot != null; }\n  isShadowRoot(node: any): boolean { return this.getShadowRoot(node) == node; }\n\n  getProperty(el: Element, name: string): any {\n    if (name === 'href') {\n      // Domino tries tp resolve href-s which we do not want. Just return the\n      // attribute value.\n      return this.getAttribute(el, 'href');\n    } else if (name === 'innerText') {\n      // Domino does not support innerText. Just map it to textContent.\n      return el.textContent;\n    }\n    return (<any>el)[name];\n  }\n\n  setProperty(el: Element, name: string, value: any) {\n    if (name === 'href') {\n      // Even though the server renderer reflects any properties to attributes\n      // map 'href' to attribute just to handle when setProperty is directly called.\n      this.setAttribute(el, 'href', value);\n    } else if (name === 'innerText') {\n      // Domino does not support innerText. Just map it to textContent.\n      el.textContent = value;\n    }\n    (<any>el)[name] = value;\n  }\n\n  getGlobalEventTarget(doc: Document, target: string): EventTarget|null {\n    if (target === 'window') {\n      return doc.defaultView;\n    }\n    if (target === 'document') {\n      return doc;\n    }\n    if (target === 'body') {\n      return doc.body;\n    }\n    return null;\n  }\n\n  getBaseHref(doc: Document): string {\n    const base = this.querySelector(doc.documentElement, 'base');\n    let href = '';\n    if (base) {\n      href = this.getHref(base);\n    }\n    // TODO(alxhub): Need relative path logic from BrowserDomAdapter here?\n    return href;\n  }\n\n  /** @internal */\n  _readStyleAttribute(element: any): {[name: string]: string} {\n    const styleMap: {[name: string]: string} = {};\n    const styleAttribute = element.getAttribute('style');\n    if (styleAttribute) {\n      const styleList = styleAttribute.split(/;+/g);\n      for (let i = 0; i < styleList.length; i++) {\n        const style = styleList[i].trim();\n        if (style.length > 0) {\n          const colonIndex = style.indexOf(':');\n          if (colonIndex === -1) {\n            throw new Error(`Invalid CSS style: ${style}`);\n          }\n          const name = style.substr(0, colonIndex).trim();\n          styleMap[name] = style.substr(colonIndex + 1).trim();\n        }\n      }\n    }\n    return styleMap;\n  }\n  /** @internal */\n  _writeStyleAttribute(element: any, styleMap: {[name: string]: string}) {\n    let styleAttrValue = '';\n    for (const key in styleMap) {\n      const newValue = styleMap[key];\n      if (newValue) {\n        styleAttrValue += key + ':' + styleMap[key] + ';';\n      }\n    }\n    element.setAttribute('style', styleAttrValue);\n  }\n  setStyle(element: any, styleName: string, styleValue?: string|null) {\n    styleName = styleName.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase();\n    const styleMap = this._readStyleAttribute(element);\n    styleMap[styleName] = styleValue || '';\n    this._writeStyleAttribute(element, styleMap);\n  }\n  removeStyle(element: any, styleName: string) {\n    // IE requires '' instead of null\n    // see https://github.com/angular/angular/issues/7916\n    this.setStyle(element, styleName, '');\n  }\n  getStyle(element: any, styleName: string): string {\n    const styleMap = this._readStyleAttribute(element);\n    return styleMap[styleName] || '';\n  }\n  hasStyle(element: any, styleName: string, styleValue?: string): boolean {\n    const value = this.getStyle(element, styleName);\n    return styleValue ? value == styleValue : value.length > 0;\n  }\n\n  dispatchEvent(el: Node, evt: any) {\n    el.dispatchEvent(evt);\n\n    // Dispatch the event to the window also.\n    const doc = el.ownerDocument || el;\n    const win = (doc as any).defaultView;\n    if (win) {\n      win.dispatchEvent(evt);\n    }\n  }\n\n  getHistory(): History { throw _notImplemented('getHistory'); }\n  getLocation(): Location { throw _notImplemented('getLocation'); }\n  getUserAgent(): string { return 'Fake user agent'; }\n\n  supportsWebAnimation(): boolean { return false; }\n  performanceNow(): number { return Date.now(); }\n  getAnimationPrefix(): string { return ''; }\n  getTransitionEnd(): string { return 'transitionend'; }\n  supportsAnimation(): boolean { return true; }\n\n  getDistributedNodes(el: any): Node[] { throw _notImplemented('getDistributedNodes'); }\n\n  supportsCookies(): boolean { return false; }\n  getCookie(name: string): string { throw _notImplemented('getCookie'); }\n  setCookie(name: string, value: string) { throw _notImplemented('setCookie'); }\n}\n","/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {Inject, Injectable} from '@angular/core';\nimport {DOCUMENT, ÉµgetDOM as getDOM} from '@angular/platform-browser';\n\nimport {serializeDocument} from './domino_adapter';\n\n/**\n * Representation of the current platform state.\n *\n * @experimental\n */\n@Injectable()\nexport class PlatformState {\n  constructor(@Inject(DOCUMENT) private _doc: any) {}\n\n  /**\n   * Renders the current state of the platform to string.\n   */\n  renderToString(): string { return serializeDocument(this._doc); }\n\n  /**\n   * Returns the current DOM state.\n   */\n  getDocument(): any { return this._doc; }\n}\n","/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nconst xhr2: any = require('xhr2');\n\nimport {Injectable, Injector, Optional, Provider, InjectFlags} from '@angular/core';\nimport {BrowserXhr, Connection, ConnectionBackend, Http, ReadyState, Request, RequestOptions, Response, XHRBackend, XSRFStrategy} from '@angular/http';\n\nimport {HttpEvent, HttpRequest, HttpHandler, HttpInterceptor, HTTP_INTERCEPTORS, HttpBackend, XhrFactory, ÉµHttpInterceptingHandler as HttpInterceptingHandler} from '@angular/common/http';\n\nimport {Observable, Observer, Subscription} from 'rxjs';\n\nconst isAbsoluteUrl = /^[a-zA-Z\\-\\+.]+:\\/\\//;\n\nfunction validateRequestUrl(url: string): void {\n  if (!isAbsoluteUrl.test(url)) {\n    throw new Error(`URLs requested via Http on the server must be absolute. URL: ${url}`);\n  }\n}\n\n@Injectable()\nexport class ServerXhr implements BrowserXhr {\n  build(): XMLHttpRequest { return new xhr2.XMLHttpRequest(); }\n}\n\n@Injectable()\nexport class ServerXsrfStrategy implements XSRFStrategy {\n  configureRequest(req: Request): void {}\n}\n\nexport abstract class ZoneMacroTaskWrapper<S, R> {\n  wrap(request: S): Observable<R> {\n    return new Observable((observer: Observer<R>) => {\n      let task: Task = null !;\n      let scheduled: boolean = false;\n      let sub: Subscription|null = null;\n      let savedResult: any = null;\n      let savedError: any = null;\n\n      const scheduleTask = (_task: Task) => {\n        task = _task;\n        scheduled = true;\n\n        const delegate = this.delegate(request);\n        sub = delegate.subscribe(\n            res => savedResult = res,\n            err => {\n              if (!scheduled) {\n                throw new Error(\n                    'An http observable was completed twice. This shouldn\\'t happen, please file a bug.');\n              }\n              savedError = err;\n              scheduled = false;\n              task.invoke();\n            },\n            () => {\n              if (!scheduled) {\n                throw new Error(\n                    'An http observable was completed twice. This shouldn\\'t happen, please file a bug.');\n              }\n              scheduled = false;\n              task.invoke();\n            });\n      };\n\n      const cancelTask = (_task: Task) => {\n        if (!scheduled) {\n          return;\n        }\n        scheduled = false;\n        if (sub) {\n          sub.unsubscribe();\n          sub = null;\n        }\n      };\n\n      const onComplete = () => {\n        if (savedError !== null) {\n          observer.error(savedError);\n        } else {\n          observer.next(savedResult);\n          observer.complete();\n        }\n      };\n\n      // MockBackend for Http is synchronous, which means that if scheduleTask is by\n      // scheduleMacroTask, the request will hit MockBackend and the response will be\n      // sent, causing task.invoke() to be called.\n      const _task = Zone.current.scheduleMacroTask(\n          'ZoneMacroTaskWrapper.subscribe', onComplete, {}, () => null, cancelTask);\n      scheduleTask(_task);\n\n      return () => {\n        if (scheduled && task) {\n          task.zone.cancelTask(task);\n          scheduled = false;\n        }\n        if (sub) {\n          sub.unsubscribe();\n          sub = null;\n        }\n      };\n    });\n  }\n\n  protected abstract delegate(request: S): Observable<R>;\n}\n\nexport class ZoneMacroTaskConnection extends ZoneMacroTaskWrapper<Request, Response> implements\n    Connection {\n  response: Observable<Response>;\n  // TODO(issue/24571): remove '!'.\n  lastConnection !: Connection;\n\n  constructor(public request: Request, private backend: XHRBackend) {\n    super();\n    validateRequestUrl(request.url);\n    this.response = this.wrap(request);\n  }\n\n  delegate(request: Request): Observable<Response> {\n    this.lastConnection = this.backend.createConnection(request);\n    return this.lastConnection.response as Observable<Response>;\n  }\n\n  get readyState(): ReadyState {\n    return !!this.lastConnection ? this.lastConnection.readyState : ReadyState.Unsent;\n  }\n}\n\nexport class ZoneMacroTaskBackend implements ConnectionBackend {\n  constructor(private backend: XHRBackend) {}\n\n  createConnection(request: any): ZoneMacroTaskConnection {\n    return new ZoneMacroTaskConnection(request, this.backend);\n  }\n}\n\nexport class ZoneClientBackend extends\n    ZoneMacroTaskWrapper<HttpRequest<any>, HttpEvent<any>> implements HttpBackend {\n  constructor(private backend: HttpBackend) { super(); }\n\n  handle(request: HttpRequest<any>): Observable<HttpEvent<any>> { return this.wrap(request); }\n\n  protected delegate(request: HttpRequest<any>): Observable<HttpEvent<any>> {\n    return this.backend.handle(request);\n  }\n}\n\nexport function httpFactory(xhrBackend: XHRBackend, options: RequestOptions) {\n  const macroBackend = new ZoneMacroTaskBackend(xhrBackend);\n  return new Http(macroBackend, options);\n}\n\nexport function zoneWrappedInterceptingHandler(backend: HttpBackend, injector: Injector) {\n  const realBackend: HttpBackend = new HttpInterceptingHandler(backend, injector);\n  return new ZoneClientBackend(realBackend);\n}\n\nexport const SERVER_HTTP_PROVIDERS: Provider[] = [\n  {provide: Http, useFactory: httpFactory, deps: [XHRBackend, RequestOptions]},\n  {provide: BrowserXhr, useClass: ServerXhr}, {provide: XSRFStrategy, useClass: ServerXsrfStrategy},\n  {provide: XhrFactory, useClass: ServerXhr}, {\n    provide: HttpHandler,\n    useFactory: zoneWrappedInterceptingHandler,\n    deps: [HttpBackend, Injector]\n  }\n];\n","/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {InjectionToken} from '@angular/core';\n\n/**\n * Config object passed to initialize the platform.\n *\n * @experimental\n */\nexport interface PlatformConfig {\n  document?: string;\n  url?: string;\n}\n\n/**\n * The DI token for setting the initial config for the platform.\n *\n * @experimental\n */\nexport const INITIAL_CONFIG = new InjectionToken<PlatformConfig>('Server.INITIAL_CONFIG');\n\n/**\n * A function that will be executed when calling `renderModuleFactory` or `renderModule` just\n * before current platform state is rendered to string.\n *\n * @experimental\n */\nexport const BEFORE_APP_SERIALIZED =\n    new InjectionToken<Array<() => void>>('Server.RENDER_MODULE_HOOK');\n","/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {LocationChangeEvent, LocationChangeListener, PlatformLocation} from '@angular/common';\nimport {Inject, Injectable, Optional} from '@angular/core';\nimport {DOCUMENT, ÉµgetDOM as getDOM} from '@angular/platform-browser';\nimport {Subject} from 'rxjs';\nimport * as url from 'url';\nimport {INITIAL_CONFIG, PlatformConfig} from './tokens';\n\n\nfunction parseUrl(urlStr: string): {pathname: string, search: string, hash: string} {\n  const parsedUrl = url.parse(urlStr);\n  return {\n    pathname: parsedUrl.pathname || '',\n    search: parsedUrl.search || '',\n    hash: parsedUrl.hash || '',\n  };\n}\n\n/**\n * Server-side implementation of URL state. Implements `pathname`, `search`, and `hash`\n * but not the state stack.\n */\n@Injectable()\nexport class ServerPlatformLocation implements PlatformLocation {\n  public readonly pathname: string = '/';\n  public readonly search: string = '';\n  public readonly hash: string = '';\n  private _hashUpdate = new Subject<LocationChangeEvent>();\n\n  constructor(\n      @Inject(DOCUMENT) private _doc: any, @Optional() @Inject(INITIAL_CONFIG) _config: any) {\n    const config = _config as PlatformConfig | null;\n    if (!!config && !!config.url) {\n      const parsedUrl = parseUrl(config.url);\n      this.pathname = parsedUrl.pathname;\n      this.search = parsedUrl.search;\n      this.hash = parsedUrl.hash;\n    }\n  }\n\n  getBaseHrefFromDOM(): string { return getDOM().getBaseHref(this._doc) !; }\n\n  onPopState(fn: LocationChangeListener): void {\n    // No-op: a state stack is not implemented, so\n    // no events will ever come.\n  }\n\n  onHashChange(fn: LocationChangeListener): void { this._hashUpdate.subscribe(fn); }\n\n  get url(): string { return `${this.pathname}${this.search}${this.hash}`; }\n\n  private setHash(value: string, oldUrl: string) {\n    if (this.hash === value) {\n      // Don't fire events if the hash has not changed.\n      return;\n    }\n    (this as{hash: string}).hash = value;\n    const newUrl = this.url;\n    scheduleMicroTask(() => this._hashUpdate.next({\n      type: 'hashchange', state: null, oldUrl, newUrl\n    } as LocationChangeEvent));\n  }\n\n  replaceState(state: any, title: string, newUrl: string): void {\n    const oldUrl = this.url;\n    const parsedUrl = parseUrl(newUrl);\n    (this as{pathname: string}).pathname = parsedUrl.pathname;\n    (this as{search: string}).search = parsedUrl.search;\n    this.setHash(parsedUrl.hash, oldUrl);\n  }\n\n  pushState(state: any, title: string, newUrl: string): void {\n    this.replaceState(state, title, newUrl);\n  }\n\n  forward(): void { throw new Error('Not implemented'); }\n\n  back(): void { throw new Error('Not implemented'); }\n}\n\nexport function scheduleMicroTask(fn: Function) {\n  Zone.current.scheduleMicroTask('scheduleMicrotask', fn);\n}\n","/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {Inject, Injectable} from '@angular/core';\nimport {DOCUMENT, ÉµgetDOM as getDOM} from '@angular/platform-browser';\n\n@Injectable()\nexport class ServerEventManagerPlugin /* extends EventManagerPlugin which is private */ {\n  constructor(@Inject(DOCUMENT) private doc: any) {}\n\n  // Handle all events on the server.\n  supports(eventName: string) { return true; }\n\n  addEventListener(element: HTMLElement, eventName: string, handler: Function): Function {\n    return getDOM().onAndCancel(element, eventName, handler);\n  }\n\n  addGlobalEventListener(element: string, eventName: string, handler: Function): Function {\n    const target: HTMLElement = getDOM().getGlobalEventTarget(this.doc, element);\n    if (!target) {\n      throw new Error(`Unsupported event target ${target} for event ${eventName}`);\n    }\n    return this.addEventListener(target, eventName, handler);\n  }\n}\n","/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {DomElementSchemaRegistry} from '@angular/compiler';\nimport {APP_ID, Inject, Injectable, NgZone, RenderComponentType, Renderer, Renderer2, RendererFactory2, RendererStyleFlags2, RendererType2, RootRenderer, ViewEncapsulation, Éµstringify as stringify} from '@angular/core';\nimport {DOCUMENT, EventManager, ÉµNAMESPACE_URIS as NAMESPACE_URIS, ÉµSharedStylesHost as SharedStylesHost, ÉµflattenStyles as flattenStyles, ÉµgetDOM as getDOM, ÉµshimContentAttribute as shimContentAttribute, ÉµshimHostAttribute as shimHostAttribute} from '@angular/platform-browser';\n\nconst EMPTY_ARRAY: any[] = [];\n\n@Injectable()\nexport class ServerRendererFactory2 implements RendererFactory2 {\n  private rendererByCompId = new Map<string, Renderer2>();\n  private defaultRenderer: Renderer2;\n  private schema = new DomElementSchemaRegistry();\n\n  constructor(\n      private eventManager: EventManager, private ngZone: NgZone,\n      @Inject(DOCUMENT) private document: any, private sharedStylesHost: SharedStylesHost) {\n    this.defaultRenderer = new DefaultServerRenderer2(eventManager, document, ngZone, this.schema);\n  }\n\n  createRenderer(element: any, type: RendererType2|null): Renderer2 {\n    if (!element || !type) {\n      return this.defaultRenderer;\n    }\n    switch (type.encapsulation) {\n      case ViewEncapsulation.Native:\n      case ViewEncapsulation.Emulated: {\n        let renderer = this.rendererByCompId.get(type.id);\n        if (!renderer) {\n          renderer = new EmulatedEncapsulationServerRenderer2(\n              this.eventManager, this.document, this.ngZone, this.sharedStylesHost, this.schema,\n              type);\n          this.rendererByCompId.set(type.id, renderer);\n        }\n        (<EmulatedEncapsulationServerRenderer2>renderer).applyToHost(element);\n        return renderer;\n      }\n      case ViewEncapsulation.Native:\n        throw new Error('Native encapsulation is not supported on the server!');\n      default: {\n        if (!this.rendererByCompId.has(type.id)) {\n          const styles = flattenStyles(type.id, type.styles, []);\n          this.sharedStylesHost.addStyles(styles);\n          this.rendererByCompId.set(type.id, this.defaultRenderer);\n        }\n        return this.defaultRenderer;\n      }\n    }\n  }\n\n  begin() {}\n  end() {}\n}\n\nclass DefaultServerRenderer2 implements Renderer2 {\n  data: {[key: string]: any} = Object.create(null);\n\n  constructor(\n      private eventManager: EventManager, protected document: any, private ngZone: NgZone,\n      private schema: DomElementSchemaRegistry) {}\n\n  destroy(): void {}\n\n  destroyNode: null;\n\n  createElement(name: string, namespace?: string, debugInfo?: any): any {\n    if (namespace) {\n      return getDOM().createElementNS(NAMESPACE_URIS[namespace], name, this.document);\n    }\n\n    return getDOM().createElement(name, this.document);\n  }\n\n  createComment(value: string, debugInfo?: any): any { return getDOM().createComment(value); }\n\n  createText(value: string, debugInfo?: any): any { return getDOM().createTextNode(value); }\n\n  appendChild(parent: any, newChild: any): void { getDOM().appendChild(parent, newChild); }\n\n  insertBefore(parent: any, newChild: any, refChild: any): void {\n    if (parent) {\n      getDOM().insertBefore(parent, refChild, newChild);\n    }\n  }\n\n  removeChild(parent: any, oldChild: any): void {\n    if (parent) {\n      getDOM().removeChild(parent, oldChild);\n    }\n  }\n\n  selectRootElement(selectorOrNode: string|any, debugInfo?: any): any {\n    let el: any;\n    if (typeof selectorOrNode === 'string') {\n      el = getDOM().querySelector(this.document, selectorOrNode);\n      if (!el) {\n        throw new Error(`The selector \"${selectorOrNode}\" did not match any elements`);\n      }\n    } else {\n      el = selectorOrNode;\n    }\n    getDOM().clearNodes(el);\n    return el;\n  }\n\n  parentNode(node: any): any { return getDOM().parentElement(node); }\n\n  nextSibling(node: any): any { return getDOM().nextSibling(node); }\n\n  setAttribute(el: any, name: string, value: string, namespace?: string): void {\n    if (namespace) {\n      getDOM().setAttributeNS(el, NAMESPACE_URIS[namespace], namespace + ':' + name, value);\n    } else {\n      getDOM().setAttribute(el, name, value);\n    }\n  }\n\n  removeAttribute(el: any, name: string, namespace?: string): void {\n    if (namespace) {\n      getDOM().removeAttributeNS(el, NAMESPACE_URIS[namespace], name);\n    } else {\n      getDOM().removeAttribute(el, name);\n    }\n  }\n\n  addClass(el: any, name: string): void { getDOM().addClass(el, name); }\n\n  removeClass(el: any, name: string): void { getDOM().removeClass(el, name); }\n\n  setStyle(el: any, style: string, value: any, flags: RendererStyleFlags2): void {\n    getDOM().setStyle(el, style, value);\n  }\n\n  removeStyle(el: any, style: string, flags: RendererStyleFlags2): void {\n    getDOM().removeStyle(el, style);\n  }\n\n  // The value was validated already as a property binding, against the property name.\n  // To know this value is safe to use as an attribute, the security context of the\n  // attribute with the given name is checked against that security context of the\n  // property.\n  private _isSafeToReflectProperty(tagName: string, propertyName: string): boolean {\n    return this.schema.securityContext(tagName, propertyName, true) ===\n        this.schema.securityContext(tagName, propertyName, false);\n  }\n\n  setProperty(el: any, name: string, value: any): void {\n    checkNoSyntheticProp(name, 'property');\n    getDOM().setProperty(el, name, value);\n    // Mirror property values for known HTML element properties in the attributes.\n    // Skip `innerhtml` which is conservatively marked as an attribute for security\n    // purposes but is not actually an attribute.\n    const tagName = (el.tagName as string).toLowerCase();\n    if (value != null && (typeof value === 'number' || typeof value == 'string') &&\n        name.toLowerCase() !== 'innerhtml' && this.schema.hasElement(tagName, EMPTY_ARRAY) &&\n        this.schema.hasProperty(tagName, name, EMPTY_ARRAY) &&\n        this._isSafeToReflectProperty(tagName, name)) {\n      this.setAttribute(el, name, value.toString());\n    }\n  }\n\n  setValue(node: any, value: string): void { getDOM().setText(node, value); }\n\n  listen(\n      target: 'document'|'window'|'body'|any, eventName: string,\n      callback: (event: any) => boolean): () => void {\n    checkNoSyntheticProp(eventName, 'listener');\n    if (typeof target === 'string') {\n      return <() => void>this.eventManager.addGlobalEventListener(\n          target, eventName, this.decoratePreventDefault(callback));\n    }\n    return <() => void>this.eventManager.addEventListener(\n               target, eventName, this.decoratePreventDefault(callback)) as() => void;\n  }\n\n  private decoratePreventDefault(eventHandler: Function): Function {\n    return (event: any) => {\n      // Run the event handler inside the ngZone because event handlers are not patched\n      // by Zone on the server. This is required only for tests.\n      const allowDefaultBehavior = this.ngZone.runGuarded(() => eventHandler(event));\n      if (allowDefaultBehavior === false) {\n        event.preventDefault();\n        event.returnValue = false;\n      }\n    };\n  }\n}\n\nconst AT_CHARCODE = '@'.charCodeAt(0);\nfunction checkNoSyntheticProp(name: string, nameKind: string) {\n  if (name.charCodeAt(0) === AT_CHARCODE) {\n    throw new Error(\n        `Found the synthetic ${nameKind} ${name}. Please include either \"BrowserAnimationsModule\" or \"NoopAnimationsModule\" in your application.`);\n  }\n}\n\nclass EmulatedEncapsulationServerRenderer2 extends DefaultServerRenderer2 {\n  private contentAttr: string;\n  private hostAttr: string;\n\n  constructor(\n      eventManager: EventManager, document: any, ngZone: NgZone, sharedStylesHost: SharedStylesHost,\n      schema: DomElementSchemaRegistry, private component: RendererType2) {\n    super(eventManager, document, ngZone, schema);\n    // Add a 's' prefix to style attributes to indicate server.\n    const componentId = 's' + component.id;\n    const styles = flattenStyles(componentId, component.styles, []);\n    sharedStylesHost.addStyles(styles);\n\n    this.contentAttr = shimContentAttribute(componentId);\n    this.hostAttr = shimHostAttribute(componentId);\n  }\n\n  applyToHost(element: any) { super.setAttribute(element, this.hostAttr, ''); }\n\n  createElement(parent: any, name: string): Element {\n    const el = super.createElement(parent, name, this.document);\n    super.setAttribute(el, this.contentAttr, '');\n    return el;\n  }\n}\n","/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {ApplicationRef, Inject, Injectable, Optional} from '@angular/core';\nimport {DOCUMENT, ÉµDomAdapter as DomAdapter, ÉµSharedStylesHost as SharedStylesHost, ÉµTRANSITION_ID, ÉµgetDOM as getDOM} from '@angular/platform-browser';\n\n@Injectable()\nexport class ServerStylesHost extends SharedStylesHost {\n  private head: any = null;\n\n  constructor(\n      @Inject(DOCUMENT) private doc: any,\n      @Optional() @Inject(ÉµTRANSITION_ID) private transitionId: string) {\n    super();\n    this.head = getDOM().getElementsByTagName(doc, 'head')[0];\n  }\n\n  private _addStyle(style: string): void {\n    let adapter = getDOM();\n    const el = adapter.createElement('style');\n    adapter.setText(el, style);\n    if (!!this.transitionId) {\n      adapter.setAttribute(el, 'ng-transition', this.transitionId);\n    }\n    adapter.appendChild(this.head, el);\n  }\n\n  onStylesAdded(additions: Set<string>) { additions.forEach(style => this._addStyle(style)); }\n}\n","/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {ÉµAnimationEngine} from '@angular/animations/browser';\nimport {PlatformLocation, ViewportScroller, ÉµNullViewportScroller as NullViewportScroller, ÉµPLATFORM_SERVER_ID as PLATFORM_SERVER_ID} from '@angular/common';\nimport {HttpClientModule} from '@angular/common/http';\nimport {Injectable, InjectionToken, Injector, NgModule, NgZone, Optional, PLATFORM_ID, PLATFORM_INITIALIZER, PlatformRef, Provider, RendererFactory2, RootRenderer, StaticProvider, Testability, createPlatformFactory, isDevMode, platformCore, ÉµALLOW_MULTIPLE_PLATFORMS as ALLOW_MULTIPLE_PLATFORMS} from '@angular/core';\nimport {HttpModule} from '@angular/http';\nimport {BrowserModule, DOCUMENT, EVENT_MANAGER_PLUGINS, ÉµSharedStylesHost as SharedStylesHost, ÉµTRANSITION_ID, ÉµgetDOM as getDOM} from '@angular/platform-browser';\nimport {ÉµplatformCoreDynamic as platformCoreDynamic} from '@angular/platform-browser-dynamic';\nimport {NoopAnimationsModule, ÉµAnimationRendererFactory} from '@angular/platform-browser/animations';\n\nimport {DominoAdapter, parseDocument} from './domino_adapter';\nimport {SERVER_HTTP_PROVIDERS} from './http';\nimport {ServerPlatformLocation} from './location';\nimport {PlatformState} from './platform_state';\nimport {ServerEventManagerPlugin} from './server_events';\nimport {ServerRendererFactory2} from './server_renderer';\nimport {ServerStylesHost} from './styles_host';\nimport {INITIAL_CONFIG, PlatformConfig} from './tokens';\n\nfunction notSupported(feature: string): Error {\n  throw new Error(`platform-server does not support '${feature}'.`);\n}\n\nexport const INTERNAL_SERVER_PLATFORM_PROVIDERS: StaticProvider[] = [\n  {provide: DOCUMENT, useFactory: _document, deps: [Injector]},\n  {provide: PLATFORM_ID, useValue: PLATFORM_SERVER_ID},\n  {provide: PLATFORM_INITIALIZER, useFactory: initDominoAdapter, multi: true, deps: [Injector]}, {\n    provide: PlatformLocation,\n    useClass: ServerPlatformLocation,\n    deps: [DOCUMENT, [Optional, INITIAL_CONFIG]]\n  },\n  {provide: PlatformState, deps: [DOCUMENT]},\n  // Add special provider that allows multiple instances of platformServer* to be created.\n  {provide: ALLOW_MULTIPLE_PLATFORMS, useValue: true}\n];\n\nfunction initDominoAdapter(injector: Injector) {\n  return () => { DominoAdapter.makeCurrent(); };\n}\n\nexport function instantiateServerRendererFactory(\n    renderer: RendererFactory2, engine: ÉµAnimationEngine, zone: NgZone) {\n  return new ÉµAnimationRendererFactory(renderer, engine, zone);\n}\n\nexport const SERVER_RENDER_PROVIDERS: Provider[] = [\n  ServerRendererFactory2,\n  {\n    provide: RendererFactory2,\n    useFactory: instantiateServerRendererFactory,\n    deps: [ServerRendererFactory2, ÉµAnimationEngine, NgZone]\n  },\n  ServerStylesHost,\n  {provide: SharedStylesHost, useExisting: ServerStylesHost},\n  {provide: EVENT_MANAGER_PLUGINS, multi: true, useClass: ServerEventManagerPlugin},\n];\n\n/**\n * The ng module for the server.\n *\n * @experimental\n */\n@NgModule({\n  exports: [BrowserModule],\n  imports: [HttpModule, HttpClientModule, NoopAnimationsModule],\n  providers: [\n    SERVER_RENDER_PROVIDERS,\n    SERVER_HTTP_PROVIDERS,\n    {provide: Testability, useValue: null},\n    {provide: ViewportScroller, useClass: NullViewportScroller},\n  ],\n})\nexport class ServerModule {\n}\n\nfunction _document(injector: Injector) {\n  let config: PlatformConfig|null = injector.get(INITIAL_CONFIG, null);\n  if (config && config.document) {\n    return parseDocument(config.document, config.url);\n  } else {\n    return getDOM().createHtmlDocument();\n  }\n}\n\n/**\n * @experimental\n */\nexport const platformServer =\n    createPlatformFactory(platformCore, 'server', INTERNAL_SERVER_PLATFORM_PROVIDERS);\n\n/**\n * The server platform that supports the runtime compiler.\n *\n * @experimental\n */\nexport const platformDynamicServer =\n    createPlatformFactory(platformCoreDynamic, 'serverDynamic', INTERNAL_SERVER_PLATFORM_PROVIDERS);\n","/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {APP_ID, NgModule} from '@angular/core';\nimport {DOCUMENT, TransferState, ÉµescapeHtml as escapeHtml} from '@angular/platform-browser';\n\nimport {BEFORE_APP_SERIALIZED} from './tokens';\n\nexport function serializeTransferStateFactory(\n    doc: Document, appId: string, transferStore: TransferState) {\n  return () => {\n    const script = doc.createElement('script');\n    script.id = appId + '-state';\n    script.setAttribute('type', 'application/json');\n    script.textContent = escapeHtml(transferStore.toJson());\n    doc.body.appendChild(script);\n  };\n}\n\n/**\n * NgModule to install on the server side while using the `TransferState` to transfer state from\n * server to client.\n *\n * @experimental\n */\n@NgModule({\n  providers: [\n    TransferState, {\n      provide: BEFORE_APP_SERIALIZED,\n      useFactory: serializeTransferStateFactory,\n      deps: [DOCUMENT, APP_ID, TransferState],\n      multi: true,\n    }\n  ]\n})\nexport class ServerTransferStateModule {\n}\n","/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {ApplicationRef, NgModuleFactory, NgModuleRef, PlatformRef, StaticProvider, Type} from '@angular/core';\nimport {ÉµTRANSITION_ID} from '@angular/platform-browser';\nimport {first} from 'rxjs/operators';\n\nimport {PlatformState} from './platform_state';\nimport {platformDynamicServer, platformServer} from './server';\nimport {BEFORE_APP_SERIALIZED, INITIAL_CONFIG} from './tokens';\n\ninterface PlatformOptions {\n  document?: string;\n  url?: string;\n  extraProviders?: StaticProvider[];\n}\n\nfunction _getPlatform(\n    platformFactory: (extraProviders: StaticProvider[]) => PlatformRef,\n    options: PlatformOptions): PlatformRef {\n  const extraProviders = options.extraProviders ? options.extraProviders : [];\n  return platformFactory([\n    {provide: INITIAL_CONFIG, useValue: {document: options.document, url: options.url}},\n    extraProviders\n  ]);\n}\n\nfunction _render<T>(\n    platform: PlatformRef, moduleRefPromise: Promise<NgModuleRef<T>>): Promise<string> {\n  return moduleRefPromise.then((moduleRef) => {\n    const transitionId = moduleRef.injector.get(ÉµTRANSITION_ID, null);\n    if (!transitionId) {\n      throw new Error(\n          `renderModule[Factory]() requires the use of BrowserModule.withServerTransition() to ensure\nthe server-rendered app can be properly bootstrapped into a client app.`);\n    }\n    const applicationRef: ApplicationRef = moduleRef.injector.get(ApplicationRef);\n    return applicationRef.isStable.pipe((first((isStable: boolean) => isStable)))\n        .toPromise()\n        .then(() => {\n          const platformState = platform.injector.get(PlatformState);\n\n          // Run any BEFORE_APP_SERIALIZED callbacks just before rendering to string.\n          const callbacks = moduleRef.injector.get(BEFORE_APP_SERIALIZED, null);\n          if (callbacks) {\n            for (const callback of callbacks) {\n              try {\n                callback();\n              } catch (e) {\n                // Ignore exceptions.\n                console.warn('Ignoring BEFORE_APP_SERIALIZED Exception: ', e);\n              }\n            }\n          }\n\n          const output = platformState.renderToString();\n          platform.destroy();\n          return output;\n        });\n  });\n}\n\n/**\n * Renders a Module to string.\n *\n * `document` is the full document HTML of the page to render, as a string.\n * `url` is the URL for the current render request.\n * `extraProviders` are the platform level providers for the current render request.\n *\n * Do not use this in a production server environment. Use pre-compiled {@link NgModuleFactory} with\n * {@link renderModuleFactory} instead.\n *\n * @experimental\n */\nexport function renderModule<T>(\n    module: Type<T>, options: {document?: string, url?: string, extraProviders?: StaticProvider[]}):\n    Promise<string> {\n  const platform = _getPlatform(platformDynamicServer, options);\n  return _render(platform, platform.bootstrapModule(module));\n}\n\n/**\n * Renders a {@link NgModuleFactory} to string.\n *\n * `document` is the full document HTML of the page to render, as a string.\n * `url` is the URL for the current render request.\n * `extraProviders` are the platform level providers for the current render request.\n *\n * @experimental\n */\nexport function renderModuleFactory<T>(\n    moduleFactory: NgModuleFactory<T>,\n    options: {document?: string, url?: string, extraProviders?: StaticProvider[]}):\n    Promise<string> {\n  const platform = _getPlatform(platformServer, options);\n  return _render(platform, platform.bootstrapModuleFactory(moduleFactory));\n}\n","/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\n\nexport {INTERNAL_SERVER_PLATFORM_PROVIDERS as ÉµINTERNAL_SERVER_PLATFORM_PROVIDERS, SERVER_RENDER_PROVIDERS as ÉµSERVER_RENDER_PROVIDERS} from './server';\nexport {ServerRendererFactory2 as ÉµServerRendererFactory2} from './server_renderer';","/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\n/**\n * @module\n * @description\n * Entry point for all public APIs of the common package.\n */\n\nimport {Version} from '@angular/core';\n\nexport const VERSION = new Version('6.1.9');\n","/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nexport {PlatformState} from './platform_state';\nexport {ServerModule, platformDynamicServer, platformServer} from './server';\nexport {BEFORE_APP_SERIALIZED, INITIAL_CONFIG, PlatformConfig} from './tokens';\nexport {ServerTransferStateModule} from './transfer_state';\nexport {renderModule, renderModuleFactory} from './utils';\n\nexport * from './private_export';\nexport {VERSION} from './version';\n","/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\n/// <reference types=\"node\" />\n\n/**\n * @module\n * @description\n * Entry point for all public APIs of this package.\n */\nexport * from './src/platform-server';\n\n// This file only reexports content of the `src` folder. Keep it that way.\n","/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\n// This file is not used to build this module. It is only used during editing\n// by the TypeScript language service and during build for verification. `ngc`\n// replaces this file with production index.ts when it rewrites private symbol\n// names.\n\nexport * from './public_api';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n\nexport {SERVER_HTTP_PROVIDERS as Éµangular_packages_platform_server_platform_server_i,ServerXhr as Éµangular_packages_platform_server_platform_server_e,ServerXsrfStrategy as Éµangular_packages_platform_server_platform_server_f,httpFactory as Éµangular_packages_platform_server_platform_server_g,zoneWrappedInterceptingHandler as Éµangular_packages_platform_server_platform_server_h} from './src/http';\nexport {instantiateServerRendererFactory as Éµangular_packages_platform_server_platform_server_a} from './src/server';\nexport {ServerEventManagerPlugin as Éµangular_packages_platform_server_platform_server_d} from './src/server_events';\nexport {ServerStylesHost as Éµangular_packages_platform_server_platform_server_c} from './src/styles_host';\nexport {serializeTransferStateFactory as Éµangular_packages_platform_server_platform_server_b} from './src/transfer_state';"],"names":["url","tslib_1.__extends","setRootDomAdapter","BrowserDomAdapter","Injectable","tslib_1.__param","Inject","DOCUMENT","Observable","ReadyState","Http","HttpInterceptingHandler","XHRBackend","RequestOptions","BrowserXhr","XSRFStrategy","XhrFactory","HttpHandler","HttpBackend","Injector","InjectionToken","url.parse","Subject","getDOM","Optional","DomElementSchemaRegistry","ViewEncapsulation","flattenStyles","EventManager","NgZone","SharedStylesHost","NAMESPACE_URIS","shimContentAttribute","shimHostAttribute","ɵTRANSITION_ID","PLATFORM_ID","PLATFORM_SERVER_ID","PLATFORM_INITIALIZER","PlatformLocation","ALLOW_MULTIPLE_PLATFORMS","ɵAnimationRendererFactory","RendererFactory2","ɵAnimationEngine","EVENT_MANAGER_PLUGINS","NgModule","BrowserModule","HttpModule","HttpClientModule","NoopAnimationsModule","Testability","ViewportScroller","NullViewportScroller","createPlatformFactory","platformCore","platformCoreDynamic","escapeHtml","TransferState","APP_ID","ApplicationRef","first","tslib_1.__values","Version"],"mappings":"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"}